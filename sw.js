var Ey=Object.defineProperty;var _y=(n,e,t)=>e in n?Ey(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Et=(n,e,t)=>_y(n,typeof e!="symbol"?e+"":e,t);var To;(function(n){n.authentication="authentication",n.assertionMethod="assertionMethod",n.keyAgreement="keyAgreement",n.capabilityInvocation="capabilityInvocation",n.capabilityDelegation="capabilityDelegation"})(To||(To={}));const gt={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class Be{constructor({method:e,id:t,path:r,query:i,fragment:o,params:s}){this.uri=`did:${e}:${t}`,this.method=e,this.id=t,this.path=r,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;const t=Be.DID_URI_PATTERN.exec(e);if(!t||!t.groups)return null;const{method:r,id:i,path:o,query:s,fragment:a}=t.groups,l={uri:`did:${r}:${i}`,method:r,id:i};if(o&&(l.path=o),s&&(l.query=s.slice(1)),a&&(l.fragment=a.slice(1)),s){const u={},c=s.slice(1).split("&");for(const h of c){const[p,w]=h.split("=");u[p]=w}l.params=u}return l}}Be.METHOD_PATTERN="([a-z0-9]+)";Be.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Be.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Be.PCT_ENCODED_PATTERN})`;Be.METHOD_ID_PATTERN=`((?:${Be.ID_CHAR_PATTERN}*:)*(${Be.ID_CHAR_PATTERN}+))`;Be.PATH_PATTERN="(/[^#?]*)?";Be.QUERY_PATTERN="([?][^#]*)?";Be.FRAGMENT_PATTERN="(#.*)?";Be.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Be.METHOD_PATTERN}):(?<id>${Be.METHOD_ID_PATTERN})(?<path>${Be.PATH_PATTERN})(?<query>${Be.QUERY_PATTERN})(?<fragment>${Be.FRAGMENT_PATTERN})$`);class ye extends Error{constructor(e,t){super(`${e}: ${t}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ye)}}var fe;(function(n){n.InvalidDid="invalidDid",n.MethodNotSupported="methodNotSupported",n.InternalError="internalError",n.InvalidDidDocument="invalidDidDocument",n.InvalidDidDocumentLength="invalidDidDocumentLength",n.InvalidDidUrl="invalidDidUrl",n.InvalidPreviousDidProof="invalidPreviousDidProof",n.InvalidPublicKey="invalidPublicKey",n.InvalidPublicKeyLength="invalidPublicKeyLength",n.InvalidPublicKeyType="invalidPublicKeyType",n.InvalidSignature="invalidSignature",n.NotFound="notFound",n.RepresentationNotSupported="representationNotSupported",n.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(fe||(fe={}));var xy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function Sy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ay(n){if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")}function Ty(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<n.length;i++){var o=n.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=n.length,l=n.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var g=0,R=0,L=0,$=x.length;L!==$&&x[L]===0;)L++,g++;for(var E=($-L)*c+1>>>0,I=new Uint8Array(E);L!==$;){for(var A=x[L],U=0,H=E-1;(A!==0||U<R)&&H!==-1;H--,U++)A+=256*I[H]>>>0,I[H]=A%a>>>0,A=A/a>>>0;if(A!==0)throw new Error("Non-zero carry");R=U,L++}for(var W=E-R;W!==E&&I[W]===0;)W++;for(var ee=l.repeat(g);W<E;++W)ee+=n.charAt(I[W]);return ee}function p(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var g=0;if(x[g]!==" "){for(var R=0,L=0;x[g]===l;)R++,g++;for(var $=(x.length-g)*u+1>>>0,E=new Uint8Array($);x[g];){var I=t[x.charCodeAt(g)];if(I===255)return;for(var A=0,U=$-1;(I!==0||A<L)&&U!==-1;U--,A++)I+=a*E[U]>>>0,E[U]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");L=A,g++}if(x[g]!==" "){for(var H=$-L;H!==$&&E[H]===0;)H++;for(var W=new Uint8Array(R+($-H)),ee=R;H!==$;)W[ee++]=E[H++];return W}}}function w(x){var g=p(x);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:w}}var Iy=Ty,Ry=Iy;let Oy=class{constructor(e,t,r){Et(this,"name");Et(this,"prefix");Et(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ky=class{constructor(e,t,r){Et(this,"name");Et(this,"prefix");Et(this,"baseDecode");Et(this,"prefixCodePoint");if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Yd(this,e)}},By=class{constructor(e){Et(this,"decoders");this.decoders=e}or(e){return Yd(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r!=null)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Yd(n,e){return new By({...n.decoders??{[n.prefix]:n},...e.decoders??{[e.prefix]:e}})}let Ly=class{constructor(e,t,r,i){Et(this,"name");Et(this,"prefix");Et(this,"baseEncode");Et(this,"baseDecode");Et(this,"encoder");Et(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new Oy(e,t,r),this.decoder=new ky(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function Jd({name:n,prefix:e,encode:t,decode:r}){return new Ly(n,e,t,r)}function Xd({name:n,prefix:e,alphabet:t}){const{encode:r,decode:i}=Ry(t,n);return Jd({prefix:e,name:n,encode:r,decode:o=>Ay(i(o))})}function Cy(n,e,t,r){const i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=n.length;for(;n[o-1]==="=";)--o;const s=new Uint8Array(o*t/8|0);let a=0,l=0,u=0;for(let c=0;c<o;++c){const h=i[n[c]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return s}function $y(n,e,t){const r=e[e.length-1]==="=",i=(1<<t)-1;let o="",s=0,a=0;for(let l=0;l<n.length;++l)for(a=a<<8|n[l],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s!==0&&(o+=e[i&a<<t-s]),r)for(;o.length*t&7;)o+="=";return o}function Dt({name:n,prefix:e,bitsPerChar:t,alphabet:r}){return Jd({prefix:e,name:n,encode(i){return $y(i,r,t)},decode(i){return Cy(i,r,t,n)}})}Dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const jl=Dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Zo=Xd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});Xd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Ln=Dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Uy(n){return n.byteOffset!==0||n.byteLength!==n.buffer.byteLength}function Ny(n){return typeof n!="object"||n===null?!1:typeof n[Symbol.asyncIterator]=="function"}function pc(n){const t=Object.prototype.toString.call(n).match(/\s([a-zA-Z0-9]+)/),[r,i]=t;return i}var Ji=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Hl=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}};const Qo=new TextEncoder,kr=new TextDecoder;class oe{constructor(e,t){this.data=e,this.format=t}static arrayBuffer(e){return new oe(e,"ArrayBuffer")}static asyncIterable(e){if(!Ny(e))throw new TypeError("Input must be of type AsyncIterable.");return new oe(e,"AsyncIterable")}static base32Z(e){return new oe(e,"Base32Z")}static base58Btc(e){return new oe(e,"Base58Btc")}static base64Url(e){return new oe(e,"Base64Url")}static bufferSource(e){return new oe(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new oe(e,"Hex")}static multibase(e){return new oe(e,"Multibase")}static object(e){return new oe(e,"Object")}static string(e){return new oe(e,"String")}static uint8Array(e){return new oe(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Zo.baseDecode(this.data).buffer;case"Base64Url":return Ln.baseDecode(this.data).buffer;case"BufferSource":{if(pc(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Uy(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Ji(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return jl.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Zo.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Zo.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Ln.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return Ln.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),t=Qo.encode(e);return Ln.baseEncode(t)}case"String":{const e=Qo.encode(this.data);return Ln.baseEncode(e)}case"Uint8Array":return Ln.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return Ji(this,void 0,void 0,function*(){var e,t,r,i;switch(this.format){case"AsyncIterable":{const l=[];try{for(var o=!0,s=Hl(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;const c=i;l.push(c)}}catch(c){t={error:c}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return new Blob(l)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(t,r)=>r.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const t=this.toUint8Array();return oe.uint8Array(t).toHex()}case"Base64Url":{const t=this.toUint8Array();return oe.uint8Array(t).toHex()}case"Uint8Array":{let t="";for(let r=0;r<this.data.length;r++)t+=e[this.data[r]];return t}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=Ln.baseDecode(this.data),t=kr.decode(e);return JSON.parse(t)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=kr.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Ji(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return kr.decode(this.data);case"Base64Url":{const e=Ln.baseDecode(this.data);return kr.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return kr.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return Ji(this,void 0,void 0,function*(){var e,t,r,i;switch(this.format){case"AsyncIterable":{let l="";try{for(var o=!0,s=Hl(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;const u=i;typeof u=="string"?l+=u:l+=kr.decode(u,{stream:!0})}}catch(u){t={error:u}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return l+=kr.decode(void 0,{stream:!1}),l}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return jl.baseDecode(this.data);case"Base58Btc":return Zo.baseDecode(this.data);case"Base64Url":return Ln.baseDecode(this.data);case"BufferSource":{const e=pc(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let t=0;t<this.data.length;t+=2){const r=parseInt(this.data.substring(t,t+2),16);if(isNaN(r))throw new TypeError("Input is not a valid hexadecimal string.");e[t/2]=r}return e}case"Object":{const e=JSON.stringify(this.data);return Qo.encode(e)}case"String":return Qo.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Ji(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}}var Dy=Zd,Vl=128,Py=127,My=~Py,Ky=Math.pow(2,31);function Zd(n,e,t){e=e||[],t=t||0;for(var r=t;n>=Ky;)e[t++]=n&255|Vl,n/=128;for(;n&My;)e[t++]=n&255|Vl,n>>>=7;return e[t]=n|0,Zd.bytes=t-r+1,e}var Fy=gc,jy=128,Wl=127;function gc(n,r){var t=0,r=r||0,i=0,o=r,s,a=n.length;do{if(o>=a)throw gc.bytes=0,new RangeError("Could not decode varint");s=n[o++],t+=i<28?(s&Wl)<<i:(s&Wl)*Math.pow(2,i),i+=7}while(s>=jy);return gc.bytes=o-r,t}var Hy=Math.pow(2,7),Vy=Math.pow(2,14),Wy=Math.pow(2,21),qy=Math.pow(2,28),zy=Math.pow(2,35),Gy=Math.pow(2,42),Yy=Math.pow(2,49),Jy=Math.pow(2,56),Xy=Math.pow(2,63),Zy=function(n){return n<Hy?1:n<Vy?2:n<Wy?3:n<qy?4:n<zy?5:n<Gy?6:n<Yy?7:n<Jy?8:n<Xy?9:10},Qy={encode:Dy,decode:Fy,encodingLength:Zy},Ms=Qy;function ql(n,e=0){return[Ms.decode(n,e),Ms.decode.bytes]}function ep(n,e,t=0){return Ms.encode(n,e,t),e}function tp(n){return Ms.encodingLength(n)}class at{static addPrefix(e){var t;let{code:r,data:i,name:o}=e;if(!(o?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(r=at.codeToName.has(r)?r:at.nameToCode.get(o),r===void 0)throw new Error(`Unsupported multicodec: ${(t=e.name)!==null&&t!==void 0?t:e.code}`);const s=tp(r),a=new Uint8Array(s+i.byteLength);return a.set(i,s),ep(r,a),a}static getCodeFromData(e){const{prefixedData:t}=e,[r,i]=ql(t);return r}static getCodeFromName(e){const{name:t}=e,r=at.nameToCode.get(t);if(r===void 0)throw new Error(`Unsupported multicodec: ${t}`);return r}static getNameFromCode(e){const{code:t}=e,r=at.codeToName.get(t);if(r===void 0)throw new Error(`Unsupported multicodec: ${t}`);return r}static registerCodec(e){at.codeToName.set(e.code,e.name),at.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:t}=e,[r,i]=ql(t),o=at.codeToName.get(r);if(o===void 0)throw new Error(`Unsupported multicodec: ${r}`);return{code:r,data:t.slice(i),name:o}}}at.codeToName=new Map;at.nameToCode=new Map;at.registerCodec({code:237,name:"ed25519-pub"});at.registerCodec({code:4864,name:"ed25519-priv"});at.registerCodec({code:236,name:"x25519-pub"});at.registerCodec({code:4866,name:"x25519-priv"});at.registerCodec({code:231,name:"secp256k1-pub"});at.registerCodec({code:4865,name:"secp256k1-priv"});function Qd(n){Object.keys(n).forEach(e=>{n[e]===void 0?delete n[e]:typeof n[e]=="object"&&Qd(n[e])})}var Ar={},Ys={},ef={};ef.supports=function(...e){const t=e.reduce((r,i)=>Object.assign(r,i),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})};var tf={},Tn=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},ai={},Jt={},Js={};Js.byteLength=ip;Js.toByteArray=sp;Js.fromByteArray=lp;var wn=[],Ht=[],np=typeof Uint8Array<"u"?Uint8Array:Array,_a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var pi=0,rp=_a.length;pi<rp;++pi)wn[pi]=_a[pi],Ht[_a.charCodeAt(pi)]=pi;Ht[45]=62;Ht[95]=63;function nf(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function ip(n){var e=nf(n),t=e[0],r=e[1];return(t+r)*3/4-r}function op(n,e,t){return(e+t)*3/4-t}function sp(n){var e,t=nf(n),r=t[0],i=t[1],o=new np(op(n,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=Ht[n.charCodeAt(l)]<<18|Ht[n.charCodeAt(l+1)]<<12|Ht[n.charCodeAt(l+2)]<<6|Ht[n.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Ht[n.charCodeAt(l)]<<2|Ht[n.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=Ht[n.charCodeAt(l)]<<10|Ht[n.charCodeAt(l+1)]<<4|Ht[n.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function ap(n){return wn[n>>18&63]+wn[n>>12&63]+wn[n>>6&63]+wn[n&63]}function cp(n,e,t){for(var r,i=[],o=e;o<t;o+=3)r=(n[o]<<16&16711680)+(n[o+1]<<8&65280)+(n[o+2]&255),i.push(ap(r));return i.join("")}function lp(n){for(var e,t=n.length,r=t%3,i=[],o=16383,s=0,a=t-r;s<a;s+=o)i.push(cp(n,s,s+o>a?a:s+o));return r===1?(e=n[t-1],i.push(wn[e>>2]+wn[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(wn[e>>10]+wn[e>>4&63]+wn[e<<2&63]+"=")),i.join("")}var Zc={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Zc.read=function(n,e,t,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=t?i-1:0,p=t?-1:1,w=n[e+h];for(h+=p,o=w&(1<<-c)-1,w>>=-c,c+=a;c>0;o=o*256+n[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=s*256+n[e+h],h+=p,c-=8);if(o===0)o=1-u;else{if(o===l)return s?NaN:(w?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-u}return(w?-1:1)*s*Math.pow(2,o-r)};Zc.write=function(n,e,t,r,i,o){var s,a,l,u=o*8-i-1,c=(1<<u)-1,h=c>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=r?0:o-1,x=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=p/l:e+=p*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s=s+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;n[t+w]=a&255,w+=x,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;n[t+w]=s&255,w+=x,s/=256,u-=8);n[t+w-x]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){var e=Js,t=Zc,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=$,n.INSPECT_MAX_BYTES=50;var i=2147483647;n.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var y=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(y,d),y.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(y){if(y>i)throw new RangeError('The value "'+y+'" is invalid for option "size"');var d=new Uint8Array(y);return Object.setPrototypeOf(d,a.prototype),d}function a(y,d,f){if(typeof y=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(y)}return l(y,d,f)}a.poolSize=8192;function l(y,d,f){if(typeof y=="string")return p(y,d);if(ArrayBuffer.isView(y))return x(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(k(y,ArrayBuffer)||y&&k(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(k(y,SharedArrayBuffer)||y&&k(y.buffer,SharedArrayBuffer)))return g(y,d,f);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var m=y.valueOf&&y.valueOf();if(m!=null&&m!==y)return a.from(m,d,f);var B=R(y);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return a.from(y[Symbol.toPrimitive]("string"),d,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}a.from=function(y,d,f){return l(y,d,f)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function c(y,d,f){return u(y),y<=0?s(y):d!==void 0?typeof f=="string"?s(y).fill(d,f):s(y).fill(d):s(y)}a.alloc=function(y,d,f){return c(y,d,f)};function h(y){return u(y),s(y<0?0:L(y)|0)}a.allocUnsafe=function(y){return h(y)},a.allocUnsafeSlow=function(y){return h(y)};function p(y,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);var f=E(y,d)|0,m=s(f),B=m.write(y,d);return B!==f&&(m=m.slice(0,B)),m}function w(y){for(var d=y.length<0?0:L(y.length)|0,f=s(d),m=0;m<d;m+=1)f[m]=y[m]&255;return f}function x(y){if(k(y,Uint8Array)){var d=new Uint8Array(y);return g(d.buffer,d.byteOffset,d.byteLength)}return w(y)}function g(y,d,f){if(d<0||y.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<d+(f||0))throw new RangeError('"length" is outside of buffer bounds');var m;return d===void 0&&f===void 0?m=new Uint8Array(y):f===void 0?m=new Uint8Array(y,d):m=new Uint8Array(y,d,f),Object.setPrototypeOf(m,a.prototype),m}function R(y){if(a.isBuffer(y)){var d=L(y.length)|0,f=s(d);return f.length===0||y.copy(f,0,0,d),f}if(y.length!==void 0)return typeof y.length!="number"||C(y.length)?s(0):w(y);if(y.type==="Buffer"&&Array.isArray(y.data))return w(y.data)}function L(y){if(y>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return y|0}function $(y){return+y!=y&&(y=0),a.alloc(+y)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,f){if(k(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),k(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(d)||!a.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===f)return 0;for(var m=d.length,B=f.length,j=0,D=Math.min(m,B);j<D;++j)if(d[j]!==f[j]){m=d[j],B=f[j];break}return m<B?-1:B<m?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,f){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);var m;if(f===void 0)for(f=0,m=0;m<d.length;++m)f+=d[m].length;var B=a.allocUnsafe(f),j=0;for(m=0;m<d.length;++m){var D=d[m];if(k(D,Uint8Array))j+D.length>B.length?a.from(D).copy(B,j):Uint8Array.prototype.set.call(B,D,j);else if(a.isBuffer(D))D.copy(B,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=D.length}return B};function E(y,d){if(a.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||k(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);var f=y.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&f===0)return 0;for(var B=!1;;)switch(d){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return _e(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return Ue(y).length;default:if(B)return m?-1:_e(y).length;d=(""+d).toLowerCase(),B=!0}}a.byteLength=E;function I(y,d,f){var m=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,d>>>=0,f<=d))return"";for(y||(y="utf8");;)switch(y){case"hex":return K(this,d,f);case"utf8":case"utf-8":return pe(this,d,f);case"ascii":return ie(this,d,f);case"latin1":case"binary":return q(this,d,f);case"base64":return M(this,d,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,d,f);default:if(m)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),m=!0}}a.prototype._isBuffer=!0;function A(y,d,f){var m=y[d];y[d]=y[f],y[f]=m}a.prototype.swap16=function(){var d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var f=0;f<d;f+=2)A(this,f,f+1);return this},a.prototype.swap32=function(){var d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var f=0;f<d;f+=4)A(this,f,f+3),A(this,f+1,f+2);return this},a.prototype.swap64=function(){var d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var f=0;f<d;f+=8)A(this,f,f+7),A(this,f+1,f+6),A(this,f+2,f+5),A(this,f+3,f+4);return this},a.prototype.toString=function(){var d=this.length;return d===0?"":arguments.length===0?pe(this,0,d):I.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){var d="",f=n.INSPECT_MAX_BYTES;return d=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(d+=" ... "),"<Buffer "+d+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(d,f,m,B,j){if(k(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(f===void 0&&(f=0),m===void 0&&(m=d?d.length:0),B===void 0&&(B=0),j===void 0&&(j=this.length),f<0||m>d.length||B<0||j>this.length)throw new RangeError("out of range index");if(B>=j&&f>=m)return 0;if(B>=j)return-1;if(f>=m)return 1;if(f>>>=0,m>>>=0,B>>>=0,j>>>=0,this===d)return 0;for(var D=j-B,he=m-f,Te=Math.min(D,he),Ce=this.slice(B,j),qe=d.slice(f,m),Ne=0;Ne<Te;++Ne)if(Ce[Ne]!==qe[Ne]){D=Ce[Ne],he=qe[Ne];break}return D<he?-1:he<D?1:0};function U(y,d,f,m,B){if(y.length===0)return-1;if(typeof f=="string"?(m=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,C(f)&&(f=B?0:y.length-1),f<0&&(f=y.length+f),f>=y.length){if(B)return-1;f=y.length-1}else if(f<0)if(B)f=0;else return-1;if(typeof d=="string"&&(d=a.from(d,m)),a.isBuffer(d))return d.length===0?-1:H(y,d,f,m,B);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(y,d,f):Uint8Array.prototype.lastIndexOf.call(y,d,f):H(y,[d],f,m,B);throw new TypeError("val must be string, number or Buffer")}function H(y,d,f,m,B){var j=1,D=y.length,he=d.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(y.length<2||d.length<2)return-1;j=2,D/=2,he/=2,f/=2}function Te(it,Ot){return j===1?it[Ot]:it.readUInt16BE(Ot*j)}var Ce;if(B){var qe=-1;for(Ce=f;Ce<D;Ce++)if(Te(y,Ce)===Te(d,qe===-1?0:Ce-qe)){if(qe===-1&&(qe=Ce),Ce-qe+1===he)return qe*j}else qe!==-1&&(Ce-=Ce-qe),qe=-1}else for(f+he>D&&(f=D-he),Ce=f;Ce>=0;Ce--){for(var Ne=!0,Zt=0;Zt<he;Zt++)if(Te(y,Ce+Zt)!==Te(d,Zt)){Ne=!1;break}if(Ne)return Ce}return-1}a.prototype.includes=function(d,f,m){return this.indexOf(d,f,m)!==-1},a.prototype.indexOf=function(d,f,m){return U(this,d,f,m,!0)},a.prototype.lastIndexOf=function(d,f,m){return U(this,d,f,m,!1)};function W(y,d,f,m){f=Number(f)||0;var B=y.length-f;m?(m=Number(m),m>B&&(m=B)):m=B;var j=d.length;m>j/2&&(m=j/2);for(var D=0;D<m;++D){var he=parseInt(d.substr(D*2,2),16);if(C(he))return D;y[f+D]=he}return D}function ee(y,d,f,m){return Le(_e(d,y.length-f),y,f,m)}function re(y,d,f,m){return Le(Re(d),y,f,m)}function ne(y,d,f,m){return Le(Ue(d),y,f,m)}function Q(y,d,f,m){return Le(Ke(d,y.length-f),y,f,m)}a.prototype.write=function(d,f,m,B){if(f===void 0)B="utf8",m=this.length,f=0;else if(m===void 0&&typeof f=="string")B=f,m=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(m)?(m=m>>>0,B===void 0&&(B="utf8")):(B=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var j=this.length-f;if((m===void 0||m>j)&&(m=j),d.length>0&&(m<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");for(var D=!1;;)switch(B){case"hex":return W(this,d,f,m);case"utf8":case"utf-8":return ee(this,d,f,m);case"ascii":case"latin1":case"binary":return re(this,d,f,m);case"base64":return ne(this,d,f,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,d,f,m);default:if(D)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),D=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(y,d,f){return d===0&&f===y.length?e.fromByteArray(y):e.fromByteArray(y.slice(d,f))}function pe(y,d,f){f=Math.min(y.length,f);for(var m=[],B=d;B<f;){var j=y[B],D=null,he=j>239?4:j>223?3:j>191?2:1;if(B+he<=f){var Te,Ce,qe,Ne;switch(he){case 1:j<128&&(D=j);break;case 2:Te=y[B+1],(Te&192)===128&&(Ne=(j&31)<<6|Te&63,Ne>127&&(D=Ne));break;case 3:Te=y[B+1],Ce=y[B+2],(Te&192)===128&&(Ce&192)===128&&(Ne=(j&15)<<12|(Te&63)<<6|Ce&63,Ne>2047&&(Ne<55296||Ne>57343)&&(D=Ne));break;case 4:Te=y[B+1],Ce=y[B+2],qe=y[B+3],(Te&192)===128&&(Ce&192)===128&&(qe&192)===128&&(Ne=(j&15)<<18|(Te&63)<<12|(Ce&63)<<6|qe&63,Ne>65535&&Ne<1114112&&(D=Ne))}}D===null?(D=65533,he=1):D>65535&&(D-=65536,m.push(D>>>10&1023|55296),D=56320|D&1023),m.push(D),B+=he}return G(m)}var F=4096;function G(y){var d=y.length;if(d<=F)return String.fromCharCode.apply(String,y);for(var f="",m=0;m<d;)f+=String.fromCharCode.apply(String,y.slice(m,m+=F));return f}function ie(y,d,f){var m="";f=Math.min(y.length,f);for(var B=d;B<f;++B)m+=String.fromCharCode(y[B]&127);return m}function q(y,d,f){var m="";f=Math.min(y.length,f);for(var B=d;B<f;++B)m+=String.fromCharCode(y[B]);return m}function K(y,d,f){var m=y.length;(!d||d<0)&&(d=0),(!f||f<0||f>m)&&(f=m);for(var B="",j=d;j<f;++j)B+=V[y[j]];return B}function Y(y,d,f){for(var m=y.slice(d,f),B="",j=0;j<m.length-1;j+=2)B+=String.fromCharCode(m[j]+m[j+1]*256);return B}a.prototype.slice=function(d,f){var m=this.length;d=~~d,f=f===void 0?m:~~f,d<0?(d+=m,d<0&&(d=0)):d>m&&(d=m),f<0?(f+=m,f<0&&(f=0)):f>m&&(f=m),f<d&&(f=d);var B=this.subarray(d,f);return Object.setPrototypeOf(B,a.prototype),B};function z(y,d,f){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+d>f)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,f,m){d=d>>>0,f=f>>>0,m||z(d,f,this.length);for(var B=this[d],j=1,D=0;++D<f&&(j*=256);)B+=this[d+D]*j;return B},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,f,m){d=d>>>0,f=f>>>0,m||z(d,f,this.length);for(var B=this[d+--f],j=1;f>0&&(j*=256);)B+=this[d+--f]*j;return B},a.prototype.readUint8=a.prototype.readUInt8=function(d,f){return d=d>>>0,f||z(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,f){return d=d>>>0,f||z(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,f){return d=d>>>0,f||z(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,f){return d=d>>>0,f||z(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,f){return d=d>>>0,f||z(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readIntLE=function(d,f,m){d=d>>>0,f=f>>>0,m||z(d,f,this.length);for(var B=this[d],j=1,D=0;++D<f&&(j*=256);)B+=this[d+D]*j;return j*=128,B>=j&&(B-=Math.pow(2,8*f)),B},a.prototype.readIntBE=function(d,f,m){d=d>>>0,f=f>>>0,m||z(d,f,this.length);for(var B=f,j=1,D=this[d+--B];B>0&&(j*=256);)D+=this[d+--B]*j;return j*=128,D>=j&&(D-=Math.pow(2,8*f)),D},a.prototype.readInt8=function(d,f){return d=d>>>0,f||z(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,f){d=d>>>0,f||z(d,2,this.length);var m=this[d]|this[d+1]<<8;return m&32768?m|4294901760:m},a.prototype.readInt16BE=function(d,f){d=d>>>0,f||z(d,2,this.length);var m=this[d+1]|this[d]<<8;return m&32768?m|4294901760:m},a.prototype.readInt32LE=function(d,f){return d=d>>>0,f||z(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,f){return d=d>>>0,f||z(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readFloatLE=function(d,f){return d=d>>>0,f||z(d,4,this.length),t.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,f){return d=d>>>0,f||z(d,4,this.length),t.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,f){return d=d>>>0,f||z(d,8,this.length),t.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,f){return d=d>>>0,f||z(d,8,this.length),t.read(this,d,!1,52,8)};function te(y,d,f,m,B,j){if(!a.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>B||d<j)throw new RangeError('"value" argument is out of bounds');if(f+m>y.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,f,m,B){if(d=+d,f=f>>>0,m=m>>>0,!B){var j=Math.pow(2,8*m)-1;te(this,d,f,m,j,0)}var D=1,he=0;for(this[f]=d&255;++he<m&&(D*=256);)this[f+he]=d/D&255;return f+m},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,f,m,B){if(d=+d,f=f>>>0,m=m>>>0,!B){var j=Math.pow(2,8*m)-1;te(this,d,f,m,j,0)}var D=m-1,he=1;for(this[f+D]=d&255;--D>=0&&(he*=256);)this[f+D]=d/he&255;return f+m},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,1,255,0),this[f]=d&255,f+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,2,65535,0),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,2,65535,0),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,4,4294967295,0),this[f+3]=d>>>24,this[f+2]=d>>>16,this[f+1]=d>>>8,this[f]=d&255,f+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,4,4294967295,0),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4},a.prototype.writeIntLE=function(d,f,m,B){if(d=+d,f=f>>>0,!B){var j=Math.pow(2,8*m-1);te(this,d,f,m,j-1,-j)}var D=0,he=1,Te=0;for(this[f]=d&255;++D<m&&(he*=256);)d<0&&Te===0&&this[f+D-1]!==0&&(Te=1),this[f+D]=(d/he>>0)-Te&255;return f+m},a.prototype.writeIntBE=function(d,f,m,B){if(d=+d,f=f>>>0,!B){var j=Math.pow(2,8*m-1);te(this,d,f,m,j-1,-j)}var D=m-1,he=1,Te=0;for(this[f+D]=d&255;--D>=0&&(he*=256);)d<0&&Te===0&&this[f+D+1]!==0&&(Te=1),this[f+D]=(d/he>>0)-Te&255;return f+m},a.prototype.writeInt8=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,1,127,-128),d<0&&(d=255+d+1),this[f]=d&255,f+1},a.prototype.writeInt16LE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,2,32767,-32768),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeInt16BE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,2,32767,-32768),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeInt32LE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,4,2147483647,-2147483648),this[f]=d&255,this[f+1]=d>>>8,this[f+2]=d>>>16,this[f+3]=d>>>24,f+4},a.prototype.writeInt32BE=function(d,f,m){return d=+d,f=f>>>0,m||te(this,d,f,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4};function J(y,d,f,m,B,j){if(f+m>y.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function se(y,d,f,m,B){return d=+d,f=f>>>0,B||J(y,d,f,4),t.write(y,d,f,m,23,4),f+4}a.prototype.writeFloatLE=function(d,f,m){return se(this,d,f,!0,m)},a.prototype.writeFloatBE=function(d,f,m){return se(this,d,f,!1,m)};function me(y,d,f,m,B){return d=+d,f=f>>>0,B||J(y,d,f,8),t.write(y,d,f,m,52,8),f+8}a.prototype.writeDoubleLE=function(d,f,m){return me(this,d,f,!0,m)},a.prototype.writeDoubleBE=function(d,f,m){return me(this,d,f,!1,m)},a.prototype.copy=function(d,f,m,B){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(m||(m=0),!B&&B!==0&&(B=this.length),f>=d.length&&(f=d.length),f||(f=0),B>0&&B<m&&(B=m),B===m||d.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),d.length-f<B-m&&(B=d.length-f+m);var j=B-m;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,m,B):Uint8Array.prototype.set.call(d,this.subarray(m,B),f),j},a.prototype.fill=function(d,f,m,B){if(typeof d=="string"){if(typeof f=="string"?(B=f,f=0,m=this.length):typeof m=="string"&&(B=m,m=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!a.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(d.length===1){var j=d.charCodeAt(0);(B==="utf8"&&j<128||B==="latin1")&&(d=j)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(f<0||this.length<f||this.length<m)throw new RangeError("Out of range index");if(m<=f)return this;f=f>>>0,m=m===void 0?this.length:m>>>0,d||(d=0);var D;if(typeof d=="number")for(D=f;D<m;++D)this[D]=d;else{var he=a.isBuffer(d)?d:a.from(d,B),Te=he.length;if(Te===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(D=0;D<m-f;++D)this[D+f]=he[D%Te]}return this};var ge=/[^+/0-9A-Za-z-_]/g;function de(y){if(y=y.split("=")[0],y=y.trim().replace(ge,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function _e(y,d){d=d||1/0;for(var f,m=y.length,B=null,j=[],D=0;D<m;++D){if(f=y.charCodeAt(D),f>55295&&f<57344){if(!B){if(f>56319){(d-=3)>-1&&j.push(239,191,189);continue}else if(D+1===m){(d-=3)>-1&&j.push(239,191,189);continue}B=f;continue}if(f<56320){(d-=3)>-1&&j.push(239,191,189),B=f;continue}f=(B-55296<<10|f-56320)+65536}else B&&(d-=3)>-1&&j.push(239,191,189);if(B=null,f<128){if((d-=1)<0)break;j.push(f)}else if(f<2048){if((d-=2)<0)break;j.push(f>>6|192,f&63|128)}else if(f<65536){if((d-=3)<0)break;j.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((d-=4)<0)break;j.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return j}function Re(y){for(var d=[],f=0;f<y.length;++f)d.push(y.charCodeAt(f)&255);return d}function Ke(y,d){for(var f,m,B,j=[],D=0;D<y.length&&!((d-=2)<0);++D)f=y.charCodeAt(D),m=f>>8,B=f%256,j.push(B),j.push(m);return j}function Ue(y){return e.toByteArray(de(y))}function Le(y,d,f,m){for(var B=0;B<m&&!(B+f>=d.length||B>=y.length);++B)d[B+f]=y[B];return B}function k(y,d){return y instanceof d||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===d.name}function C(y){return y!==y}var V=function(){for(var y="0123456789abcdef",d=new Array(256),f=0;f<16;++f)for(var m=f*16,B=0;B<16;++B)d[m+B]=y[f]+y[B];return d}()})(Jt);let xa=null;var rf=function(){return xa===null&&(xa={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),xa},$o={},Qc={};const Sa=Tn,up=new Set(["buffer","view","utf8"]);let dp=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!up.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new Sa(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new Sa(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new Sa(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};Qc.Encoding=dp;const{Buffer:el}=Jt||{},{Encoding:tl}=Qc,fp=rf;let nl=class extends tl{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new rl({encode:this.encode,decode:e=>this.decode(el.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},rl=class extends tl{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new nl({encode:e=>{const t=this.encode(e);return el.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},hp=class extends tl{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new nl({encode:e=>el.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=fp();return new rl({encode:r=>e.encode(this.encode(r)),decode:r=>this.decode(t.decode(r)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};$o.BufferFormat=nl;$o.ViewFormat=rl;$o.UTF8Format=hp;const{Buffer:bt}=Jt||{Buffer:{isBuffer:()=>!1}},{textEncoder:of,textDecoder:zl}=rf(),{BufferFormat:Uo,ViewFormat:il,UTF8Format:sf}=$o,Ks=n=>n;ai.utf8=new sf({encode:function(n){return bt.isBuffer(n)?n.toString("utf8"):ArrayBuffer.isView(n)?zl.decode(n):String(n)},decode:Ks,name:"utf8",createViewTranscoder(){return new il({encode:function(n){return ArrayBuffer.isView(n)?n:of.encode(n)},decode:function(n){return zl.decode(n)},name:`${this.name}+view`})},createBufferTranscoder(){return new Uo({encode:function(n){return bt.isBuffer(n)?n:ArrayBuffer.isView(n)?bt.from(n.buffer,n.byteOffset,n.byteLength):bt.from(String(n),"utf8")},decode:function(n){return n.toString("utf8")},name:`${this.name}+buffer`})}});ai.json=new sf({encode:JSON.stringify,decode:JSON.parse,name:"json"});ai.buffer=new Uo({encode:function(n){return bt.isBuffer(n)?n:ArrayBuffer.isView(n)?bt.from(n.buffer,n.byteOffset,n.byteLength):bt.from(String(n),"utf8")},decode:Ks,name:"buffer",createViewTranscoder(){return new il({encode:function(n){return ArrayBuffer.isView(n)?n:bt.from(String(n),"utf8")},decode:function(n){return bt.from(n.buffer,n.byteOffset,n.byteLength)},name:`${this.name}+view`})}});ai.view=new il({encode:function(n){return ArrayBuffer.isView(n)?n:of.encode(n)},decode:Ks,name:"view",createBufferTranscoder(){return new Uo({encode:function(n){return bt.isBuffer(n)?n:ArrayBuffer.isView(n)?bt.from(n.buffer,n.byteOffset,n.byteLength):bt.from(String(n),"utf8")},decode:Ks,name:`${this.name}+buffer`})}});ai.hex=new Uo({encode:function(n){return bt.isBuffer(n)?n:bt.from(String(n),"hex")},decode:function(n){return n.toString("hex")},name:"hex"});ai.base64=new Uo({encode:function(n){return bt.isBuffer(n)?n:bt.from(String(n),"base64")},decode:function(n){return n.toString("base64")},name:"base64"});const Gl=Tn,Fs=ai,{Encoding:yp}=Qc,{BufferFormat:pp,ViewFormat:gp,UTF8Format:wp}=$o,Xi=Symbol("formats"),es=Symbol("encodings"),bp=new Set(["buffer","view","utf8"]);let mp=class{constructor(e){if(Array.isArray(e)){if(!e.every(t=>bp.has(t)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[es]=new Map,this[Xi]=new Set(e);for(const t in Fs)try{this.encoding(t)}catch(r){if(r.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw r}}encodings(){return Array.from(new Set(this[es].values()))}encoding(e){let t=this[es].get(e);if(t===void 0){if(typeof e=="string"&&e!==""){if(t=xp[e],!t)throw new Gl(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");t=vp(e)}const{name:r,format:i}=t;if(!this[Xi].has(i))if(this[Xi].has("view"))t=t.createViewTranscoder();else if(this[Xi].has("buffer"))t=t.createBufferTranscoder();else if(this[Xi].has("utf8"))t=t.createUTF8Transcoder();else throw new Gl(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const o of[e,r,t.name,t.commonName])this[es].set(o,t)}return t}};tf.Transcoder=mp;function vp(n){if(n instanceof yp)return n;const e="type"in n&&typeof n.type=="string"?n.type:void 0,t=n.name||e||`anonymous-${Sp++}`;switch(Ep(n)){case"view":return new gp({...n,name:t});case"utf8":return new wp({...n,name:t});case"buffer":return new pp({...n,name:t});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function Ep(n){return"format"in n&&n.format!==void 0?n.format:"buffer"in n&&typeof n.buffer=="boolean"?n.buffer?"buffer":"utf8":"code"in n&&Number.isInteger(n.code)?"view":"buffer"}const _p={binary:Fs.buffer,"utf-8":Fs.utf8},xp={...Fs,..._p};let Sp=0;var ol={exports:{}},ki=typeof Reflect=="object"?Reflect:null,Yl=ki&&typeof ki.apply=="function"?ki.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Ss;ki&&typeof ki.ownKeys=="function"?Ss=ki.ownKeys:Object.getOwnPropertySymbols?Ss=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ss=function(e){return Object.getOwnPropertyNames(e)};function Ap(n){console&&console.warn&&console.warn(n)}var af=Number.isNaN||function(e){return e!==e};function Me(){Me.init.call(this)}ol.exports=Me;ol.exports.once=Op;Me.EventEmitter=Me;Me.prototype._events=void 0;Me.prototype._eventsCount=0;Me.prototype._maxListeners=void 0;var Jl=10;function Xs(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Me,"defaultMaxListeners",{enumerable:!0,get:function(){return Jl},set:function(n){if(typeof n!="number"||n<0||af(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Jl=n}});Me.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Me.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||af(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function cf(n){return n._maxListeners===void 0?Me.defaultMaxListeners:n._maxListeners}Me.prototype.getMaxListeners=function(){return cf(this)};Me.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Yl(l,this,t);else for(var u=l.length,c=hf(l,u),r=0;r<u;++r)Yl(c[r],this,t);return!0};function lf(n,e,t,r){var i,o,s;if(Xs(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),s=o[e]),s===void 0)s=o[e]=t,++n._eventsCount;else if(typeof s=="function"?s=o[e]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),i=cf(n),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=s.length,Ap(a)}return n}Me.prototype.addListener=function(e,t){return lf(this,e,t,!1)};Me.prototype.on=Me.prototype.addListener;Me.prototype.prependListener=function(e,t){return lf(this,e,t,!0)};function Tp(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uf(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=Tp.bind(r);return i.listener=t,r.wrapFn=i,i}Me.prototype.once=function(e,t){return Xs(t),this.on(e,uf(this,e,t)),this};Me.prototype.prependOnceListener=function(e,t){return Xs(t),this.prependListener(e,uf(this,e,t)),this};Me.prototype.removeListener=function(e,t){var r,i,o,s,a;if(Xs(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Ip(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Me.prototype.off=Me.prototype.removeListener;Me.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function df(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Rp(i):hf(i,i.length)}Me.prototype.listeners=function(e){return df(this,e,!0)};Me.prototype.rawListeners=function(e){return df(this,e,!1)};Me.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):ff.call(n,e)};Me.prototype.listenerCount=ff;function ff(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Me.prototype.eventNames=function(){return this._eventsCount>0?Ss(this._events):[]};function hf(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function Ip(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Rp(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Op(n,e){return new Promise(function(t,r){function i(s){n.removeListener(e,o),r(s)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}yf(n,e,o,{once:!0}),e!=="error"&&kp(n,i,{once:!0})})}function kp(n,e,t){typeof n.on=="function"&&yf(n,"error",e,t)}function yf(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var No=ol.exports,Fi={},Bp=typeof queueMicrotask=="function"?queueMicrotask:n=>Promise.resolve().then(n),Xl=Bp;Fi.fromCallback=function(n,e){if(n===void 0){var t=new Promise(function(r,i){n=function(o,s){o?i(o):r(s)}});n[e!==void 0?e:"promise"]=t}else if(typeof n!="function")throw new TypeError("Callback must be a function");return n};Fi.fromPromise=function(n,e){if(e===void 0)return n;n.then(function(t){Xl(()=>e(null,t))}).catch(function(t){Xl(()=>e(t))})};var In={},Do={};Do.getCallback=function(n,e){return typeof n=="function"?n:e};Do.getOptions=function(n,e){return typeof n=="object"&&n!==null?n:e!==void 0?e:{}};const{fromCallback:Aa}=Fi,$t=Tn,{getOptions:Ta,getCallback:Zl}=Do,Br=Symbol("promise"),gi=Symbol("callback"),an=Symbol("working"),Wr=Symbol("handleOne"),Kn=Symbol("handleMany"),Ia=Symbol("autoClose"),_r=Symbol("finishWork"),bn=Symbol("returnMany"),nr=Symbol("closing"),Zi=Symbol("handleClose"),ts=Symbol("closed"),Qi=Symbol("closeCallbacks"),mr=Symbol("keyEncoding"),ei=Symbol("valueEncoding"),Ra=Symbol("abortOnClose"),ns=Symbol("legacy"),Oa=Symbol("keys"),ka=Symbol("values"),rr=Symbol("limit"),qt=Symbol("count"),rs=Object.freeze({}),Lp=()=>{};let Ql=!1;class sl{constructor(e,t,r){if(typeof e!="object"||e===null){const i=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${i}`)}if(typeof t!="object"||t===null)throw new TypeError("The second argument must be an options object");this[ts]=!1,this[Qi]=[],this[an]=!1,this[nr]=!1,this[Ia]=!1,this[gi]=null,this[Wr]=this[Wr].bind(this),this[Kn]=this[Kn].bind(this),this[Zi]=this[Zi].bind(this),this[mr]=t[mr],this[ei]=t[ei],this[ns]=r,this[rr]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[qt]=0,this[Ra]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[qt]}get limit(){return this[rr]}next(e){let t;if(e===void 0)t=new Promise((r,i)=>{e=(o,s,a)=>{o?i(o):this[ns]?s===void 0&&a===void 0?r():r([s,a]):r(s)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[nr]?this.nextTick(e,new $t("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[an]?this.nextTick(e,new $t("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[an]=!0,this[gi]=e,this[qt]>=this[rr]?this.nextTick(this[Wr],null):this._next(this[Wr])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=Zl(t,r),r=Aa(r,Br),t=Ta(t,rs),Number.isInteger(e)?(this[nr]?this.nextTick(r,new $t("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[an]?this.nextTick(r,new $t("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[rr]<1/0&&(e=Math.min(e,this[rr]-this[qt])),this[an]=!0,this[gi]=r,e<=0?this.nextTick(this[Kn],null,[]):this._nextv(e,t,this[Kn])),r[Br]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[Br])}_nextv(e,t,r){const i=[],o=(s,a,l)=>{if(s)return r(s);if(this[ns]?a===void 0&&l===void 0:a===void 0)return r(null,i);i.push(this[ns]?[a,l]:a),i.length===e?r(null,i):this._next(o)};this._next(o)}all(e,t){return t=Zl(e,t),t=Aa(t,Br),e=Ta(e,rs),this[nr]?this.nextTick(t,new $t("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[an]?this.nextTick(t,new $t("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[an]=!0,this[gi]=t,this[Ia]=!0,this[qt]>=this[rr]?this.nextTick(this[Kn],null,[]):this._all(e,this[Kn])),t[Br]}_all(e,t){let r=this[qt];const i=[],o=()=>{const a=this[rr]<1/0?Math.min(1e3,this[rr]-r):1e3;a<=0?this.nextTick(t,null,i):this._nextv(a,rs,s)},s=(a,l)=>{a?t(a):l.length===0?t(null,i):(i.push.apply(i,l),r+=l.length,o())};o()}[_r](){const e=this[gi];return this[Ra]&&e===null?Lp:(this[an]=!1,this[gi]=null,this[nr]&&this._close(this[Zi]),e)}[bn](e,t,r){this[Ia]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=Ta(t,rs),!this[nr]){if(this[an])throw new $t("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[mr]),i=r.format;t.keyEncoding!==i&&(t={...t,keyEncoding:i});const o=this.db.prefixKey(r.encode(e),i);this._seek(o,t)}}}_seek(e,t){throw new $t("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=Aa(e,Br),this[ts]?this.nextTick(e):this[nr]?this[Qi].push(e):(this[nr]=!0,this[Qi].push(e),this[an]?this[Ra]&&this[_r]()(new $t("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[Zi])),e[Br]}_close(e){this.nextTick(e)}[Zi](){this[ts]=!0,this.db.detachResource(this);const e=this[Qi];this[Qi]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[ts]||await this.close()}}}let Zs=class extends sl{constructor(e,t){super(e,t,!0),this[Oa]=t.keys!==!1,this[ka]=t.values!==!1}[Wr](e,t,r){const i=this[_r]();if(e)return i(e);try{t=this[Oa]&&t!==void 0?this[mr].decode(t):void 0,r=this[ka]&&r!==void 0?this[ei].decode(r):void 0}catch(o){return i(new Ni("entry",o))}t===void 0&&r===void 0||this[qt]++,i(null,t,r)}[Kn](e,t){const r=this[_r]();if(e)return this[bn](r,e);try{for(const i of t){const o=i[0],s=i[1];i[0]=this[Oa]&&o!==void 0?this[mr].decode(o):void 0,i[1]=this[ka]&&s!==void 0?this[ei].decode(s):void 0}}catch(i){return this[bn](r,new Ni("entries",i))}this[qt]+=t.length,this[bn](r,null,t)}end(e){return!Ql&&typeof console<"u"&&(Ql=!0,console.warn(new $t("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},Cp=class extends sl{constructor(e,t){super(e,t,!1)}[Wr](e,t){const r=this[_r]();if(e)return r(e);try{t=t!==void 0?this[mr].decode(t):void 0}catch(i){return r(new Ni("key",i))}t!==void 0&&this[qt]++,r(null,t)}[Kn](e,t){const r=this[_r]();if(e)return this[bn](r,e);try{for(let i=0;i<t.length;i++){const o=t[i];t[i]=o!==void 0?this[mr].decode(o):void 0}}catch(i){return this[bn](r,new Ni("keys",i))}this[qt]+=t.length,this[bn](r,null,t)}},$p=class extends sl{constructor(e,t){super(e,t,!1)}[Wr](e,t){const r=this[_r]();if(e)return r(e);try{t=t!==void 0?this[ei].decode(t):void 0}catch(i){return r(new Ni("value",i))}t!==void 0&&this[qt]++,r(null,t)}[Kn](e,t){const r=this[_r]();if(e)return this[bn](r,e);try{for(let i=0;i<t.length;i++){const o=t[i];t[i]=o!==void 0?this[ei].decode(o):void 0}}catch(i){return this[bn](r,new Ni("values",i))}this[qt]+=t.length,this[bn](r,null,t)}};class Ni extends $t{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const n of["_ended property","_nexting property","_end method"])Object.defineProperty(Zs.prototype,n.split(" ")[0],{get(){throw new $t(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new $t(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})}});Zs.keyEncoding=mr;Zs.valueEncoding=ei;In.AbstractIterator=Zs;In.AbstractKeyIterator=Cp;In.AbstractValueIterator=$p;var al={};const{AbstractKeyIterator:Up,AbstractValueIterator:Np}=In,jr=Symbol("iterator"),eo=Symbol("callback"),Di=Symbol("handleOne"),Yr=Symbol("handleMany");let wc=class extends Up{constructor(e,t){super(e,t),this[jr]=e.iterator({...t,keys:!0,values:!1}),this[Di]=this[Di].bind(this),this[Yr]=this[Yr].bind(this)}},pf=class extends Np{constructor(e,t){super(e,t),this[jr]=e.iterator({...t,keys:!1,values:!0}),this[Di]=this[Di].bind(this),this[Yr]=this[Yr].bind(this)}};for(const n of[wc,pf]){const e=n===wc,t=e?r=>r[0]:r=>r[1];n.prototype._next=function(r){this[eo]=r,this[jr].next(this[Di])},n.prototype[Di]=function(r,i,o){const s=this[eo];r?s(r):s(null,e?i:o)},n.prototype._nextv=function(r,i,o){this[eo]=o,this[jr].nextv(r,i,this[Yr])},n.prototype._all=function(r,i){this[eo]=i,this[jr].all(r,this[Yr])},n.prototype[Yr]=function(r,i){const o=this[eo];r?o(r):o(null,i.map(t))},n.prototype._seek=function(r,i){this[jr].seek(r,i)},n.prototype._close=function(r){this[jr].close(r)}}al.DefaultKeyIterator=wc;al.DefaultValueIterator=pf;var Qs={};const{AbstractIterator:Dp,AbstractKeyIterator:Pp,AbstractValueIterator:Mp}=In,Ba=Tn,At=Symbol("nut"),ea=Symbol("undefer"),ta=Symbol("factory");let gf=class extends Dp{constructor(e,t){super(e,t),this[At]=null,this[ta]=()=>e.iterator(t),this.db.defer(()=>this[ea]())}},wf=class extends Pp{constructor(e,t){super(e,t),this[At]=null,this[ta]=()=>e.keys(t),this.db.defer(()=>this[ea]())}},bf=class extends Mp{constructor(e,t){super(e,t),this[At]=null,this[ta]=()=>e.values(t),this.db.defer(()=>this[ea]())}};for(const n of[gf,wf,bf])n.prototype[ea]=function(){this.db.status==="open"&&(this[At]=this[ta]())},n.prototype._next=function(e){this[At]!==null?this[At].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new Ba("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._nextv=function(e,t,r){this[At]!==null?this[At].nextv(e,t,r):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,t,r)):this.nextTick(r,new Ba("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._all=function(e,t){this[At]!==null?this[At].all(t):this.db.status==="opening"?this.db.defer(()=>this._all(e,t)):this.nextTick(t,new Ba("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._seek=function(e,t){this[At]!==null?this[At]._seek(e,t):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,t))},n.prototype._close=function(e){this[At]!==null?this[At].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};Qs.DeferredIterator=gf;Qs.DeferredKeyIterator=wf;Qs.DeferredValueIterator=bf;var mf={},cl={};const{fromCallback:eu}=Fi,is=Tn,{getCallback:Kp,getOptions:Fp}=Do,os=Symbol("promise"),Kt=Symbol("status"),wi=Symbol("operations"),to=Symbol("finishClose"),bi=Symbol("closeCallbacks");let jp=class{constructor(e){if(typeof e!="object"||e===null){const t=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[wi]=[],this[bi]=[],this[Kt]="open",this[to]=this[to].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[wi].length}put(e,t,r){if(this[Kt]!=="open")throw new is("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const i=this.db._checkKey(e)||this.db._checkValue(t);if(i)throw i;const o=r&&r.sublevel!=null?r.sublevel:this.db,s=r,a=o.keyEncoding(r&&r.keyEncoding),l=o.valueEncoding(r&&r.valueEncoding),u=a.format;r={...r,keyEncoding:u,valueEncoding:l.format},o!==this.db&&(r.sublevel=null);const c=o.prefixKey(a.encode(e),u),h=l.encode(t);return this._put(c,h,r),this[wi].push({...s,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if(this[Kt]!=="open")throw new is("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const i=t&&t.sublevel!=null?t.sublevel:this.db,o=t,s=i.keyEncoding(t&&t.keyEncoding),a=s.format;return t={...t,keyEncoding:a},i!==this.db&&(t.sublevel=null),this._del(i.prefixKey(s.encode(e),a),t),this[wi].push({...o,type:"del",key:e}),this}_del(e,t){}clear(){if(this[Kt]!=="open")throw new is("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[wi]=[],this}_clear(){}write(e,t){return t=Kp(e,t),t=eu(t,os),e=Fp(e),this[Kt]!=="open"?this.nextTick(t,new is("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(t):(this[Kt]="writing",this._write(e,r=>{this[Kt]="closing",this[bi].push(()=>t(r)),r||this.db.emit("batch",this[wi]),this._close(this[to])})),t[os]}_write(e,t){}close(e){return e=eu(e,os),this[Kt]==="closing"?this[bi].push(e):this[Kt]==="closed"?this.nextTick(e):(this[bi].push(e),this[Kt]!=="writing"&&(this[Kt]="closing",this._close(this[to]))),e[os]}_close(e){this.nextTick(e)}[to](){this[Kt]="closed",this.db.detachResource(this);const e=this[bi];this[bi]=[];for(const t of e)t()}};cl.AbstractChainedBatch=jp;const{AbstractChainedBatch:Hp}=cl,Vp=Tn,mi=Symbol("encoded");let Wp=class extends Hp{constructor(e){super(e),this[mi]=[]}_put(e,t,r){this[mi].push({...r,type:"put",key:e,value:t})}_del(e,t){this[mi].push({...t,type:"del",key:e})}_clear(){this[mi]=[]}_write(e,t){this.db.status==="opening"?this.db.defer(()=>this._write(e,t)):this.db.status==="open"?this[mi].length===0?this.nextTick(t):this.db._batch(this[mi],e,t):this.nextTick(t,new Vp("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};mf.DefaultChainedBatch=Wp;const tu=Tn,qp=Object.prototype.hasOwnProperty,zp=new Set(["lt","lte","gt","gte"]);var Gp=function(n,e){const t={};for(const r in n)if(qp.call(n,r)&&!(r==="keyEncoding"||r==="valueEncoding")){if(r==="start"||r==="end")throw new tu(`The legacy range option '${r}' has been removed`,{code:"LEVEL_LEGACY"});if(r==="encoding")throw new tu("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});zp.has(r)?t[r]=e.encode(n[r]):t[r]=n[r]}return t.reverse=!!t.reverse,t.limit=Number.isInteger(t.limit)&&t.limit>=0?t.limit:-1,t};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let nu;var vf=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):n=>(nu||(nu=Promise.resolve())).then(n).catch(e=>setTimeout(()=>{throw e},0)),La,ru;function Yp(){if(ru)return La;ru=1;const n=vf;return La=function(e,...t){t.length===0?n(e):n(()=>e(...t))},La}var no={},iu;function Jp(){if(iu)return no;iu=1;const{AbstractIterator:n,AbstractKeyIterator:e,AbstractValueIterator:t}=In,r=Symbol("unfix"),i=Symbol("iterator"),o=Symbol("handleOne"),s=Symbol("handleMany"),a=Symbol("callback");class l extends n{constructor(p,w,x,g){super(p,w),this[i]=x,this[r]=g,this[o]=this[o].bind(this),this[s]=this[s].bind(this),this[a]=null}[o](p,w,x){const g=this[a];if(p)return g(p);w!==void 0&&(w=this[r](w)),g(p,w,x)}[s](p,w){const x=this[a];if(p)return x(p);for(const g of w){const R=g[0];R!==void 0&&(g[0]=this[r](R))}x(p,w)}}class u extends e{constructor(p,w,x,g){super(p,w),this[i]=x,this[r]=g,this[o]=this[o].bind(this),this[s]=this[s].bind(this),this[a]=null}[o](p,w){const x=this[a];if(p)return x(p);w!==void 0&&(w=this[r](w)),x(p,w)}[s](p,w){const x=this[a];if(p)return x(p);for(let g=0;g<w.length;g++){const R=w[g];R!==void 0&&(w[g]=this[r](R))}x(p,w)}}class c extends t{constructor(p,w,x){super(p,w),this[i]=x}}for(const h of[l,u])h.prototype._next=function(p){this[a]=p,this[i].next(this[o])},h.prototype._nextv=function(p,w,x){this[a]=x,this[i].nextv(p,w,this[s])},h.prototype._all=function(p,w){this[a]=w,this[i].all(p,this[s])};for(const h of[c])h.prototype._next=function(p){this[i].next(p)},h.prototype._nextv=function(p,w,x){this[i].nextv(p,w,x)},h.prototype._all=function(p,w){this[i].all(p,w)};for(const h of[l,u,c])h.prototype._seek=function(p,w){this[i].seek(p,w)},h.prototype._close=function(p){this[i].close(p)};return no.AbstractSublevelIterator=l,no.AbstractSublevelKeyIterator=u,no.AbstractSublevelValueIterator=c,no}var Ca,ou;function Xp(){if(ou)return Ca;ou=1;const n=Tn,{Buffer:e}=Jt||{},{AbstractSublevelIterator:t,AbstractSublevelKeyIterator:r,AbstractSublevelValueIterator:i}=Jp(),o=Symbol("prefix"),s=Symbol("upperBound"),a=Symbol("prefixRange"),l=Symbol("parent"),u=Symbol("unfix"),c=new TextEncoder,h={separator:"!"};Ca=function({AbstractLevel:L}){class $ extends L{static defaults(I){if(typeof I=="string")throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(I&&I.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return I==null?h:I.separator?I:{...I,separator:"!"}}constructor(I,A,U){const{separator:H,manifest:W,...ee}=$.defaults(U);A=R(A,H);const re=H.charCodeAt(0)+1,ne=I[l]||I;if(!c.encode(A).every(pe=>pe>re&&pe<127))throw new n(`Prefix must use bytes > ${re} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(p(ne,W),ee);const Q=(I.prefix||"")+H+A+H,M=Q.slice(0,-1)+String.fromCharCode(re);this[l]=ne,this[o]=new x(Q),this[s]=new x(M),this[u]=new g,this.nextTick=ne.nextTick}prefixKey(I,A){if(A==="utf8")return this[o].utf8+I;if(I.byteLength===0)return this[o][A];if(A==="view"){const U=this[o].view,H=new Uint8Array(U.byteLength+I.byteLength);return H.set(U,0),H.set(I,U.byteLength),H}else{const U=this[o].buffer;return e.concat([U,I],U.byteLength+I.byteLength)}}[a](I,A){I.gte!==void 0?I.gte=this.prefixKey(I.gte,A):I.gt!==void 0?I.gt=this.prefixKey(I.gt,A):I.gte=this[o][A],I.lte!==void 0?I.lte=this.prefixKey(I.lte,A):I.lt!==void 0?I.lt=this.prefixKey(I.lt,A):I.lte=this[s][A]}get prefix(){return this[o].utf8}get db(){return this[l]}_open(I,A){this[l].open({passive:!0},A)}_put(I,A,U,H){this[l].put(I,A,U,H)}_get(I,A,U){this[l].get(I,A,U)}_getMany(I,A,U){this[l].getMany(I,A,U)}_del(I,A,U){this[l].del(I,A,U)}_batch(I,A,U){this[l].batch(I,A,U)}_clear(I,A){this[a](I,I.keyEncoding),this[l].clear(I,A)}_iterator(I){this[a](I,I.keyEncoding);const A=this[l].iterator(I),U=this[u].get(this[o].utf8.length,I.keyEncoding);return new t(this,I,A,U)}_keys(I){this[a](I,I.keyEncoding);const A=this[l].keys(I),U=this[u].get(this[o].utf8.length,I.keyEncoding);return new r(this,I,A,U)}_values(I){this[a](I,I.keyEncoding);const A=this[l].values(I);return new i(this,I,A)}}return{AbstractSublevel:$}};const p=function(L,$){return{...L.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...$,encodings:{utf8:w(L,"utf8"),buffer:w(L,"buffer"),view:w(L,"view")}}},w=function(L,$){return L.supports.encodings[$]?L.keyEncoding($).name===$:!1};class x{constructor($){this.utf8=$,this.view=c.encode($),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class g{constructor(){this.cache=new Map}get($,E){let I=this.cache.get(E);return I===void 0&&(E==="view"?I=(function(A,U){return U.subarray(A)}).bind(null,$):I=(function(A,U){return U.slice(A)}).bind(null,$),this.cache.set(E,I)),I}}const R=function(L,$){let E=0,I=L.length;for(;E<I&&L[E]===$;)E++;for(;I>E&&L[I-1]===$;)I--;return L.slice(E,I)};return Ca}const{supports:Zp}=ef,{Transcoder:Qp}=tf,{EventEmitter:e0}=No,{fromCallback:ir}=Fi,en=Tn,{AbstractIterator:Lr}=In,{DefaultKeyIterator:t0,DefaultValueIterator:n0}=al,{DeferredIterator:r0,DeferredKeyIterator:i0,DeferredValueIterator:o0}=Qs,{DefaultChainedBatch:su}=mf,{getCallback:Cr,getOptions:or}=Do,ss=Gp,xe=Symbol("promise"),Cn=Symbol("landed"),$r=Symbol("resources"),$a=Symbol("closeResources"),ro=Symbol("operations"),io=Symbol("undefer"),as=Symbol("deferOpen"),au=Symbol("options"),Oe=Symbol("status"),Ur=Symbol("defaultOptions"),vi=Symbol("transcoder"),cs=Symbol("keyEncoding"),Ua=Symbol("valueEncoding"),s0=()=>{};let ll=class extends e0{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");t=or(t);const{keyEncoding:r,valueEncoding:i,passive:o,...s}=t;this[$r]=new Set,this[ro]=[],this[as]=!0,this[au]=s,this[Oe]="opening",this.supports=Zp(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[vi]=new Qp(a0(this)),this[cs]=this[vi].encoding(r||"utf8"),this[Ua]=this[vi].encoding(i||"utf8");for(const a of this[vi].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[Ur]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[cs].commonName,valueEncoding:this[Ua].commonName}),key:Object.freeze({keyEncoding:this[cs].commonName})},this.nextTick(()=>{this[as]&&this.open({passive:!1},s0)})}get status(){return this[Oe]}keyEncoding(e){return this[vi].encoding(e??this[cs])}valueEncoding(e){return this[vi].encoding(e??this[Ua])}open(e,t){t=Cr(e,t),t=ir(t,xe),e={...this[au],...or(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;const r=i=>{this[Oe]==="closing"||this[Oe]==="opening"?this.once(Cn,i?()=>r(i):r):this[Oe]!=="open"?t(new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:i})):t()};return e.passive?this[Oe]==="opening"?this.once(Cn,r):this.nextTick(r):this[Oe]==="closed"||this[as]?(this[as]=!1,this[Oe]="opening",this.emit("opening"),this._open(e,i=>{if(i){this[Oe]="closed",this[$a](()=>{this.emit(Cn),r(i)}),this[io]();return}this[Oe]="open",this[io](),this.emit(Cn),this[Oe]==="open"&&this.emit("open"),this[Oe]==="open"&&this.emit("ready"),r()})):this[Oe]==="open"?this.nextTick(r):this.once(Cn,()=>this.open(e,t)),t[xe]}_open(e,t){this.nextTick(t)}close(e){e=ir(e,xe);const t=r=>{this[Oe]==="opening"||this[Oe]==="closing"?this.once(Cn,r?t(r):t):this[Oe]!=="closed"?e(new en("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if(this[Oe]==="open"){this[Oe]="closing",this.emit("closing");const r=i=>{this[Oe]="open",this[io](),this.emit(Cn),t(i)};this[$a](()=>{this._close(i=>{if(i)return r(i);this[Oe]="closed",this[io](),this.emit(Cn),this[Oe]==="closed"&&this.emit("closed"),t()})})}else this[Oe]==="closed"?this.nextTick(t):this.once(Cn,()=>this.close(e));return e[xe]}[$a](e){if(this[$r].size===0)return this.nextTick(e);let t=this[$r].size,r=!0;const i=()=>{--t===0&&(r?this.nextTick(e):e())};for(const o of this[$r])o.close(i);r=!1,this[$r].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=Cr(t,r),r=ir(r,xe),t=or(t,this[Ur].entry),this[Oe]==="opening")return this.defer(()=>this.get(e,t,r)),r[xe];if(Ei(this,r))return r[xe];const i=this._checkKey(e);if(i)return this.nextTick(r,i),r[xe];const o=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),a=o.format,l=s.format;return(t.keyEncoding!==a||t.valueEncoding!==l)&&(t=Object.assign({},t,{keyEncoding:a,valueEncoding:l})),this._get(this.prefixKey(o.encode(e),a),t,(u,c)=>{if(u)return(u.code==="LEVEL_NOT_FOUND"||u.notFound||/NotFound/i.test(u))&&(u.code||(u.code="LEVEL_NOT_FOUND"),u.notFound||(u.notFound=!0),u.status||(u.status=404)),r(u);try{c=s.decode(c)}catch(h){return r(new en("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:h}))}r(null,c)}),r[xe]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=Cr(t,r),r=ir(r,xe),t=or(t,this[Ur].entry),this[Oe]==="opening")return this.defer(()=>this.getMany(e,t,r)),r[xe];if(Ei(this,r))return r[xe];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[xe];if(e.length===0)return this.nextTick(r,null,[]),r[xe];const i=this.keyEncoding(t.keyEncoding),o=this.valueEncoding(t.valueEncoding),s=i.format,a=o.format;(t.keyEncoding!==s||t.valueEncoding!==a)&&(t=Object.assign({},t,{keyEncoding:s,valueEncoding:a}));const l=new Array(e.length);for(let u=0;u<e.length;u++){const c=e[u],h=this._checkKey(c);if(h)return this.nextTick(r,h),r[xe];l[u]=this.prefixKey(i.encode(c),s)}return this._getMany(l,t,(u,c)=>{if(u)return r(u);try{for(let h=0;h<c.length;h++)c[h]!==void 0&&(c[h]=o.decode(c[h]))}catch(h){return r(new en(`Could not decode one or more of ${c.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:h}))}r(null,c)}),r[xe]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,i){if(i=Cr(r,i),i=ir(i,xe),r=or(r,this[Ur].entry),this[Oe]==="opening")return this.defer(()=>this.put(e,t,r,i)),i[xe];if(Ei(this,i))return i[xe];const o=this._checkKey(e)||this._checkValue(t);if(o)return this.nextTick(i,o),i[xe];const s=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),l=s.format,u=a.format;(r.keyEncoding!==l||r.valueEncoding!==u)&&(r=Object.assign({},r,{keyEncoding:l,valueEncoding:u}));const c=this.prefixKey(s.encode(e),l),h=a.encode(t);return this._put(c,h,r,p=>{if(p)return i(p);this.emit("put",e,t),i()}),i[xe]}_put(e,t,r,i){this.nextTick(i)}del(e,t,r){if(r=Cr(t,r),r=ir(r,xe),t=or(t,this[Ur].key),this[Oe]==="opening")return this.defer(()=>this.del(e,t,r)),r[xe];if(Ei(this,r))return r[xe];const i=this._checkKey(e);if(i)return this.nextTick(r,i),r[xe];const o=this.keyEncoding(t.keyEncoding),s=o.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(o.encode(e),s),t,a=>{if(a)return r(a);this.emit("del",e),r()}),r[xe]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if(this[Oe]==="opening")return new su(this);if(this[Oe]!=="open")throw new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?r=e:r=Cr(t,r),r=ir(r,xe),t=or(t,this[Ur].empty),this[Oe]==="opening")return this.defer(()=>this.batch(e,t,r)),r[xe];if(Ei(this,r))return r[xe];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[xe];if(e.length===0)return this.nextTick(r),r[xe];const i=new Array(e.length),{keyEncoding:o,valueEncoding:s,...a}=t;for(let l=0;l<e.length;l++){if(typeof e[l]!="object"||e[l]===null)return this.nextTick(r,new TypeError("A batch operation must be an object")),r[xe];const u=Object.assign({},e[l]);if(u.type!=="put"&&u.type!=="del")return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[xe];const c=this._checkKey(u.key);if(c)return this.nextTick(r,c),r[xe];const h=u.sublevel!=null?u.sublevel:this,p=h.keyEncoding(u.keyEncoding||o),w=p.format;if(u.key=h.prefixKey(p.encode(u.key),w),u.keyEncoding=w,u.type==="put"){const x=this._checkValue(u.value);if(x)return this.nextTick(r,x),r[xe];const g=h.valueEncoding(u.valueEncoding||s);u.value=g.encode(u.value),u.valueEncoding=g.format}h!==this&&(u.sublevel=null),i[l]=u}return this._batch(i,a,l=>{if(l)return r(l);this.emit("batch",e),r()}),r[xe]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,bc.defaults(t))}_sublevel(e,t){return new bc(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=Cr(e,t),t=ir(t,xe),e=or(e,this[Ur].empty),this[Oe]==="opening")return this.defer(()=>this.clear(e,t)),t[xe];if(Ei(this,t))return t[xe];const r=e,i=this.keyEncoding(e.keyEncoding);return e=ss(e,i),e.keyEncoding=i.format,e.limit===0?this.nextTick(t):this._clear(e,o=>{if(o)return t(o);this.emit("clear",r),t()}),t[xe]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=ss(e,t),e.keys=e.keys!==!1,e.values=e.values!==!1,e[Lr.keyEncoding]=t,e[Lr.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Oe]==="opening")return new r0(this,e);if(this[Oe]!=="open")throw new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new Lr(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=ss(e,t),e[Lr.keyEncoding]=t,e[Lr.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Oe]==="opening")return new i0(this,e);if(this[Oe]!=="open")throw new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new t0(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=ss(e,t),e[Lr.keyEncoding]=t,e[Lr.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Oe]==="opening")return new o0(this,e);if(this[Oe]!=="open")throw new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new n0(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[ro].push(e)}[io](){if(this[ro].length===0)return;const e=this[ro];this[ro]=[];for(const t of e)t()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[$r].add(e)}detachResource(e){this[$r].delete(e)}_chainedBatch(){return new su(this)}_checkKey(e){if(e==null)return new en("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new en("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};ll.prototype.nextTick=Yp();const{AbstractSublevel:bc}=Xp()({AbstractLevel:ll});Ys.AbstractLevel=ll;Ys.AbstractSublevel=bc;const Ei=function(n,e){return n[Oe]!=="open"?(n.nextTick(e,new en("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},a0=function(n){return Object.keys(n.supports.encodings).filter(e=>!!n.supports.encodings[e])};Ar.AbstractLevel=Ys.AbstractLevel;Ar.AbstractSublevel=Ys.AbstractSublevel;Ar.AbstractIterator=In.AbstractIterator;Ar.AbstractKeyIterator=In.AbstractKeyIterator;Ar.AbstractValueIterator=In.AbstractValueIterator;Ar.AbstractChainedBatch=cl.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var c0=u0;const l0=vf;function u0(n,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let r,i,o,s,a,l=!0,u;Array.isArray(n)?(r=[],o=i=n.length):(s=Object.keys(n),r={},o=i=s.length);function c(p){function w(){t&&t(p,r),t=null}l?l0(w):w()}function h(p,w,x){if(r[p]=x,w&&(a=!0),--o===0||w)c(w);else if(!a&&u<i){let g;s?(g=s[u],u+=1,n[g](function(R,L){h(g,R,L)})):(g=u,u+=1,n[g](function(R,L){h(g,R,L)}))}}u=e,o?s?s.some(function(p,w){return n[p](function(x,g){h(p,x,g)}),w===e-1}):n.some(function(p,w){return p(function(x,g){h(w,x,g)}),w===e-1}):c(null),l=!1}var Ef={},_f=function(e){const t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,r=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,i=e.gte===void 0,o=e.lte===void 0;return t!==void 0&&r!==void 0?IDBKeyRange.bound(t,r,i,o):t!==void 0?IDBKeyRange.lowerBound(t,i):r!==void 0?IDBKeyRange.upperBound(r,o):null};const d0=new TextEncoder;var xf=function(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):d0.encode(n)};const{AbstractIterator:f0}=Ar,cu=_f,ls=xf,cn=Symbol("cache"),$n=Symbol("finished"),kt=Symbol("options"),Un=Symbol("currentOptions"),Nr=Symbol("position"),Na=Symbol("location"),_i=Symbol("first"),lu={};let h0=class extends f0{constructor(e,t,r){super(e,r),this[cn]=[],this[$n]=this.limit===0,this[kt]=r,this[Un]={...r},this[Nr]=void 0,this[Na]=t,this[_i]=!0}_nextv(e,t,r){if(this[_i]=!1,this[$n])return this.nextTick(r,null,[]);if(this[cn].length>0)return e=Math.min(e,this[cn].length),this.nextTick(r,null,this[cn].splice(0,e));this[Nr]!==void 0&&(this[kt].reverse?(this[Un].lt=this[Nr],this[Un].lte=void 0):(this[Un].gt=this[Nr],this[Un].gte=void 0));let i;try{i=cu(this[Un])}catch{return this[$n]=!0,this.nextTick(r,null,[])}const o=this.db.db.transaction([this[Na]],"readonly"),s=o.objectStore(this[Na]),a=[];if(this[kt].reverse){const l=!this[kt].values&&s.openKeyCursor?"openKeyCursor":"openCursor";s[l](i,"prev").onsuccess=u=>{const c=u.target.result;if(c){const{key:h,value:p}=c;this[Nr]=h,a.push([this[kt].keys&&h!==void 0?ls(h):void 0,this[kt].values&&p!==void 0?ls(p):void 0]),a.length<e?c.continue():uu(o)}else this[$n]=!0}}else{let l,u;const c=()=>{if(l===void 0||u===void 0)return;const h=Math.max(l.length,u.length);h===0||e===1/0?this[$n]=!0:this[Nr]=l[h-1],a.length=h;for(let p=0;p<h;p++){const w=l[p],x=u[p];a[p]=[this[kt].keys&&w!==void 0?ls(w):void 0,this[kt].values&&x!==void 0?ls(x):void 0]}uu(o)};this[kt].keys||e<1/0?s.getAllKeys(i,e<1/0?e:void 0).onsuccess=h=>{l=h.target.result,c()}:(l=[],this.nextTick(c)),this[kt].values?s.getAll(i,e<1/0?e:void 0).onsuccess=h=>{u=h.target.result,c()}:(u=[],this.nextTick(c))}o.onabort=()=>{r(o.error||new Error("aborted by user")),r=null},o.oncomplete=()=>{r(null,a),r=null}}_next(e){if(this[cn].length>0){const[t,r]=this[cn].shift();this.nextTick(e,null,t,r)}else if(this[$n])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[_i]&&(this[_i]=!1,t=1),this._nextv(t,lu,(r,i)=>{if(r)return e(r);this[cn]=i,this._next(e)})}}_all(e,t){this[_i]=!1;const r=this[cn].splice(0,this[cn].length),i=this.limit-this.count-r.length;if(i<=0)return this.nextTick(t,null,r);this._nextv(i,lu,(o,s)=>{if(o)return t(o);r.length>0&&(s=r.concat(s)),t(null,s)})}_seek(e,t){this[_i]=!0,this[cn]=[],this[$n]=!1,this[Nr]=void 0,this[Un]={...this[kt]};let r;try{r=cu(this[kt])}catch{this[$n]=!0;return}r!==null&&!r.includes(e)?this[$n]=!0:this[kt].reverse?this[Un].lte=e:this[Un].gte=e}};Ef.Iterator=h0;function uu(n){typeof n.commit=="function"&&n.commit()}var y0=function(e,t,r,i,o){if(i.limit===0)return e.nextTick(o);const s=e.db.transaction([t],"readwrite"),a=s.objectStore(t);let l=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};const u=a.openKeyCursor?"openKeyCursor":"openCursor",c=i.reverse?"prev":"next";a[u](r,c).onsuccess=function(h){const p=h.target.result;p&&(a.delete(p.key).onsuccess=function(){(i.limit<=0||++l<i.limit)&&p.continue()})}};const{AbstractLevel:p0}=Ar,du=Tn,g0=c0,{fromCallback:w0}=Fi,{Iterator:b0}=Ef,fu=xf,m0=y0,v0=_f,Sf="level-js-",oo=Symbol("idb"),Da=Symbol("namePrefix"),Nn=Symbol("location"),Pa=Symbol("version"),Dr=Symbol("store"),so=Symbol("onComplete"),hu=Symbol("promise");class E0 extends p0{constructor(e,t,r){if(typeof t=="function"||typeof r=="function")throw new du("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:i,version:o,...s}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),typeof e!="string")throw new Error("constructor requires a location string argument");this[Nn]=e,this[Da]=i??Sf,this[Pa]=parseInt(o||1,10),this[oo]=null}get location(){return this[Nn]}get namePrefix(){return this[Da]}get version(){return this[Pa]}get db(){return this[oo]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[Da]+this[Nn],this[Pa]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[oo]=r.result,t()},r.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains(this[Nn])||o.createObjectStore(this[Nn])}}[Dr](e){return this[oo].transaction([this[Nn]],e).objectStore(this[Nn])}[so](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const i=this[Dr]("readonly");let o;try{o=i.get(e)}catch(s){return this.nextTick(r,s)}this[so](o,function(s,a){if(s)return r(s);if(a===void 0)return r(new du("Entry not found",{code:"LEVEL_NOT_FOUND"}));r(null,fu(a))})}_getMany(e,t,r){const i=this[Dr]("readonly"),o=e.map(s=>a=>{let l;try{l=i.get(s)}catch(u){return a(u)}l.onsuccess=()=>{const u=l.result;a(null,u===void 0?u:fu(u))},l.onerror=u=>{u.stopPropagation(),a(l.error)}});g0(o,16,r)}_del(e,t,r){const i=this[Dr]("readwrite");let o;try{o=i.delete(e)}catch(s){return this.nextTick(r,s)}this[so](o,r)}_put(e,t,r,i){const o=this[Dr]("readwrite");let s;try{s=o.put(t,e)}catch(a){return this.nextTick(i,a)}this[so](s,i)}_iterator(e){return new b0(this,this[Nn],e)}_batch(e,t,r){const i=this[Dr]("readwrite"),o=i.transaction;let s=0,a;o.onabort=function(){r(a||o.error||new Error("aborted by user"))},o.oncomplete=function(){r()};function l(){const u=e[s++],c=u.key;let h;try{h=u.type==="del"?i.delete(c):i.put(u.value,c)}catch(p){a=p,o.abort();return}s<e.length?h.onsuccess=l:typeof o.commit=="function"&&o.commit()}l()}_clear(e,t){let r,i;try{r=v0(e)}catch{return this.nextTick(t)}if(e.limit>=0)return m0(this,this[Nn],r,e,t);try{const o=this[Dr]("readwrite");i=r?o.delete(r):o.clear()}catch(o){return this.nextTick(t,o)}this[so](i,t)}_close(e){this[oo].close(),this.nextTick(e)}}E0.destroy=function(n,e,t){typeof e=="function"&&(t=e,e=Sf),t=w0(t,hu);const r=indexedDB.deleteDatabase(e+n);return r.onsuccess=function(){t()},r.onerror=function(i){t(i)},t[hu]};var Pr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class _0{constructor(){this.store=new Map}clear(){return Pr(this,void 0,void 0,function*(){this.store.clear()})}close(){return Pr(this,void 0,void 0,function*(){})}delete(e){return Pr(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Pr(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Pr(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Pr(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,t){return Pr(this,void 0,void 0,function*(){this.store.set(e,t)})}}var x0={exports:{}},Ma={exports:{}},Ze={ArrayIsArray(n){return Array.isArray(n)},ArrayPrototypeIncludes(n,e){return n.includes(e)},ArrayPrototypeIndexOf(n,e){return n.indexOf(e)},ArrayPrototypeJoin(n,e){return n.join(e)},ArrayPrototypeMap(n,e){return n.map(e)},ArrayPrototypePop(n,e){return n.pop(e)},ArrayPrototypePush(n,e){return n.push(e)},ArrayPrototypeSlice(n,e,t){return n.slice(e,t)},Error,FunctionPrototypeCall(n,e,...t){return n.call(e,...t)},FunctionPrototypeSymbolHasInstance(n,e){return Function.prototype[Symbol.hasInstance].call(n,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(n,e){return Object.defineProperties(n,e)},ObjectDefineProperty(n,e,t){return Object.defineProperty(n,e,t)},ObjectGetOwnPropertyDescriptor(n,e){return Object.getOwnPropertyDescriptor(n,e)},ObjectKeys(n){return Object.keys(n)},ObjectSetPrototypeOf(n,e){return Object.setPrototypeOf(n,e)},Promise,PromisePrototypeCatch(n,e){return n.catch(e)},PromisePrototypeThen(n,e,t){return n.then(e,t)},PromiseReject(n){return Promise.reject(n)},PromiseResolve(n){return Promise.resolve(n)},ReflectApply:Reflect.apply,RegExpPrototypeTest(n,e){return n.test(e)},SafeSet:Set,String,StringPrototypeSlice(n,e,t){return n.slice(e,t)},StringPrototypeToLowerCase(n){return n.toLowerCase()},StringPrototypeToUpperCase(n){return n.toUpperCase()},StringPrototypeTrim(n){return n.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(n,e,t){return n.set(e,t)},Boolean,Uint8Array},Af={exports:{}},ao={exports:{}},yu;function Io(){if(yu)return ao.exports;yu=1;const{AbortController:n,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return ao.exports=n,ao.exports.AbortSignal=e,ao.exports.default=n,ao.exports}(function(n){const e=Jt,{kResistStopPropagation:t,SymbolDispose:r}=Ze,i=globalThis.AbortSignal||Io().AbortSignal,o=globalThis.AbortController||Io().AbortController,s=Object.getPrototypeOf(async function(){}).constructor,a=globalThis.Blob||e.Blob,l=typeof a<"u"?function(w){return w instanceof a}:function(w){return!1},u=(p,w)=>{if(p!==void 0&&(p===null||typeof p!="object"||!("aborted"in p)))throw new ERR_INVALID_ARG_TYPE(w,"AbortSignal",p)},c=(p,w)=>{if(typeof p!="function")throw new ERR_INVALID_ARG_TYPE(w,"Function",p)};class h extends Error{constructor(w){if(!Array.isArray(w))throw new TypeError(`Expected input to be an Array, got ${typeof w}`);let x="";for(let g=0;g<w.length;g++)x+=`    ${w[g].stack}
`;super(x),this.name="AggregateError",this.errors=w}}n.exports={AggregateError:h,kEmptyObject:Object.freeze({}),once(p){let w=!1;return function(...x){w||(w=!0,p.apply(this,x))}},createDeferredPromise:function(){let p,w;return{promise:new Promise((g,R)=>{p=g,w=R}),resolve:p,reject:w}},promisify(p){return new Promise((w,x)=>{p((g,...R)=>g?x(g):w(...R))})},debuglog(){return function(){}},format(p,...w){return p.replace(/%([sdifj])/g,function(...[x,g]){const R=w.shift();return g==="f"?R.toFixed(6):g==="j"?JSON.stringify(R):g==="s"&&typeof R=="object"?`${R.constructor!==Object?R.constructor.name:""} {}`.trim():R.toString()})},inspect(p){switch(typeof p){case"string":if(p.includes("'"))if(p.includes('"')){if(!p.includes("`")&&!p.includes("${"))return`\`${p}\``}else return`"${p}"`;return`'${p}'`;case"number":return isNaN(p)?"NaN":Object.is(p,-0)?String(p):p;case"bigint":return`${String(p)}n`;case"boolean":case"undefined":return String(p);case"object":return"{}"}},types:{isAsyncFunction(p){return p instanceof s},isArrayBufferView(p){return ArrayBuffer.isView(p)}},isBlob:l,deprecate(p,w){return p},addAbortListener:No.addAbortListener||function(w,x){if(w===void 0)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",w);u(w,"signal"),c(x,"listener");let g;return w.aborted?queueMicrotask(()=>x()):(w.addEventListener("abort",x,{__proto__:null,once:!0,[t]:!0}),g=()=>{w.removeEventListener("abort",x)}),{__proto__:null,[r](){var R;(R=g)===null||R===void 0||R()}}},AbortSignalAny:i.any||function(w){if(w.length===1)return w[0];const x=new o,g=()=>x.abort();return w.forEach(R=>{u(R,"signals"),R.addEventListener("abort",g,{once:!0})}),x.signal.addEventListener("abort",()=>{w.forEach(R=>R.removeEventListener("abort",g))},{once:!0}),x.signal}},n.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(Af);var St=Af.exports,ul={};const{format:S0,inspect:js,AggregateError:A0}=St,T0=globalThis.AggregateError||A0,I0=Symbol("kIsNodeError"),R0=["string","function","number","object","Function","Object","boolean","bigint","symbol"],O0=/^([A-Z][a-z0-9]*)+$/,k0="__node_internal_",na={};function Jr(n,e){if(!n)throw new na.ERR_INTERNAL_ASSERTION(e)}function pu(n){let e="",t=n.length;const r=n[0]==="-"?1:0;for(;t>=r+4;t-=3)e=`_${n.slice(t-3,t)}${e}`;return`${n.slice(0,t)}${e}`}function B0(n,e,t){if(typeof e=="function")return Jr(e.length<=t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${e.length}).`),e(...t);const r=(e.match(/%[dfijoOs]/g)||[]).length;return Jr(r===t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${r}).`),t.length===0?e:S0(e,...t)}function wt(n,e,t){t||(t=Error);class r extends t{constructor(...o){super(B0(n,e,o))}toString(){return`${this.name} [${n}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:t.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${n}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=n,r.prototype[I0]=!0,na[n]=r}function gu(n){const e=k0+n.name;return Object.defineProperty(n,"name",{value:e}),n}function L0(n,e){if(n&&e&&n!==e){if(Array.isArray(e.errors))return e.errors.push(n),e;const t=new T0([e,n],e.message);return t.code=e.code,t}return n||e}let C0=class extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!="object")throw new na.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};wt("ERR_ASSERTION","%s",Error);wt("ERR_INVALID_ARG_TYPE",(n,e,t)=>{Jr(typeof n=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let r="The ";n.endsWith(" argument")?r+=`${n} `:r+=`"${n}" ${n.includes(".")?"property":"argument"} `,r+="must be ";const i=[],o=[],s=[];for(const l of e)Jr(typeof l=="string","All expected entries have to be of type string"),R0.includes(l)?i.push(l.toLowerCase()):O0.test(l)?o.push(l):(Jr(l!=="object",'The value "object" should be written as "Object"'),s.push(l));if(o.length>0){const l=i.indexOf("object");l!==-1&&(i.splice(i,l,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:r+=`of type ${i[0]}`;break;case 2:r+=`one of type ${i[0]} or ${i[1]}`;break;default:{const l=i.pop();r+=`one of type ${i.join(", ")}, or ${l}`}}(o.length>0||s.length>0)&&(r+=" or ")}if(o.length>0){switch(o.length){case 1:r+=`an instance of ${o[0]}`;break;case 2:r+=`an instance of ${o[0]} or ${o[1]}`;break;default:{const l=o.pop();r+=`an instance of ${o.join(", ")}, or ${l}`}}s.length>0&&(r+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(r+="an "),r+=`${s[0]}`;break;case 2:r+=`one of ${s[0]} or ${s[1]}`;break;default:{const l=s.pop();r+=`one of ${s.join(", ")}, or ${l}`}}if(t==null)r+=`. Received ${t}`;else if(typeof t=="function"&&t.name)r+=`. Received function ${t.name}`;else if(typeof t=="object"){var a;if((a=t.constructor)!==null&&a!==void 0&&a.name)r+=`. Received an instance of ${t.constructor.name}`;else{const l=js(t,{depth:-1});r+=`. Received ${l}`}}else{let l=js(t,{colors:!1});l.length>25&&(l=`${l.slice(0,25)}...`),r+=`. Received type ${typeof t} (${l})`}return r},TypeError);wt("ERR_INVALID_ARG_VALUE",(n,e,t="is invalid")=>{let r=js(e);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${n.includes(".")?"property":"argument"} '${n}' ${t}. Received ${r}`},TypeError);wt("ERR_INVALID_RETURN_VALUE",(n,e,t)=>{var r;const i=t!=null&&(r=t.constructor)!==null&&r!==void 0&&r.name?`instance of ${t.constructor.name}`:`type ${typeof t}`;return`Expected ${n} to be returned from the "${e}" function but got ${i}.`},TypeError);wt("ERR_MISSING_ARGS",(...n)=>{Jr(n.length>0,"At least one arg needs to be specified");let e;const t=n.length;switch(n=(Array.isArray(n)?n:[n]).map(r=>`"${r}"`).join(" or "),t){case 1:e+=`The ${n[0]} argument`;break;case 2:e+=`The ${n[0]} and ${n[1]} arguments`;break;default:{const r=n.pop();e+=`The ${n.join(", ")}, and ${r} arguments`}break}return`${e} must be specified`},TypeError);wt("ERR_OUT_OF_RANGE",(n,e,t)=>{Jr(e,'Missing "range" argument');let r;return Number.isInteger(t)&&Math.abs(t)>2**32?r=pu(String(t)):typeof t=="bigint"?(r=String(t),(t>2n**32n||t<-(2n**32n))&&(r=pu(r)),r+="n"):r=js(t),`The value of "${n}" is out of range. It must be ${e}. Received ${r}`},RangeError);wt("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);wt("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);wt("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);wt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);wt("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);wt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);wt("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);wt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);wt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);wt("ERR_STREAM_WRITE_AFTER_END","write after end",Error);wt("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Rt={AbortError:C0,aggregateTwoErrors:gu(L0),hideStackFrames:gu,codes:na};const{ArrayIsArray:dl,ArrayPrototypeIncludes:Tf,ArrayPrototypeJoin:If,ArrayPrototypeMap:$0,NumberIsInteger:fl,NumberIsNaN:U0,NumberMAX_SAFE_INTEGER:N0,NumberMIN_SAFE_INTEGER:D0,NumberParseInt:P0,ObjectPrototypeHasOwnProperty:M0,RegExpPrototypeExec:Rf,String:K0,StringPrototypeToUpperCase:F0,StringPrototypeTrim:j0}=Ze,{hideStackFrames:Xt,codes:{ERR_SOCKET_BAD_PORT:H0,ERR_INVALID_ARG_TYPE:mt,ERR_INVALID_ARG_VALUE:ji,ERR_OUT_OF_RANGE:ti,ERR_UNKNOWN_SIGNAL:wu}}=Rt,{normalizeEncoding:V0}=St,{isAsyncFunction:W0,isArrayBufferView:q0}=St.types,bu={};function z0(n){return n===(n|0)}function G0(n){return n===n>>>0}const Y0=/^[0-7]+$/,J0="must be a 32-bit unsigned integer or an octal string";function X0(n,e,t){if(typeof n>"u"&&(n=t),typeof n=="string"){if(Rf(Y0,n)===null)throw new ji(e,n,J0);n=P0(n,8)}return Of(n,e),n}const Z0=Xt((n,e,t=D0,r=N0)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!fl(n))throw new ti(e,"an integer",n);if(n<t||n>r)throw new ti(e,`>= ${t} && <= ${r}`,n)}),Q0=Xt((n,e,t=-2147483648,r=2147483647)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!fl(n))throw new ti(e,"an integer",n);if(n<t||n>r)throw new ti(e,`>= ${t} && <= ${r}`,n)}),Of=Xt((n,e,t=!1)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!fl(n))throw new ti(e,"an integer",n);const r=t?1:0,i=4294967295;if(n<r||n>i)throw new ti(e,`>= ${r} && <= ${i}`,n)});function hl(n,e){if(typeof n!="string")throw new mt(e,"string",n)}function eg(n,e,t=void 0,r){if(typeof n!="number")throw new mt(e,"number",n);if(t!=null&&n<t||r!=null&&n>r||(t!=null||r!=null)&&U0(n))throw new ti(e,`${t!=null?`>= ${t}`:""}${t!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,n)}const tg=Xt((n,e,t)=>{if(!Tf(t,n)){const i="must be one of: "+If($0(t,o=>typeof o=="string"?`'${o}'`:K0(o)),", ");throw new ji(e,n,i)}});function kf(n,e){if(typeof n!="boolean")throw new mt(e,"boolean",n)}function Ka(n,e,t){return n==null||!M0(n,e)?t:n[e]}const ng=Xt((n,e,t=null)=>{const r=Ka(t,"allowArray",!1),i=Ka(t,"allowFunction",!1);if(!Ka(t,"nullable",!1)&&n===null||!r&&dl(n)||typeof n!="object"&&(!i||typeof n!="function"))throw new mt(e,"Object",n)}),rg=Xt((n,e)=>{if(n!=null&&typeof n!="object"&&typeof n!="function")throw new mt(e,"a dictionary",n)}),ra=Xt((n,e,t=0)=>{if(!dl(n))throw new mt(e,"Array",n);if(n.length<t){const r=`must be longer than ${t}`;throw new ji(e,n,r)}});function ig(n,e){ra(n,e);for(let t=0;t<n.length;t++)hl(n[t],`${e}[${t}]`)}function og(n,e){ra(n,e);for(let t=0;t<n.length;t++)kf(n[t],`${e}[${t}]`)}function sg(n,e){ra(n,e);for(let t=0;t<n.length;t++){const r=n[t],i=`${e}[${t}]`;if(r==null)throw new mt(i,"AbortSignal",r);Bf(r,i)}}function ag(n,e="signal"){if(hl(n,e),bu[n]===void 0)throw bu[F0(n)]!==void 0?new wu(n+" (signals must use all capital letters)"):new wu(n)}const cg=Xt((n,e="buffer")=>{if(!q0(n))throw new mt(e,["Buffer","TypedArray","DataView"],n)});function lg(n,e){const t=V0(e),r=n.length;if(t==="hex"&&r%2!==0)throw new ji("encoding",e,`is invalid for data of length ${r}`)}function ug(n,e="Port",t=!0){if(typeof n!="number"&&typeof n!="string"||typeof n=="string"&&j0(n).length===0||+n!==+n>>>0||n>65535||n===0&&!t)throw new H0(e,n,t);return n|0}const Bf=Xt((n,e)=>{if(n!==void 0&&(n===null||typeof n!="object"||!("aborted"in n)))throw new mt(e,"AbortSignal",n)}),dg=Xt((n,e)=>{if(typeof n!="function")throw new mt(e,"Function",n)}),fg=Xt((n,e)=>{if(typeof n!="function"||W0(n))throw new mt(e,"Function",n)}),hg=Xt((n,e)=>{if(n!==void 0)throw new mt(e,"undefined",n)});function yg(n,e,t){if(!Tf(t,n))throw new mt(e,`('${If(t,"|")}')`,n)}const pg=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function mu(n,e){if(typeof n>"u"||!Rf(pg,n))throw new ji(e,n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function gg(n){if(typeof n=="string")return mu(n,"hints"),n;if(dl(n)){const e=n.length;let t="";if(e===0)return t;for(let r=0;r<e;r++){const i=n[r];mu(i,"hints"),t+=i,r!==e-1&&(t+=", ")}return t}throw new ji("hints",n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var Po={isInt32:z0,isUint32:G0,parseFileMode:X0,validateArray:ra,validateStringArray:ig,validateBooleanArray:og,validateAbortSignalArray:sg,validateBoolean:kf,validateBuffer:cg,validateDictionary:rg,validateEncoding:lg,validateFunction:dg,validateInt32:Q0,validateInteger:Z0,validateNumber:eg,validateObject:ng,validateOneOf:tg,validatePlainFunction:fg,validatePort:ug,validateSignalName:ag,validateString:hl,validateUint32:Of,validateUndefined:hg,validateUnion:yg,validateAbortSignal:Bf,validateLinkHeaderValue:gg},yl={exports:{}},Lf={exports:{}},rt=Lf.exports={},hn,yn;function mc(){throw new Error("setTimeout has not been defined")}function vc(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?hn=setTimeout:hn=mc}catch{hn=mc}try{typeof clearTimeout=="function"?yn=clearTimeout:yn=vc}catch{yn=vc}})();function Cf(n){if(hn===setTimeout)return setTimeout(n,0);if((hn===mc||!hn)&&setTimeout)return hn=setTimeout,setTimeout(n,0);try{return hn(n,0)}catch{try{return hn.call(null,n,0)}catch{return hn.call(this,n,0)}}}function wg(n){if(yn===clearTimeout)return clearTimeout(n);if((yn===vc||!yn)&&clearTimeout)return yn=clearTimeout,clearTimeout(n);try{return yn(n)}catch{try{return yn.call(null,n)}catch{return yn.call(this,n)}}}var zn=[],Bi=!1,qr,As=-1;function bg(){!Bi||!qr||(Bi=!1,qr.length?zn=qr.concat(zn):As=-1,zn.length&&$f())}function $f(){if(!Bi){var n=Cf(bg);Bi=!0;for(var e=zn.length;e;){for(qr=zn,zn=[];++As<e;)qr&&qr[As].run();As=-1,e=zn.length}qr=null,Bi=!1,wg(n)}}rt.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];zn.push(new Uf(n,e)),zn.length===1&&!Bi&&Cf($f)};function Uf(n,e){this.fun=n,this.array=e}Uf.prototype.run=function(){this.fun.apply(null,this.array)};rt.title="browser";rt.browser=!0;rt.env={};rt.argv=[];rt.version="";rt.versions={};function Zn(){}rt.on=Zn;rt.addListener=Zn;rt.once=Zn;rt.off=Zn;rt.removeListener=Zn;rt.removeAllListeners=Zn;rt.emit=Zn;rt.prependListener=Zn;rt.prependOnceListener=Zn;rt.listeners=function(n){return[]};rt.binding=function(n){throw new Error("process.binding is not supported")};rt.cwd=function(){return"/"};rt.chdir=function(n){throw new Error("process.chdir is not supported")};rt.umask=function(){return 0};var ci=Lf.exports;const{SymbolAsyncIterator:vu,SymbolIterator:Eu,SymbolFor:li}=Ze,Nf=li("nodejs.stream.destroyed"),Df=li("nodejs.stream.errored"),Ec=li("nodejs.stream.readable"),_c=li("nodejs.stream.writable"),Pf=li("nodejs.stream.disturbed"),mg=li("nodejs.webstream.isClosedPromise"),vg=li("nodejs.webstream.controllerErrorFunction");function ia(n,e=!1){var t;return!!(n&&typeof n.pipe=="function"&&typeof n.on=="function"&&(!e||typeof n.pause=="function"&&typeof n.resume=="function")&&(!n._writableState||((t=n._readableState)===null||t===void 0?void 0:t.readable)!==!1)&&(!n._writableState||n._readableState))}function oa(n){var e;return!!(n&&typeof n.write=="function"&&typeof n.on=="function"&&(!n._readableState||((e=n._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function Eg(n){return!!(n&&typeof n.pipe=="function"&&n._readableState&&typeof n.on=="function"&&typeof n.write=="function")}function Rn(n){return n&&(n._readableState||n._writableState||typeof n.write=="function"&&typeof n.on=="function"||typeof n.pipe=="function"&&typeof n.on=="function")}function Mf(n){return!!(n&&!Rn(n)&&typeof n.pipeThrough=="function"&&typeof n.getReader=="function"&&typeof n.cancel=="function")}function Kf(n){return!!(n&&!Rn(n)&&typeof n.getWriter=="function"&&typeof n.abort=="function")}function Ff(n){return!!(n&&!Rn(n)&&typeof n.readable=="object"&&typeof n.writable=="object")}function _g(n){return Mf(n)||Kf(n)||Ff(n)}function xg(n,e){return n==null?!1:e===!0?typeof n[vu]=="function":e===!1?typeof n[Eu]=="function":typeof n[vu]=="function"||typeof n[Eu]=="function"}function sa(n){if(!Rn(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!!(n.destroyed||n[Nf]||r!=null&&r.destroyed)}function jf(n){if(!oa(n))return null;if(n.writableEnded===!0)return!0;const e=n._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function Sg(n,e){if(!oa(n))return null;if(n.writableFinished===!0)return!0;const t=n._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.finished)!="boolean"?null:!!(t.finished||e===!1&&t.ended===!0&&t.length===0)}function Ag(n){if(!ia(n))return null;if(n.readableEnded===!0)return!0;const e=n._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function Hf(n,e){if(!ia(n))return null;const t=n._readableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.endEmitted)!="boolean"?null:!!(t.endEmitted||e===!1&&t.ended===!0&&t.length===0)}function Vf(n){return n&&n[Ec]!=null?n[Ec]:typeof(n==null?void 0:n.readable)!="boolean"?null:sa(n)?!1:ia(n)&&n.readable&&!Hf(n)}function Wf(n){return n&&n[_c]!=null?n[_c]:typeof(n==null?void 0:n.writable)!="boolean"?null:sa(n)?!1:oa(n)&&n.writable&&!jf(n)}function Tg(n,e){return Rn(n)?sa(n)?!0:!((e==null?void 0:e.readable)!==!1&&Vf(n)||(e==null?void 0:e.writable)!==!1&&Wf(n)):null}function Ig(n){var e,t;return Rn(n)?n.writableErrored?n.writableErrored:(e=(t=n._writableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function Rg(n){var e,t;return Rn(n)?n.readableErrored?n.readableErrored:(e=(t=n._readableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function Og(n){if(!Rn(n))return null;if(typeof n.closed=="boolean")return n.closed;const e=n._writableState,t=n._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(t==null?void 0:t.closed)=="boolean"?(e==null?void 0:e.closed)||(t==null?void 0:t.closed):typeof n._closed=="boolean"&&qf(n)?n._closed:null}function qf(n){return typeof n._closed=="boolean"&&typeof n._defaultKeepAlive=="boolean"&&typeof n._removedConnection=="boolean"&&typeof n._removedContLen=="boolean"}function zf(n){return typeof n._sent100=="boolean"&&qf(n)}function kg(n){var e;return typeof n._consuming=="boolean"&&typeof n._dumped=="boolean"&&((e=n.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function Bg(n){if(!Rn(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!r&&zf(n)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function Lg(n){var e;return!!(n&&((e=n[Pf])!==null&&e!==void 0?e:n.readableDidRead||n.readableAborted))}function Cg(n){var e,t,r,i,o,s,a,l,u,c;return!!(n&&((e=(t=(r=(i=(o=(s=n[Df])!==null&&s!==void 0?s:n.readableErrored)!==null&&o!==void 0?o:n.writableErrored)!==null&&i!==void 0?i:(a=n._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&r!==void 0?r:(l=n._writableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&t!==void 0?t:(u=n._readableState)===null||u===void 0?void 0:u.errored)!==null&&e!==void 0?e:!((c=n._writableState)===null||c===void 0)&&c.errored))}var Qn={isDestroyed:sa,kIsDestroyed:Nf,isDisturbed:Lg,kIsDisturbed:Pf,isErrored:Cg,kIsErrored:Df,isReadable:Vf,kIsReadable:Ec,kIsClosedPromise:mg,kControllerErrorFunction:vg,kIsWritable:_c,isClosed:Og,isDuplexNodeStream:Eg,isFinished:Tg,isIterable:xg,isReadableNodeStream:ia,isReadableStream:Mf,isReadableEnded:Ag,isReadableFinished:Hf,isReadableErrored:Rg,isNodeStream:Rn,isWebStream:_g,isWritable:Wf,isWritableNodeStream:oa,isWritableStream:Kf,isWritableEnded:jf,isWritableFinished:Sg,isWritableErrored:Ig,isServerRequest:kg,isServerResponse:zf,willEmitClose:Bg,isTransformStream:Ff};const yr=ci,{AbortError:Gf,codes:$g}=Rt,{ERR_INVALID_ARG_TYPE:Ug,ERR_STREAM_PREMATURE_CLOSE:_u}=$g,{kEmptyObject:xc,once:Sc}=St,{validateAbortSignal:Ng,validateFunction:Dg,validateObject:Pg,validateBoolean:Mg}=Po,{Promise:Kg,PromisePrototypeThen:Fg,SymbolDispose:Yf}=Ze,{isClosed:jg,isReadable:xu,isReadableNodeStream:Fa,isReadableStream:Hg,isReadableFinished:Su,isReadableErrored:Au,isWritable:Tu,isWritableNodeStream:Iu,isWritableStream:Vg,isWritableFinished:Ru,isWritableErrored:Ou,isNodeStream:Wg,willEmitClose:qg,kIsClosedPromise:zg}=Qn;let Li;function Gg(n){return n.setHeader&&typeof n.abort=="function"}const Ac=()=>{};function Jf(n,e,t){var r,i;if(arguments.length===2?(t=e,e=xc):e==null?e=xc:Pg(e,"options"),Dg(t,"callback"),Ng(e.signal,"options.signal"),t=Sc(t),Hg(n)||Vg(n))return Yg(n,e,t);if(!Wg(n))throw new Ug("stream",["ReadableStream","WritableStream","Stream"],n);const o=(r=e.readable)!==null&&r!==void 0?r:Fa(n),s=(i=e.writable)!==null&&i!==void 0?i:Iu(n),a=n._writableState,l=n._readableState,u=()=>{n.writable||p()};let c=qg(n)&&Fa(n)===o&&Iu(n)===s,h=Ru(n,!1);const p=()=>{h=!0,n.destroyed&&(c=!1),!(c&&(!n.readable||o))&&(!o||w)&&t.call(n)};let w=Su(n,!1);const x=()=>{w=!0,n.destroyed&&(c=!1),!(c&&(!n.writable||s))&&(!s||h)&&t.call(n)},g=A=>{t.call(n,A)};let R=jg(n);const L=()=>{R=!0;const A=Ou(n)||Au(n);if(A&&typeof A!="boolean")return t.call(n,A);if(o&&!w&&Fa(n,!0)&&!Su(n,!1))return t.call(n,new _u);if(s&&!h&&!Ru(n,!1))return t.call(n,new _u);t.call(n)},$=()=>{R=!0;const A=Ou(n)||Au(n);if(A&&typeof A!="boolean")return t.call(n,A);t.call(n)},E=()=>{n.req.on("finish",p)};Gg(n)?(n.on("complete",p),c||n.on("abort",L),n.req?E():n.on("request",E)):s&&!a&&(n.on("end",u),n.on("close",u)),!c&&typeof n.aborted=="boolean"&&n.on("aborted",L),n.on("end",x),n.on("finish",p),e.error!==!1&&n.on("error",g),n.on("close",L),R?yr.nextTick(L):a!=null&&a.errorEmitted||l!=null&&l.errorEmitted?c||yr.nextTick($):(!o&&(!c||xu(n))&&(h||Tu(n)===!1)||!s&&(!c||Tu(n))&&(w||xu(n)===!1)||l&&n.req&&n.aborted)&&yr.nextTick($);const I=()=>{t=Ac,n.removeListener("aborted",L),n.removeListener("complete",p),n.removeListener("abort",L),n.removeListener("request",E),n.req&&n.req.removeListener("finish",p),n.removeListener("end",u),n.removeListener("close",u),n.removeListener("finish",p),n.removeListener("end",x),n.removeListener("error",g),n.removeListener("close",L)};if(e.signal&&!R){const A=()=>{const U=t;I(),U.call(n,new Gf(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)yr.nextTick(A);else{Li=Li||St.addAbortListener;const U=Li(e.signal,A),H=t;t=Sc((...W)=>{U[Yf](),H.apply(n,W)})}}return I}function Yg(n,e,t){let r=!1,i=Ac;if(e.signal)if(i=()=>{r=!0,t.call(n,new Gf(void 0,{cause:e.signal.reason}))},e.signal.aborted)yr.nextTick(i);else{Li=Li||St.addAbortListener;const s=Li(e.signal,i),a=t;t=Sc((...l)=>{s[Yf](),a.apply(n,l)})}const o=(...s)=>{r||yr.nextTick(()=>t.apply(n,s))};return Fg(n[zg].promise,o,o),Ac}function Jg(n,e){var t;let r=!1;return e===null&&(e=xc),(t=e)!==null&&t!==void 0&&t.cleanup&&(Mg(e.cleanup,"cleanup"),r=e.cleanup),new Kg((i,o)=>{const s=Jf(n,e,a=>{r&&s(),a?o(a):i()})})}yl.exports=Jf;yl.exports.finished=Jg;var Tr=yl.exports;const mn=ci,{aggregateTwoErrors:Xg,codes:{ERR_MULTIPLE_CALLBACK:Zg},AbortError:Qg}=Rt,{Symbol:Xf}=Ze,{kIsDestroyed:ew,isDestroyed:tw,isFinished:nw,isServerRequest:rw}=Qn,Zf=Xf("kDestroy"),Tc=Xf("kConstruct");function Qf(n,e,t){n&&(n.stack,e&&!e.errored&&(e.errored=n),t&&!t.errored&&(t.errored=n))}function iw(n,e){const t=this._readableState,r=this._writableState,i=r||t;return r!=null&&r.destroyed||t!=null&&t.destroyed?(typeof e=="function"&&e(),this):(Qf(n,r,t),r&&(r.destroyed=!0),t&&(t.destroyed=!0),i.constructed?ku(this,n,e):this.once(Zf,function(o){ku(this,Xg(o,n),e)}),this)}function ku(n,e,t){let r=!1;function i(o){if(r)return;r=!0;const s=n._readableState,a=n._writableState;Qf(o,a,s),a&&(a.closed=!0),s&&(s.closed=!0),typeof t=="function"&&t(o),o?mn.nextTick(ow,n,o):mn.nextTick(eh,n)}try{n._destroy(e||null,i)}catch(o){i(o)}}function ow(n,e){Ic(n,e),eh(n)}function eh(n){const e=n._readableState,t=n._writableState;t&&(t.closeEmitted=!0),e&&(e.closeEmitted=!0),(t!=null&&t.emitClose||e!=null&&e.emitClose)&&n.emit("close")}function Ic(n,e){const t=n._readableState,r=n._writableState;r!=null&&r.errorEmitted||t!=null&&t.errorEmitted||(r&&(r.errorEmitted=!0),t&&(t.errorEmitted=!0),n.emit("error",e))}function sw(){const n=this._readableState,e=this._writableState;n&&(n.constructed=!0,n.closed=!1,n.closeEmitted=!1,n.destroyed=!1,n.errored=null,n.errorEmitted=!1,n.reading=!1,n.ended=n.readable===!1,n.endEmitted=n.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function Rc(n,e,t){const r=n._readableState,i=n._writableState;if(i!=null&&i.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||i!=null&&i.autoDestroy?n.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),r&&!r.errored&&(r.errored=e),t?mn.nextTick(Ic,n,e):Ic(n,e))}function aw(n,e){if(typeof n._construct!="function")return;const t=n._readableState,r=n._writableState;t&&(t.constructed=!1),r&&(r.constructed=!1),n.once(Tc,e),!(n.listenerCount(Tc)>1)&&mn.nextTick(cw,n)}function cw(n){let e=!1;function t(r){if(e){Rc(n,r??new Zg);return}e=!0;const i=n._readableState,o=n._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?n.emit(Zf,r):r?Rc(n,r,!0):mn.nextTick(lw,n)}try{n._construct(r=>{mn.nextTick(t,r)})}catch(r){mn.nextTick(t,r)}}function lw(n){n.emit(Tc)}function Bu(n){return(n==null?void 0:n.setHeader)&&typeof n.abort=="function"}function th(n){n.emit("close")}function uw(n,e){n.emit("error",e),mn.nextTick(th,n)}function dw(n,e){!n||tw(n)||(!e&&!nw(n)&&(e=new Qg),rw(n)?(n.socket=null,n.destroy(e)):Bu(n)?n.abort():Bu(n.req)?n.req.abort():typeof n.destroy=="function"?n.destroy(e):typeof n.close=="function"?n.close():e?mn.nextTick(uw,n,e):mn.nextTick(th,n),n.destroyed||(n[ew]=!0))}var Hi={construct:aw,destroyer:dw,destroy:iw,undestroy:sw,errorOrDestroy:Rc};const{ArrayIsArray:fw,ObjectSetPrototypeOf:nh}=Ze,{EventEmitter:aa}=No;function ca(n){aa.call(this,n)}nh(ca.prototype,aa.prototype);nh(ca,aa);ca.prototype.pipe=function(n,e){const t=this;function r(c){n.writable&&n.write(c)===!1&&t.pause&&t.pause()}t.on("data",r);function i(){t.readable&&t.resume&&t.resume()}n.on("drain",i),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",s),t.on("close",a));let o=!1;function s(){o||(o=!0,n.end())}function a(){o||(o=!0,typeof n.destroy=="function"&&n.destroy())}function l(c){u(),aa.listenerCount(this,"error")===0&&this.emit("error",c)}Oc(t,"error",l),Oc(n,"error",l);function u(){t.removeListener("data",r),n.removeListener("drain",i),t.removeListener("end",s),t.removeListener("close",a),t.removeListener("error",l),n.removeListener("error",l),t.removeListener("end",u),t.removeListener("close",u),n.removeListener("close",u)}return t.on("end",u),t.on("close",u),n.on("close",u),n.emit("pipe",t),n};function Oc(n,e,t){if(typeof n.prependListener=="function")return n.prependListener(e,t);!n._events||!n._events[e]?n.on(e,t):fw(n._events[e])?n._events[e].unshift(t):n._events[e]=[t,n._events[e]]}var pl={Stream:ca,prependListener:Oc},rh={exports:{}};(function(n){const{SymbolDispose:e}=Ze,{AbortError:t,codes:r}=Rt,{isNodeStream:i,isWebStream:o,kControllerErrorFunction:s}=Qn,a=Tr,{ERR_INVALID_ARG_TYPE:l}=r;let u;const c=(h,p)=>{if(typeof h!="object"||!("aborted"in h))throw new l(p,"AbortSignal",h)};n.exports.addAbortSignal=function(p,w){if(c(p,"signal"),!i(w)&&!o(w))throw new l("stream",["ReadableStream","WritableStream","Stream"],w);return n.exports.addAbortSignalNoValidate(p,w)},n.exports.addAbortSignalNoValidate=function(h,p){if(typeof h!="object"||!("aborted"in h))return p;const w=i(p)?()=>{p.destroy(new t(void 0,{cause:h.reason}))}:()=>{p[s](new t(void 0,{cause:h.reason}))};if(h.aborted)w();else{u=u||St.addAbortListener;const x=u(h,w);a(p,x[e])}return p}})(rh);var la=rh.exports;const{StringPrototypeSlice:Lu,SymbolIterator:hw,TypedArrayPrototypeSet:us,Uint8Array:yw}=Ze,{Buffer:ja}=Jt,{inspect:pw}=St;var gw=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let t=this.head,r=""+t.data;for(;(t=t.next)!==null;)r+=e+t.data;return r}concat(e){if(this.length===0)return ja.alloc(0);const t=ja.allocUnsafe(e>>>0);let r=this.head,i=0;for(;r;)us(t,r.data,i),i+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const i=r.slice(0,e);return this.head.data=r.slice(e),i}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[hw](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{const o=r.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=Lu(o,0,e),this.head=r,r.data=Lu(o,e));break}++i}while((r=r.next)!==null);return this.length-=i,t}_getBuffer(e){const t=ja.allocUnsafe(e),r=e;let i=this.head,o=0;do{const s=i.data;if(e>s.length)us(t,s,r-e),e-=s.length;else{e===s.length?(us(t,s,r-e),++o,i.next?this.head=i.next:this.head=this.tail=null):(us(t,new yw(s.buffer,s.byteOffset,e),r-e),this.head=i,i.data=s.slice(e));break}++o}while((i=i.next)!==null);return this.length-=o,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return pw(this,{...t,depth:0,customInspect:!1})}};const{MathFloor:ww,NumberIsInteger:bw}=Ze,{validateInteger:mw}=Po,{ERR_INVALID_ARG_VALUE:vw}=Rt.codes;let ih=16*1024,oh=16;function Ew(n,e,t){return n.highWaterMark!=null?n.highWaterMark:e?n[t]:null}function sh(n){return n?oh:ih}function _w(n,e){mw(e,"value",0),n?oh=e:ih=e}function xw(n,e,t,r){const i=Ew(e,r,t);if(i!=null){if(!bw(i)||i<0){const o=r?`options.${t}`:"options.highWaterMark";throw new vw(o,i)}return ww(i)}return sh(n.objectMode)}var ua={getHighWaterMark:xw,getDefaultHighWaterMark:sh,setDefaultHighWaterMark:_w},ah={},kc={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=Jt,r=t.Buffer;function i(s,a){for(var l in s)a[l]=s[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(i(t,e),e.Buffer=o);function o(s,a,l){return r(s,a,l)}o.prototype=Object.create(r.prototype),i(r,o),o.from=function(s,a,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,a,l)},o.alloc=function(s,a,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var u=r(s);return a!==void 0?typeof l=="string"?u.fill(a,l):u.fill(a):u.fill(0),u},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(s)}})(kc,kc.exports);var Sw=kc.exports,gl=Sw.Buffer,Cu=gl.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Aw(n){if(!n)return"utf8";for(var e;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(e)return;n=(""+n).toLowerCase(),e=!0}}function Tw(n){var e=Aw(n);if(typeof e!="string"&&(gl.isEncoding===Cu||!Cu(n)))throw new Error("Unknown encoding: "+n);return e||n}ah.StringDecoder=Mo;function Mo(n){this.encoding=Tw(n);var e;switch(this.encoding){case"utf16le":this.text=Lw,this.end=Cw,e=4;break;case"utf8":this.fillLast=Ow,e=4;break;case"base64":this.text=$w,this.end=Uw,e=3;break;default:this.write=Nw,this.end=Dw;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=gl.allocUnsafe(e)}Mo.prototype.write=function(n){if(n.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(n),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<n.length?e?e+this.text(n,t):this.text(n,t):e||""};Mo.prototype.end=Bw;Mo.prototype.text=kw;Mo.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function Ha(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function Iw(n,e,t){var r=e.length-1;if(r<t)return 0;var i=Ha(e[r]);return i>=0?(i>0&&(n.lastNeed=i-1),i):--r<t||i===-2?0:(i=Ha(e[r]),i>=0?(i>0&&(n.lastNeed=i-2),i):--r<t||i===-2?0:(i=Ha(e[r]),i>=0?(i>0&&(i===2?i=0:n.lastNeed=i-3),i):0))}function Rw(n,e,t){if((e[0]&192)!==128)return n.lastNeed=0,"";if(n.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return n.lastNeed=1,"";if(n.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return n.lastNeed=2,""}}function Ow(n){var e=this.lastTotal-this.lastNeed,t=Rw(this,n);if(t!==void 0)return t;if(this.lastNeed<=n.length)return n.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,e,0,n.length),this.lastNeed-=n.length}function kw(n,e){var t=Iw(this,n,e);if(!this.lastNeed)return n.toString("utf8",e);this.lastTotal=t;var r=n.length-(t-this.lastNeed);return n.copy(this.lastChar,0,r),n.toString("utf8",e,r)}function Bw(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"":e}function Lw(n,e){if((n.length-e)%2===0){var t=n.toString("utf16le",e);if(t){var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",e,n.length-1)}function Cw(n){var e=n&&n.length?this.write(n):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function $w(n,e){var t=(n.length-e)%3;return t===0?n.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",e,n.length-t))}function Uw(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Nw(n){return n.toString(this.encoding)}function Dw(n){return n&&n.length?this.write(n):""}const $u=ci,{PromisePrototypeThen:Pw,SymbolAsyncIterator:Uu,SymbolIterator:Nu}=Ze,{Buffer:Mw}=Jt,{ERR_INVALID_ARG_TYPE:Kw,ERR_STREAM_NULL_VALUES:Fw}=Rt.codes;function jw(n,e,t){let r;if(typeof e=="string"||e instanceof Mw)return new n({objectMode:!0,...t,read(){this.push(e),this.push(null)}});let i;if(e&&e[Uu])i=!0,r=e[Uu]();else if(e&&e[Nu])i=!1,r=e[Nu]();else throw new Kw("iterable",["Iterable"],e);const o=new n({objectMode:!0,highWaterMark:1,...t});let s=!1;o._read=function(){s||(s=!0,l())},o._destroy=function(u,c){Pw(a(u),()=>$u.nextTick(c,u),h=>$u.nextTick(c,h||u))};async function a(u){const c=u!=null,h=typeof r.throw=="function";if(c&&h){const{value:p,done:w}=await r.throw(u);if(await p,w)return}if(typeof r.return=="function"){const{value:p}=await r.return();await p}}async function l(){for(;;){try{const{value:u,done:c}=i?await r.next():r.next();if(c)o.push(null);else{const h=u&&typeof u.then=="function"?await u:u;if(h===null)throw s=!1,new Fw;if(o.push(h))continue;s=!1}}catch(u){o.destroy(u)}break}}return o}var ch=jw,Va,Du;function da(){if(Du)return Va;Du=1;const n=ci,{ArrayPrototypeIndexOf:e,NumberIsInteger:t,NumberIsNaN:r,NumberParseInt:i,ObjectDefineProperties:o,ObjectKeys:s,ObjectSetPrototypeOf:a,Promise:l,SafeSet:u,SymbolAsyncDispose:c,SymbolAsyncIterator:h,Symbol:p}=Ze;Va=D,D.ReadableState=j;const{EventEmitter:w}=No,{Stream:x,prependListener:g}=pl,{Buffer:R}=Jt,{addAbortSignal:L}=la,$=Tr;let E=St.debuglog("stream",b=>{E=b});const I=gw,A=Hi,{getHighWaterMark:U,getDefaultHighWaterMark:H}=ua,{aggregateTwoErrors:W,codes:{ERR_INVALID_ARG_TYPE:ee,ERR_METHOD_NOT_IMPLEMENTED:re,ERR_OUT_OF_RANGE:ne,ERR_STREAM_PUSH_AFTER_EOF:Q,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:M},AbortError:pe}=Rt,{validateObject:F}=Po,G=p("kPaused"),{StringDecoder:ie}=ah,q=ch;a(D.prototype,x.prototype),a(D,x);const K=()=>{},{errorOrDestroy:Y}=A,z=1,te=2,J=4,se=8,me=16,ge=32,de=64,_e=128,Re=256,Ke=512,Ue=1024,Le=2048,k=4096,C=8192,V=16384,y=32768,d=65536,f=1<<17,m=1<<18;function B(b){return{enumerable:!1,get(){return(this.state&b)!==0},set(S){S?this.state|=b:this.state&=~b}}}o(j.prototype,{objectMode:B(z),ended:B(te),endEmitted:B(J),reading:B(se),constructed:B(me),sync:B(ge),needReadable:B(de),emittedReadable:B(_e),readableListening:B(Re),resumeScheduled:B(Ke),errorEmitted:B(Ue),emitClose:B(Le),autoDestroy:B(k),destroyed:B(C),closed:B(V),closeEmitted:B(y),multiAwaitDrain:B(d),readingMore:B(f),dataEmitted:B(m)});function j(b,S,X){typeof X!="boolean"&&(X=S instanceof Gn()),this.state=Le|k|me|ge,b&&b.objectMode&&(this.state|=z),X&&b&&b.readableObjectMode&&(this.state|=z),this.highWaterMark=b?U(this,b,"readableHighWaterMark",X):H(!1),this.buffer=new I,this.length=0,this.pipes=[],this.flowing=null,this[G]=null,b&&b.emitClose===!1&&(this.state&=~Le),b&&b.autoDestroy===!1&&(this.state&=~k),this.errored=null,this.defaultEncoding=b&&b.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,b&&b.encoding&&(this.decoder=new ie(b.encoding),this.encoding=b.encoding)}function D(b){if(!(this instanceof D))return new D(b);const S=this instanceof Gn();this._readableState=new j(b,this,S),b&&(typeof b.read=="function"&&(this._read=b.read),typeof b.destroy=="function"&&(this._destroy=b.destroy),typeof b.construct=="function"&&(this._construct=b.construct),b.signal&&!S&&L(b.signal,this)),x.call(this,b),A.construct(this,()=>{this._readableState.needReadable&&On(this,this._readableState)})}D.prototype.destroy=A.destroy,D.prototype._undestroy=A.undestroy,D.prototype._destroy=function(b,S){S(b)},D.prototype[w.captureRejectionSymbol]=function(b){this.destroy(b)},D.prototype[c]=function(){let b;return this.destroyed||(b=this.readableEnded?null:new pe,this.destroy(b)),new l((S,X)=>$(this,Z=>Z&&Z!==b?X(Z):S(null)))},D.prototype.push=function(b,S){return he(this,b,S,!1)},D.prototype.unshift=function(b,S){return he(this,b,S,!0)};function he(b,S,X,Z){E("readableAddChunk",S);const ae=b._readableState;let lt;if(ae.state&z||(typeof S=="string"?(X=X||ae.defaultEncoding,ae.encoding!==X&&(Z&&ae.encoding?S=R.from(S,X).toString(ae.encoding):(S=R.from(S,X),X=""))):S instanceof R?X="":x._isUint8Array(S)?(S=x._uint8ArrayToBuffer(S),X=""):S!=null&&(lt=new ee("chunk",["string","Buffer","Uint8Array"],S))),lt)Y(b,lt);else if(S===null)ae.state&=~se,Zt(b,ae);else if(ae.state&z||S&&S.length>0)if(Z)if(ae.state&J)Y(b,new M);else{if(ae.destroyed||ae.errored)return!1;Te(b,ae,S,!0)}else if(ae.ended)Y(b,new Q);else{if(ae.destroyed||ae.errored)return!1;ae.state&=~se,ae.decoder&&!X?(S=ae.decoder.write(S),ae.objectMode||S.length!==0?Te(b,ae,S,!1):On(b,ae)):Te(b,ae,S,!1)}else Z||(ae.state&=~se,On(b,ae));return!ae.ended&&(ae.length<ae.highWaterMark||ae.length===0)}function Te(b,S,X,Z){S.flowing&&S.length===0&&!S.sync&&b.listenerCount("data")>0?(S.state&d?S.awaitDrainWriters.clear():S.awaitDrainWriters=null,S.dataEmitted=!0,b.emit("data",X)):(S.length+=S.objectMode?1:X.length,Z?S.buffer.unshift(X):S.buffer.push(X),S.state&de&&it(b)),On(b,S)}D.prototype.isPaused=function(){const b=this._readableState;return b[G]===!0||b.flowing===!1},D.prototype.setEncoding=function(b){const S=new ie(b);this._readableState.decoder=S,this._readableState.encoding=this._readableState.decoder.encoding;const X=this._readableState.buffer;let Z="";for(const ae of X)Z+=S.write(ae);return X.clear(),Z!==""&&X.push(Z),this._readableState.length=Z.length,this};const Ce=1073741824;function qe(b){if(b>Ce)throw new ne("size","<= 1GiB",b);return b--,b|=b>>>1,b|=b>>>2,b|=b>>>4,b|=b>>>8,b|=b>>>16,b++,b}function Ne(b,S){return b<=0||S.length===0&&S.ended?0:S.state&z?1:r(b)?S.flowing&&S.length?S.buffer.first().length:S.length:b<=S.length?b:S.ended?S.length:0}D.prototype.read=function(b){E("read",b),b===void 0?b=NaN:t(b)||(b=i(b,10));const S=this._readableState,X=b;if(b>S.highWaterMark&&(S.highWaterMark=qe(b)),b!==0&&(S.state&=~_e),b===0&&S.needReadable&&((S.highWaterMark!==0?S.length>=S.highWaterMark:S.length>0)||S.ended))return E("read: emitReadable",S.length,S.ended),S.length===0&&S.ended?Wi(this):it(this),null;if(b=Ne(b,S),b===0&&S.ended)return S.length===0&&Wi(this),null;let Z=(S.state&de)!==0;if(E("need readable",Z),(S.length===0||S.length-b<S.highWaterMark)&&(Z=!0,E("length less than watermark",Z)),S.ended||S.reading||S.destroyed||S.errored||!S.constructed)Z=!1,E("reading, ended or constructing",Z);else if(Z){E("do read"),S.state|=se|ge,S.length===0&&(S.state|=de);try{this._read(S.highWaterMark)}catch(lt){Y(this,lt)}S.state&=~ge,S.reading||(b=Ne(X,S))}let ae;return b>0?ae=Go(b,S):ae=null,ae===null?(S.needReadable=S.length<=S.highWaterMark,b=0):(S.length-=b,S.multiAwaitDrain?S.awaitDrainWriters.clear():S.awaitDrainWriters=null),S.length===0&&(S.ended||(S.needReadable=!0),X!==b&&S.ended&&Wi(this)),ae!==null&&!S.errorEmitted&&!S.closeEmitted&&(S.dataEmitted=!0,this.emit("data",ae)),ae};function Zt(b,S){if(E("onEofChunk"),!S.ended){if(S.decoder){const X=S.decoder.end();X&&X.length&&(S.buffer.push(X),S.length+=S.objectMode?1:X.length)}S.ended=!0,S.sync?it(b):(S.needReadable=!1,S.emittedReadable=!0,Ot(b))}}function it(b){const S=b._readableState;E("emitReadable",S.needReadable,S.emittedReadable),S.needReadable=!1,S.emittedReadable||(E("emitReadable",S.flowing),S.emittedReadable=!0,n.nextTick(Ot,b))}function Ot(b){const S=b._readableState;E("emitReadable_",S.destroyed,S.length,S.ended),!S.destroyed&&!S.errored&&(S.length||S.ended)&&(b.emit("readable"),S.emittedReadable=!1),S.needReadable=!S.flowing&&!S.ended&&S.length<=S.highWaterMark,qo(b)}function On(b,S){!S.readingMore&&S.constructed&&(S.readingMore=!0,n.nextTick(hi,b,S))}function hi(b,S){for(;!S.reading&&!S.ended&&(S.length<S.highWaterMark||S.flowing&&S.length===0);){const X=S.length;if(E("maybeReadMore read 0"),b.read(0),X===S.length)break}S.readingMore=!1}D.prototype._read=function(b){throw new re("_read()")},D.prototype.pipe=function(b,S){const X=this,Z=this._readableState;Z.pipes.length===1&&(Z.multiAwaitDrain||(Z.multiAwaitDrain=!0,Z.awaitDrainWriters=new u(Z.awaitDrainWriters?[Z.awaitDrainWriters]:[]))),Z.pipes.push(b),E("pipe count=%d opts=%j",Z.pipes.length,S);const lt=(!S||S.end!==!1)&&b!==n.stdout&&b!==n.stderr?T:Fe;Z.endEmitted?n.nextTick(lt):X.once("end",lt),b.on("unpipe",vt);function vt(ve,ke){E("onunpipe"),ve===X&&ke&&ke.hasUnpiped===!1&&(ke.hasUnpiped=!0,P())}function T(){E("onend"),b.end()}let v,O=!1;function P(){E("cleanup"),b.removeListener("close",Ie),b.removeListener("finish",De),v&&b.removeListener("drain",v),b.removeListener("error",ue),b.removeListener("unpipe",vt),X.removeListener("end",T),X.removeListener("end",Fe),X.removeListener("data",le),O=!0,v&&Z.awaitDrainWriters&&(!b._writableState||b._writableState.needDrain)&&v()}function N(){O||(Z.pipes.length===1&&Z.pipes[0]===b?(E("false write response, pause",0),Z.awaitDrainWriters=b,Z.multiAwaitDrain=!1):Z.pipes.length>1&&Z.pipes.includes(b)&&(E("false write response, pause",Z.awaitDrainWriters.size),Z.awaitDrainWriters.add(b)),X.pause()),v||(v=kn(X,b),b.on("drain",v))}X.on("data",le);function le(ve){E("ondata");const ke=b.write(ve);E("dest.write",ke),ke===!1&&N()}function ue(ve){if(E("onerror",ve),Fe(),b.removeListener("error",ue),b.listenerCount("error")===0){const ke=b._writableState||b._readableState;ke&&!ke.errorEmitted?Y(b,ve):b.emit("error",ve)}}g(b,"error",ue);function Ie(){b.removeListener("finish",De),Fe()}b.once("close",Ie);function De(){E("onfinish"),b.removeListener("close",Ie),Fe()}b.once("finish",De);function Fe(){E("unpipe"),X.unpipe(b)}return b.emit("pipe",X),b.writableNeedDrain===!0?N():Z.flowing||(E("pipe resume"),X.resume()),b};function kn(b,S){return function(){const Z=b._readableState;Z.awaitDrainWriters===S?(E("pipeOnDrain",1),Z.awaitDrainWriters=null):Z.multiAwaitDrain&&(E("pipeOnDrain",Z.awaitDrainWriters.size),Z.awaitDrainWriters.delete(S)),(!Z.awaitDrainWriters||Z.awaitDrainWriters.size===0)&&b.listenerCount("data")&&b.resume()}}D.prototype.unpipe=function(b){const S=this._readableState,X={hasUnpiped:!1};if(S.pipes.length===0)return this;if(!b){const ae=S.pipes;S.pipes=[],this.pause();for(let lt=0;lt<ae.length;lt++)ae[lt].emit("unpipe",this,{hasUnpiped:!1});return this}const Z=e(S.pipes,b);return Z===-1?this:(S.pipes.splice(Z,1),S.pipes.length===0&&this.pause(),b.emit("unpipe",this,X),this)},D.prototype.on=function(b,S){const X=x.prototype.on.call(this,b,S),Z=this._readableState;return b==="data"?(Z.readableListening=this.listenerCount("readable")>0,Z.flowing!==!1&&this.resume()):b==="readable"&&!Z.endEmitted&&!Z.readableListening&&(Z.readableListening=Z.needReadable=!0,Z.flowing=!1,Z.emittedReadable=!1,E("on readable",Z.length,Z.reading),Z.length?it(this):Z.reading||n.nextTick(ma,this)),X},D.prototype.addListener=D.prototype.on,D.prototype.removeListener=function(b,S){const X=x.prototype.removeListener.call(this,b,S);return b==="readable"&&n.nextTick(Vi,this),X},D.prototype.off=D.prototype.removeListener,D.prototype.removeAllListeners=function(b){const S=x.prototype.removeAllListeners.apply(this,arguments);return(b==="readable"||b===void 0)&&n.nextTick(Vi,this),S};function Vi(b){const S=b._readableState;S.readableListening=b.listenerCount("readable")>0,S.resumeScheduled&&S[G]===!1?S.flowing=!0:b.listenerCount("data")>0?b.resume():S.readableListening||(S.flowing=null)}function ma(b){E("readable nexttick read 0"),b.read(0)}D.prototype.resume=function(){const b=this._readableState;return b.flowing||(E("resume"),b.flowing=!b.readableListening,Wo(this,b)),b[G]=!1,this};function Wo(b,S){S.resumeScheduled||(S.resumeScheduled=!0,n.nextTick(Pt,b,S))}function Pt(b,S){E("resume",S.reading),S.reading||b.read(0),S.resumeScheduled=!1,b.emit("resume"),qo(b),S.flowing&&!S.reading&&b.read(0)}D.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[G]=!0,this};function qo(b){const S=b._readableState;for(E("flow",S.flowing);S.flowing&&b.read()!==null;);}D.prototype.wrap=function(b){let S=!1;b.on("data",Z=>{!this.push(Z)&&b.pause&&(S=!0,b.pause())}),b.on("end",()=>{this.push(null)}),b.on("error",Z=>{Y(this,Z)}),b.on("close",()=>{this.destroy()}),b.on("destroy",()=>{this.destroy()}),this._read=()=>{S&&b.resume&&(S=!1,b.resume())};const X=s(b);for(let Z=1;Z<X.length;Z++){const ae=X[Z];this[ae]===void 0&&typeof b[ae]=="function"&&(this[ae]=b[ae].bind(b))}return this},D.prototype[h]=function(){return zo(this)},D.prototype.iterator=function(b){return b!==void 0&&F(b,"options"),zo(this,b)};function zo(b,S){typeof b.read!="function"&&(b=D.wrap(b,{objectMode:!0}));const X=va(b,S);return X.stream=b,X}async function*va(b,S){let X=K;function Z(vt){this===b?(X(),X=K):X=vt}b.on("readable",Z);let ae;const lt=$(b,{writable:!1},vt=>{ae=vt?W(ae,vt):null,X(),X=K});try{for(;;){const vt=b.destroyed?null:b.read();if(vt!==null)yield vt;else{if(ae)throw ae;if(ae===null)return;await new l(Z)}}}catch(vt){throw ae=W(ae,vt),ae}finally{(ae||(S==null?void 0:S.destroyOnReturn)!==!1)&&(ae===void 0||b._readableState.autoDestroy)?A.destroyer(b,null):(b.off("readable",Z),lt())}}o(D.prototype,{readable:{__proto__:null,get(){const b=this._readableState;return!!b&&b.readable!==!1&&!b.destroyed&&!b.errorEmitted&&!b.endEmitted},set(b){this._readableState&&(this._readableState.readable=!!b)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(b){this._readableState&&(this._readableState.flowing=b)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(b){this._readableState&&(this._readableState.destroyed=b)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),o(j.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[G]!==!1},set(b){this[G]=!!b}}}),D._fromList=Go;function Go(b,S){if(S.length===0)return null;let X;return S.objectMode?X=S.buffer.shift():!b||b>=S.length?(S.decoder?X=S.buffer.join(""):S.buffer.length===1?X=S.buffer.first():X=S.buffer.concat(S.length),S.buffer.clear()):X=S.buffer.consume(b,S.decoder),X}function Wi(b){const S=b._readableState;E("endReadable",S.endEmitted),S.endEmitted||(S.ended=!0,n.nextTick(Ea,S,b))}function Ea(b,S){if(E("endReadableNT",b.endEmitted,b.length),!b.errored&&!b.closeEmitted&&!b.endEmitted&&b.length===0){if(b.endEmitted=!0,S.emit("end"),S.writable&&S.allowHalfOpen===!1)n.nextTick(er,S);else if(b.autoDestroy){const X=S._writableState;(!X||X.autoDestroy&&(X.finished||X.writable===!1))&&S.destroy()}}}function er(b){b.writable&&!b.writableEnded&&!b.destroyed&&b.end()}D.from=function(b,S){return q(D,b,S)};let qi;function zi(){return qi===void 0&&(qi={}),qi}return D.fromWeb=function(b,S){return zi().newStreamReadableFromReadableStream(b,S)},D.toWeb=function(b,S){return zi().newReadableStreamFromStreamReadable(b,S)},D.wrap=function(b,S){var X,Z;return new D({objectMode:(X=(Z=b.readableObjectMode)!==null&&Z!==void 0?Z:b.objectMode)!==null&&X!==void 0?X:!0,...S,destroy(ae,lt){A.destroyer(b,ae),lt(ae)}}).wrap(b)},Va}var Wa,Pu;function wl(){if(Pu)return Wa;Pu=1;const n=ci,{ArrayPrototypeSlice:e,Error:t,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:i,ObjectDefineProperties:o,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:a,Symbol:l,SymbolHasInstance:u}=Ze;Wa=F,F.WritableState=M;const{EventEmitter:c}=No,h=pl.Stream,{Buffer:p}=Jt,w=Hi,{addAbortSignal:x}=la,{getHighWaterMark:g,getDefaultHighWaterMark:R}=ua,{ERR_INVALID_ARG_TYPE:L,ERR_METHOD_NOT_IMPLEMENTED:$,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:I,ERR_STREAM_DESTROYED:A,ERR_STREAM_ALREADY_FINISHED:U,ERR_STREAM_NULL_VALUES:H,ERR_STREAM_WRITE_AFTER_END:W,ERR_UNKNOWN_ENCODING:ee}=Rt.codes,{errorOrDestroy:re}=w;s(F.prototype,h.prototype),s(F,h);function ne(){}const Q=l("kOnFinished");function M(k,C,V){typeof V!="boolean"&&(V=C instanceof Gn()),this.objectMode=!!(k&&k.objectMode),V&&(this.objectMode=this.objectMode||!!(k&&k.writableObjectMode)),this.highWaterMark=k?g(this,k,"writableHighWaterMark",V):R(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const y=!!(k&&k.decodeStrings===!1);this.decodeStrings=!y,this.defaultEncoding=k&&k.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=Y.bind(void 0,C),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,pe(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!k||k.emitClose!==!1,this.autoDestroy=!k||k.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Q]=[]}function pe(k){k.buffered=[],k.bufferedIndex=0,k.allBuffers=!0,k.allNoop=!0}M.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},i(M.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function F(k){const C=this instanceof Gn();if(!C&&!r(F,this))return new F(k);this._writableState=new M(k,this,C),k&&(typeof k.write=="function"&&(this._write=k.write),typeof k.writev=="function"&&(this._writev=k.writev),typeof k.destroy=="function"&&(this._destroy=k.destroy),typeof k.final=="function"&&(this._final=k.final),typeof k.construct=="function"&&(this._construct=k.construct),k.signal&&x(k.signal,this)),h.call(this,k),w.construct(this,()=>{const V=this._writableState;V.writing||se(this,V),_e(this,V)})}i(F,u,{__proto__:null,value:function(k){return r(this,k)?!0:this!==F?!1:k&&k._writableState instanceof M}}),F.prototype.pipe=function(){re(this,new I)};function G(k,C,V,y){const d=k._writableState;if(typeof V=="function")y=V,V=d.defaultEncoding;else{if(!V)V=d.defaultEncoding;else if(V!=="buffer"&&!p.isEncoding(V))throw new ee(V);typeof y!="function"&&(y=ne)}if(C===null)throw new H;if(!d.objectMode)if(typeof C=="string")d.decodeStrings!==!1&&(C=p.from(C,V),V="buffer");else if(C instanceof p)V="buffer";else if(h._isUint8Array(C))C=h._uint8ArrayToBuffer(C),V="buffer";else throw new L("chunk",["string","Buffer","Uint8Array"],C);let f;return d.ending?f=new W:d.destroyed&&(f=new A("write")),f?(n.nextTick(y,f),re(k,f,!0),f):(d.pendingcb++,ie(k,d,C,V,y))}F.prototype.write=function(k,C,V){return G(this,k,C,V)===!0},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){const k=this._writableState;k.corked&&(k.corked--,k.writing||se(this,k))},F.prototype.setDefaultEncoding=function(C){if(typeof C=="string"&&(C=a(C)),!p.isEncoding(C))throw new ee(C);return this._writableState.defaultEncoding=C,this};function ie(k,C,V,y,d){const f=C.objectMode?1:V.length;C.length+=f;const m=C.length<C.highWaterMark;return m||(C.needDrain=!0),C.writing||C.corked||C.errored||!C.constructed?(C.buffered.push({chunk:V,encoding:y,callback:d}),C.allBuffers&&y!=="buffer"&&(C.allBuffers=!1),C.allNoop&&d!==ne&&(C.allNoop=!1)):(C.writelen=f,C.writecb=d,C.writing=!0,C.sync=!0,k._write(V,y,C.onwrite),C.sync=!1),m&&!C.errored&&!C.destroyed}function q(k,C,V,y,d,f,m){C.writelen=y,C.writecb=m,C.writing=!0,C.sync=!0,C.destroyed?C.onwrite(new A("write")):V?k._writev(d,C.onwrite):k._write(d,f,C.onwrite),C.sync=!1}function K(k,C,V,y){--C.pendingcb,y(V),J(C),re(k,V)}function Y(k,C){const V=k._writableState,y=V.sync,d=V.writecb;if(typeof d!="function"){re(k,new E);return}V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0,C?(C.stack,V.errored||(V.errored=C),k._readableState&&!k._readableState.errored&&(k._readableState.errored=C),y?n.nextTick(K,k,V,C,d):K(k,V,C,d)):(V.buffered.length>V.bufferedIndex&&se(k,V),y?V.afterWriteTickInfo!==null&&V.afterWriteTickInfo.cb===d?V.afterWriteTickInfo.count++:(V.afterWriteTickInfo={count:1,cb:d,stream:k,state:V},n.nextTick(z,V.afterWriteTickInfo)):te(k,V,1,d))}function z({stream:k,state:C,count:V,cb:y}){return C.afterWriteTickInfo=null,te(k,C,V,y)}function te(k,C,V,y){for(!C.ending&&!k.destroyed&&C.length===0&&C.needDrain&&(C.needDrain=!1,k.emit("drain"));V-- >0;)C.pendingcb--,y();C.destroyed&&J(C),_e(k,C)}function J(k){if(k.writing)return;for(let d=k.bufferedIndex;d<k.buffered.length;++d){var C;const{chunk:f,callback:m}=k.buffered[d],B=k.objectMode?1:f.length;k.length-=B,m((C=k.errored)!==null&&C!==void 0?C:new A("write"))}const V=k[Q].splice(0);for(let d=0;d<V.length;d++){var y;V[d]((y=k.errored)!==null&&y!==void 0?y:new A("end"))}pe(k)}function se(k,C){if(C.corked||C.bufferProcessing||C.destroyed||!C.constructed)return;const{buffered:V,bufferedIndex:y,objectMode:d}=C,f=V.length-y;if(!f)return;let m=y;if(C.bufferProcessing=!0,f>1&&k._writev){C.pendingcb-=f-1;const B=C.allNoop?ne:D=>{for(let he=m;he<V.length;++he)V[he].callback(D)},j=C.allNoop&&m===0?V:e(V,m);j.allBuffers=C.allBuffers,q(k,C,!0,C.length,j,"",B),pe(C)}else{do{const{chunk:B,encoding:j,callback:D}=V[m];V[m++]=null;const he=d?1:B.length;q(k,C,!1,he,B,j,D)}while(m<V.length&&!C.writing);m===V.length?pe(C):m>256?(V.splice(0,m),C.bufferedIndex=0):C.bufferedIndex=m}C.bufferProcessing=!1}F.prototype._write=function(k,C,V){if(this._writev)this._writev([{chunk:k,encoding:C}],V);else throw new $("_write()")},F.prototype._writev=null,F.prototype.end=function(k,C,V){const y=this._writableState;typeof k=="function"?(V=k,k=null,C=null):typeof C=="function"&&(V=C,C=null);let d;if(k!=null){const f=G(this,k,C);f instanceof t&&(d=f)}return y.corked&&(y.corked=1,this.uncork()),d||(!y.errored&&!y.ending?(y.ending=!0,_e(this,y,!0),y.ended=!0):y.finished?d=new U("end"):y.destroyed&&(d=new A("end"))),typeof V=="function"&&(d||y.finished?n.nextTick(V,d):y[Q].push(V)),this};function me(k){return k.ending&&!k.destroyed&&k.constructed&&k.length===0&&!k.errored&&k.buffered.length===0&&!k.finished&&!k.writing&&!k.errorEmitted&&!k.closeEmitted}function ge(k,C){let V=!1;function y(d){if(V){re(k,d??E());return}if(V=!0,C.pendingcb--,d){const f=C[Q].splice(0);for(let m=0;m<f.length;m++)f[m](d);re(k,d,C.sync)}else me(C)&&(C.prefinished=!0,k.emit("prefinish"),C.pendingcb++,n.nextTick(Re,k,C))}C.sync=!0,C.pendingcb++;try{k._final(y)}catch(d){y(d)}C.sync=!1}function de(k,C){!C.prefinished&&!C.finalCalled&&(typeof k._final=="function"&&!C.destroyed?(C.finalCalled=!0,ge(k,C)):(C.prefinished=!0,k.emit("prefinish")))}function _e(k,C,V){me(C)&&(de(k,C),C.pendingcb===0&&(V?(C.pendingcb++,n.nextTick((y,d)=>{me(d)?Re(y,d):d.pendingcb--},k,C)):me(C)&&(C.pendingcb++,Re(k,C))))}function Re(k,C){C.pendingcb--,C.finished=!0;const V=C[Q].splice(0);for(let y=0;y<V.length;y++)V[y]();if(k.emit("finish"),C.autoDestroy){const y=k._readableState;(!y||y.autoDestroy&&(y.endEmitted||y.readable===!1))&&k.destroy()}}o(F.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(k){this._writableState&&(this._writableState.destroyed=k)}},writable:{__proto__:null,get(){const k=this._writableState;return!!k&&k.writable!==!1&&!k.destroyed&&!k.errored&&!k.ending&&!k.ended},set(k){this._writableState&&(this._writableState.writable=!!k)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const k=this._writableState;return k?!k.destroyed&&!k.ending&&k.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Ke=w.destroy;F.prototype.destroy=function(k,C){const V=this._writableState;return!V.destroyed&&(V.bufferedIndex<V.buffered.length||V[Q].length)&&n.nextTick(J,V),Ke.call(this,k,C),this},F.prototype._undestroy=w.undestroy,F.prototype._destroy=function(k,C){C(k)},F.prototype[c.captureRejectionSymbol]=function(k){this.destroy(k)};let Ue;function Le(){return Ue===void 0&&(Ue={}),Ue}return F.fromWeb=function(k,C){return Le().newStreamWritableFromWritableStream(k,C)},F.toWeb=function(k){return Le().newWritableStreamFromStreamWritable(k)},Wa}var qa,Mu;function Hw(){if(Mu)return qa;Mu=1;const n=ci,e=Jt,{isReadable:t,isWritable:r,isIterable:i,isNodeStream:o,isReadableNodeStream:s,isWritableNodeStream:a,isDuplexNodeStream:l,isReadableStream:u,isWritableStream:c}=Qn,h=Tr,{AbortError:p,codes:{ERR_INVALID_ARG_TYPE:w,ERR_INVALID_RETURN_VALUE:x}}=Rt,{destroyer:g}=Hi,R=Gn(),L=da(),$=wl(),{createDeferredPromise:E}=St,I=ch,A=globalThis.Blob||e.Blob,U=typeof A<"u"?function(M){return M instanceof A}:function(M){return!1},H=globalThis.AbortController||Io().AbortController,{FunctionPrototypeCall:W}=Ze;class ee extends R{constructor(M){super(M),(M==null?void 0:M.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(M==null?void 0:M.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}qa=function Q(M,pe){if(l(M))return M;if(s(M))return ne({readable:M});if(a(M))return ne({writable:M});if(o(M))return ne({writable:!1,readable:!1});if(u(M))return ne({readable:L.fromWeb(M)});if(c(M))return ne({writable:$.fromWeb(M)});if(typeof M=="function"){const{value:G,write:ie,final:q,destroy:K}=re(M);if(i(G))return I(ee,G,{objectMode:!0,write:ie,final:q,destroy:K});const Y=G==null?void 0:G.then;if(typeof Y=="function"){let z;const te=W(Y,G,J=>{if(J!=null)throw new x("nully","body",J)},J=>{g(z,J)});return z=new ee({objectMode:!0,readable:!1,write:ie,final(J){q(async()=>{try{await te,n.nextTick(J,null)}catch(se){n.nextTick(J,se)}})},destroy:K})}throw new x("Iterable, AsyncIterable or AsyncFunction",pe,G)}if(U(M))return Q(M.arrayBuffer());if(i(M))return I(ee,M,{objectMode:!0,writable:!1});if(u(M==null?void 0:M.readable)&&c(M==null?void 0:M.writable))return ee.fromWeb(M);if(typeof(M==null?void 0:M.writable)=="object"||typeof(M==null?void 0:M.readable)=="object"){const G=M!=null&&M.readable?s(M==null?void 0:M.readable)?M==null?void 0:M.readable:Q(M.readable):void 0,ie=M!=null&&M.writable?a(M==null?void 0:M.writable)?M==null?void 0:M.writable:Q(M.writable):void 0;return ne({readable:G,writable:ie})}const F=M==null?void 0:M.then;if(typeof F=="function"){let G;return W(F,M,ie=>{ie!=null&&G.push(ie),G.push(null)},ie=>{g(G,ie)}),G=new ee({objectMode:!0,writable:!1,read(){}})}throw new w(pe,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],M)};function re(Q){let{promise:M,resolve:pe}=E();const F=new H,G=F.signal;return{value:Q(async function*(){for(;;){const q=M;M=null;const{chunk:K,done:Y,cb:z}=await q;if(n.nextTick(z),Y)return;if(G.aborted)throw new p(void 0,{cause:G.reason});({promise:M,resolve:pe}=E()),yield K}}(),{signal:G}),write(q,K,Y){const z=pe;pe=null,z({chunk:q,done:!1,cb:Y})},final(q){const K=pe;pe=null,K({done:!0,cb:q})},destroy(q,K){F.abort(),K(q)}}}function ne(Q){const M=Q.readable&&typeof Q.readable.read!="function"?L.wrap(Q.readable):Q.readable,pe=Q.writable;let F=!!t(M),G=!!r(pe),ie,q,K,Y,z;function te(J){const se=Y;Y=null,se?se(J):J&&z.destroy(J)}return z=new ee({readableObjectMode:!!(M!=null&&M.readableObjectMode),writableObjectMode:!!(pe!=null&&pe.writableObjectMode),readable:F,writable:G}),G&&(h(pe,J=>{G=!1,J&&g(M,J),te(J)}),z._write=function(J,se,me){pe.write(J,se)?me():ie=me},z._final=function(J){pe.end(),q=J},pe.on("drain",function(){if(ie){const J=ie;ie=null,J()}}),pe.on("finish",function(){if(q){const J=q;q=null,J()}})),F&&(h(M,J=>{F=!1,J&&g(M,J),te(J)}),M.on("readable",function(){if(K){const J=K;K=null,J()}}),M.on("end",function(){z.push(null)}),z._read=function(){for(;;){const J=M.read();if(J===null){K=z._read;return}if(!z.push(J))return}}),z._destroy=function(J,se){!J&&Y!==null&&(J=new p),K=null,ie=null,q=null,Y===null?se(J):(Y=se,g(pe,J),g(M,J))},z}return qa}var za,Ku;function Gn(){if(Ku)return za;Ku=1;const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:t,ObjectSetPrototypeOf:r}=Ze;za=s;const i=da(),o=wl();r(s.prototype,i.prototype),r(s,i);{const c=t(o.prototype);for(let h=0;h<c.length;h++){const p=c[h];s.prototype[p]||(s.prototype[p]=o.prototype[p])}}function s(c){if(!(this instanceof s))return new s(c);i.call(this,c),o.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}n(s.prototype,{writable:{__proto__:null,...e(o.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(o.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(o.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(o.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(o.prototype,"writableLength")},writableFinished:{__proto__:null,...e(o.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(o.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(o.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(o.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let a;function l(){return a===void 0&&(a={}),a}s.fromWeb=function(c,h){return l().newStreamDuplexFromReadableWritablePair(c,h)},s.toWeb=function(c){return l().newReadableWritablePairFromDuplex(c)};let u;return s.from=function(c){return u||(u=Hw()),u(c,"body")},za}const{ObjectSetPrototypeOf:lh,Symbol:Vw}=Ze;var uh=Yn;const{ERR_METHOD_NOT_IMPLEMENTED:Ww}=Rt.codes,bl=Gn(),{getHighWaterMark:qw}=ua;lh(Yn.prototype,bl.prototype);lh(Yn,bl);const Ao=Vw("kCallback");function Yn(n){if(!(this instanceof Yn))return new Yn(n);const e=n?qw(this,n,"readableHighWaterMark",!0):null;e===0&&(n={...n,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:n.writableHighWaterMark||0}),bl.call(this,n),this._readableState.sync=!1,this[Ao]=null,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.on("prefinish",zw)}function Bc(n){typeof this._flush=="function"&&!this.destroyed?this._flush((e,t)=>{if(e){n?n(e):this.destroy(e);return}t!=null&&this.push(t),this.push(null),n&&n()}):(this.push(null),n&&n())}function zw(){this._final!==Bc&&Bc.call(this)}Yn.prototype._final=Bc;Yn.prototype._transform=function(n,e,t){throw new Ww("_transform()")};Yn.prototype._write=function(n,e,t){const r=this._readableState,i=this._writableState,o=r.length;this._transform(n,e,(s,a)=>{if(s){t(s);return}a!=null&&this.push(a),i.ended||o===r.length||r.length<r.highWaterMark?t():this[Ao]=t})};Yn.prototype._read=function(){if(this[Ao]){const n=this[Ao];this[Ao]=null,n()}};const{ObjectSetPrototypeOf:dh}=Ze;var fh=Pi;const ml=uh;dh(Pi.prototype,ml.prototype);dh(Pi,ml);function Pi(n){if(!(this instanceof Pi))return new Pi(n);ml.call(this,n)}Pi.prototype._transform=function(n,e,t){t(null,n)};const go=ci,{ArrayIsArray:Gw,Promise:Yw,SymbolAsyncIterator:Jw,SymbolDispose:Xw}=Ze,Hs=Tr,{once:Zw}=St,Qw=Hi,Fu=Gn(),{aggregateTwoErrors:eb,codes:{ERR_INVALID_ARG_TYPE:Lc,ERR_INVALID_RETURN_VALUE:Ga,ERR_MISSING_ARGS:tb,ERR_STREAM_DESTROYED:nb,ERR_STREAM_PREMATURE_CLOSE:rb},AbortError:ib}=Rt,{validateFunction:ob,validateAbortSignal:sb}=Po,{isIterable:Kr,isReadable:Ya,isReadableNodeStream:Ts,isNodeStream:ju,isTransformStream:Si,isWebStream:ab,isReadableStream:Ja,isReadableFinished:cb}=Qn,lb=globalThis.AbortController||Io().AbortController;let Xa,Za,Qa;function Hu(n,e,t){let r=!1;n.on("close",()=>{r=!0});const i=Hs(n,{readable:e,writable:t},o=>{r=!o});return{destroy:o=>{r||(r=!0,Qw.destroyer(n,o||new nb("pipe")))},cleanup:i}}function ub(n){return ob(n[n.length-1],"streams[stream.length - 1]"),n.pop()}function ec(n){if(Kr(n))return n;if(Ts(n))return db(n);throw new Lc("val",["Readable","Iterable","AsyncIterable"],n)}async function*db(n){Za||(Za=da()),yield*Za.prototype[Jw].call(n)}async function ds(n,e,t,{end:r}){let i,o=null;const s=u=>{if(u&&(i=u),o){const c=o;o=null,c()}},a=()=>new Yw((u,c)=>{i?c(i):o=()=>{i?c(i):u()}});e.on("drain",s);const l=Hs(e,{readable:!1},s);try{e.writableNeedDrain&&await a();for await(const u of n)e.write(u)||await a();r&&(e.end(),await a()),t()}catch(u){t(i!==u?eb(i,u):u)}finally{l(),e.off("drain",s)}}async function tc(n,e,t,{end:r}){Si(e)&&(e=e.writable);const i=e.getWriter();try{for await(const o of n)await i.ready,i.write(o).catch(()=>{});await i.ready,r&&await i.close(),t()}catch(o){try{await i.abort(o),t(o)}catch(s){t(s)}}}function fb(...n){return hh(n,Zw(ub(n)))}function hh(n,e,t){if(n.length===1&&Gw(n[0])&&(n=n[0]),n.length<2)throw new tb("streams");const r=new lb,i=r.signal,o=t==null?void 0:t.signal,s=[];sb(o,"options.signal");function a(){x(new ib)}Qa=Qa||St.addAbortListener;let l;o&&(l=Qa(o,a));let u,c;const h=[];let p=0;function w($){x($,--p===0)}function x($,E){var I;if($&&(!u||u.code==="ERR_STREAM_PREMATURE_CLOSE")&&(u=$),!(!u&&!E)){for(;h.length;)h.shift()(u);(I=l)===null||I===void 0||I[Xw](),r.abort(),E&&(u||s.forEach(A=>A()),go.nextTick(e,u,c))}}let g;for(let $=0;$<n.length;$++){const E=n[$],I=$<n.length-1,A=$>0,U=I||(t==null?void 0:t.end)!==!1,H=$===n.length-1;if(ju(E)){let W=function(ee){ee&&ee.name!=="AbortError"&&ee.code!=="ERR_STREAM_PREMATURE_CLOSE"&&w(ee)};if(U){const{destroy:ee,cleanup:re}=Hu(E,I,A);h.push(ee),Ya(E)&&H&&s.push(re)}E.on("error",W),Ya(E)&&H&&s.push(()=>{E.removeListener("error",W)})}if($===0)if(typeof E=="function"){if(g=E({signal:i}),!Kr(g))throw new Ga("Iterable, AsyncIterable or Stream","source",g)}else Kr(E)||Ts(E)||Si(E)?g=E:g=Fu.from(E);else if(typeof E=="function"){if(Si(g)){var R;g=ec((R=g)===null||R===void 0?void 0:R.readable)}else g=ec(g);if(g=E(g,{signal:i}),I){if(!Kr(g,!0))throw new Ga("AsyncIterable",`transform[${$-1}]`,g)}else{var L;Xa||(Xa=fh);const W=new Xa({objectMode:!0}),ee=(L=g)===null||L===void 0?void 0:L.then;if(typeof ee=="function")p++,ee.call(g,Q=>{c=Q,Q!=null&&W.write(Q),U&&W.end(),go.nextTick(w)},Q=>{W.destroy(Q),go.nextTick(w,Q)});else if(Kr(g,!0))p++,ds(g,W,w,{end:U});else if(Ja(g)||Si(g)){const Q=g.readable||g;p++,ds(Q,W,w,{end:U})}else throw new Ga("AsyncIterable or Promise","destination",g);g=W;const{destroy:re,cleanup:ne}=Hu(g,!1,!0);h.push(re),H&&s.push(ne)}}else if(ju(E)){if(Ts(g)){p+=2;const W=hb(g,E,w,{end:U});Ya(E)&&H&&s.push(W)}else if(Si(g)||Ja(g)){const W=g.readable||g;p++,ds(W,E,w,{end:U})}else if(Kr(g))p++,ds(g,E,w,{end:U});else throw new Lc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=E}else if(ab(E)){if(Ts(g))p++,tc(ec(g),E,w,{end:U});else if(Ja(g)||Kr(g))p++,tc(g,E,w,{end:U});else if(Si(g))p++,tc(g.readable,E,w,{end:U});else throw new Lc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=E}else g=Fu.from(E)}return(i!=null&&i.aborted||o!=null&&o.aborted)&&go.nextTick(a),g}function hb(n,e,t,{end:r}){let i=!1;if(e.on("close",()=>{i||t(new rb)}),n.pipe(e,{end:!1}),r){let o=function(){i=!0,e.end()};cb(n)?go.nextTick(o):n.once("end",o)}else t();return Hs(n,{readable:!0,writable:!1},o=>{const s=n._readableState;o&&o.code==="ERR_STREAM_PREMATURE_CLOSE"&&s&&s.ended&&!s.errored&&!s.errorEmitted?n.once("end",t).once("error",t):t(o)}),Hs(e,{readable:!1,writable:!0},t)}var vl={pipelineImpl:hh,pipeline:fb};const{pipeline:yb}=vl,fs=Gn(),{destroyer:pb}=Hi,{isNodeStream:hs,isReadable:Vu,isWritable:Wu,isWebStream:nc,isTransformStream:Mr,isWritableStream:qu,isReadableStream:zu}=Qn,{AbortError:gb,codes:{ERR_INVALID_ARG_VALUE:Gu,ERR_MISSING_ARGS:wb}}=Rt,bb=Tr;var yh=function(...e){if(e.length===0)throw new wb("streams");if(e.length===1)return fs.from(e[0]);const t=[...e];if(typeof e[0]=="function"&&(e[0]=fs.from(e[0])),typeof e[e.length-1]=="function"){const w=e.length-1;e[w]=fs.from(e[w])}for(let w=0;w<e.length;++w)if(!(!hs(e[w])&&!nc(e[w]))){if(w<e.length-1&&!(Vu(e[w])||zu(e[w])||Mr(e[w])))throw new Gu(`streams[${w}]`,t[w],"must be readable");if(w>0&&!(Wu(e[w])||qu(e[w])||Mr(e[w])))throw new Gu(`streams[${w}]`,t[w],"must be writable")}let r,i,o,s,a;function l(w){const x=s;s=null,x?x(w):w?a.destroy(w):!p&&!h&&a.destroy()}const u=e[0],c=yb(e,l),h=!!(Wu(u)||qu(u)||Mr(u)),p=!!(Vu(c)||zu(c)||Mr(c));if(a=new fs({writableObjectMode:!!(u!=null&&u.writableObjectMode),readableObjectMode:!!(c!=null&&c.readableObjectMode),writable:h,readable:p}),h){if(hs(u))a._write=function(x,g,R){u.write(x,g)?R():r=R},a._final=function(x){u.end(),i=x},u.on("drain",function(){if(r){const x=r;r=null,x()}});else if(nc(u)){const g=(Mr(u)?u.writable:u).getWriter();a._write=async function(R,L,$){try{await g.ready,g.write(R).catch(()=>{}),$()}catch(E){$(E)}},a._final=async function(R){try{await g.ready,g.close().catch(()=>{}),i=R}catch(L){R(L)}}}const w=Mr(c)?c.readable:c;bb(w,()=>{if(i){const x=i;i=null,x()}})}if(p){if(hs(c))c.on("readable",function(){if(o){const w=o;o=null,w()}}),c.on("end",function(){a.push(null)}),a._read=function(){for(;;){const w=c.read();if(w===null){o=a._read;return}if(!a.push(w))return}};else if(nc(c)){const x=(Mr(c)?c.readable:c).getReader();a._read=async function(){for(;;)try{const{value:g,done:R}=await x.read();if(!a.push(g))return;if(R){a.push(null);return}}catch{return}}}}return a._destroy=function(w,x){!w&&s!==null&&(w=new gb),o=null,r=null,i=null,s===null?x(w):(s=x,hs(c)&&pb(c,w))},a};const mb=globalThis.AbortController||Io().AbortController,{codes:{ERR_INVALID_ARG_VALUE:vb,ERR_INVALID_ARG_TYPE:Ko,ERR_MISSING_ARGS:Eb,ERR_OUT_OF_RANGE:_b},AbortError:_n}=Rt,{validateAbortSignal:ui,validateInteger:Yu,validateObject:di}=Po,xb=Ze.Symbol("kWeak"),Sb=Ze.Symbol("kResistStopPropagation"),{finished:Ab}=Tr,Tb=yh,{addAbortSignalNoValidate:Ib}=la,{isWritable:Rb,isNodeStream:Ob}=Qn,{deprecate:kb}=St,{ArrayPrototypePush:Bb,Boolean:Lb,MathFloor:Ju,Number:Cb,NumberIsNaN:$b,Promise:Xu,PromiseReject:Zu,PromiseResolve:Ub,PromisePrototypeThen:Qu,Symbol:ph}=Ze,Vs=ph("kEmpty"),ed=ph("kEof");function Nb(n,e){if(e!=null&&di(e,"options"),(e==null?void 0:e.signal)!=null&&ui(e.signal,"options.signal"),Ob(n)&&!Rb(n))throw new vb("stream",n,"must be writable");const t=Tb(this,n);return e!=null&&e.signal&&Ib(e.signal,t),t}function fa(n,e){if(typeof n!="function")throw new Ko("fn",["Function","AsyncFunction"],n);e!=null&&di(e,"options"),(e==null?void 0:e.signal)!=null&&ui(e.signal,"options.signal");let t=1;(e==null?void 0:e.concurrency)!=null&&(t=Ju(e.concurrency));let r=t-1;return(e==null?void 0:e.highWaterMark)!=null&&(r=Ju(e.highWaterMark)),Yu(t,"options.concurrency",1),Yu(r,"options.highWaterMark",0),r+=t,(async function*(){const o=St.AbortSignalAny([e==null?void 0:e.signal].filter(Lb)),s=this,a=[],l={signal:o};let u,c,h=!1,p=0;function w(){h=!0,x()}function x(){p-=1,g()}function g(){c&&!h&&p<t&&a.length<r&&(c(),c=null)}async function R(){try{for await(let L of s){if(h)return;if(o.aborted)throw new _n;try{if(L=n(L,l),L===Vs)continue;L=Ub(L)}catch($){L=Zu($)}p+=1,Qu(L,x,w),a.push(L),u&&(u(),u=null),!h&&(a.length>=r||p>=t)&&await new Xu($=>{c=$})}a.push(ed)}catch(L){const $=Zu(L);Qu($,x,w),a.push($)}finally{h=!0,u&&(u(),u=null)}}R();try{for(;;){for(;a.length>0;){const L=await a[0];if(L===ed)return;if(o.aborted)throw new _n;L!==Vs&&(yield L),a.shift(),g()}await new Xu(L=>{u=L})}}finally{h=!0,c&&(c(),c=null)}}).call(this)}function Db(n=void 0){return n!=null&&di(n,"options"),(n==null?void 0:n.signal)!=null&&ui(n.signal,"options.signal"),(async function*(){let t=0;for await(const i of this){var r;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted)throw new _n({cause:n.signal.reason});yield[t++,i]}}).call(this)}async function gh(n,e=void 0){for await(const t of El.call(this,n,e))return!0;return!1}async function Pb(n,e=void 0){if(typeof n!="function")throw new Ko("fn",["Function","AsyncFunction"],n);return!await gh.call(this,async(...t)=>!await n(...t),e)}async function Mb(n,e){for await(const t of El.call(this,n,e))return t}async function Kb(n,e){if(typeof n!="function")throw new Ko("fn",["Function","AsyncFunction"],n);async function t(r,i){return await n(r,i),Vs}for await(const r of fa.call(this,t,e));}function El(n,e){if(typeof n!="function")throw new Ko("fn",["Function","AsyncFunction"],n);async function t(r,i){return await n(r,i)?r:Vs}return fa.call(this,t,e)}class Fb extends Eb{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function jb(n,e,t){var r;if(typeof n!="function")throw new Ko("reducer",["Function","AsyncFunction"],n);t!=null&&di(t,"options"),(t==null?void 0:t.signal)!=null&&ui(t.signal,"options.signal");let i=arguments.length>1;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted){const u=new _n(void 0,{cause:t.signal.reason});throw this.once("error",()=>{}),await Ab(this.destroy(u)),u}const o=new mb,s=o.signal;if(t!=null&&t.signal){const u={once:!0,[xb]:this,[Sb]:!0};t.signal.addEventListener("abort",()=>o.abort(),u)}let a=!1;try{for await(const u of this){var l;if(a=!0,t!=null&&(l=t.signal)!==null&&l!==void 0&&l.aborted)throw new _n;i?e=await n(e,u,{signal:s}):(e=u,i=!0)}if(!a&&!i)throw new Fb}finally{o.abort()}return e}async function Hb(n){n!=null&&di(n,"options"),(n==null?void 0:n.signal)!=null&&ui(n.signal,"options.signal");const e=[];for await(const r of this){var t;if(n!=null&&(t=n.signal)!==null&&t!==void 0&&t.aborted)throw new _n(void 0,{cause:n.signal.reason});Bb(e,r)}return e}function Vb(n,e){const t=fa.call(this,n,e);return(async function*(){for await(const i of t)yield*i}).call(this)}function wh(n){if(n=Cb(n),$b(n))return 0;if(n<0)throw new _b("number",">= 0",n);return n}function Wb(n,e=void 0){return e!=null&&di(e,"options"),(e==null?void 0:e.signal)!=null&&ui(e.signal,"options.signal"),n=wh(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new _n;for await(const o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new _n;n--<=0&&(yield o)}}).call(this)}function qb(n,e=void 0){return e!=null&&di(e,"options"),(e==null?void 0:e.signal)!=null&&ui(e.signal,"options.signal"),n=wh(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new _n;for await(const o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new _n;if(n-- >0&&(yield o),n<=0)return}}).call(this)}ul.streamReturningOperators={asIndexedPairs:kb(Db,"readable.asIndexedPairs will be removed in a future version."),drop:Wb,filter:El,flatMap:Vb,map:fa,take:qb,compose:Nb};ul.promiseReturningOperators={every:Pb,forEach:Kb,reduce:jb,toArray:Hb,some:gh,find:Mb};var rc,td;function bh(){if(td)return rc;td=1;const{ArrayPrototypePop:n,Promise:e}=Ze,{isIterable:t,isNodeStream:r,isWebStream:i}=Qn,{pipelineImpl:o}=vl,{finished:s}=Tr;mh();function a(...l){return new e((u,c)=>{let h,p;const w=l[l.length-1];if(w&&typeof w=="object"&&!r(w)&&!t(w)&&!i(w)){const x=n(l);h=x.signal,p=x.end}o(l,(x,g)=>{x?c(x):u(g)},{signal:h,end:p})})}return rc={finished:s,pipeline:a},rc}var nd;function mh(){if(nd)return Ma.exports;nd=1;const{Buffer:n}=Jt,{ObjectDefineProperty:e,ObjectKeys:t,ReflectApply:r}=Ze,{promisify:{custom:i}}=St,{streamReturningOperators:o,promiseReturningOperators:s}=ul,{codes:{ERR_ILLEGAL_CONSTRUCTOR:a}}=Rt,l=yh,{setDefaultHighWaterMark:u,getDefaultHighWaterMark:c}=ua,{pipeline:h}=vl,{destroyer:p}=Hi,w=Tr,x=bh(),g=Qn,R=Ma.exports=pl.Stream;R.isDestroyed=g.isDestroyed,R.isDisturbed=g.isDisturbed,R.isErrored=g.isErrored,R.isReadable=g.isReadable,R.isWritable=g.isWritable,R.Readable=da();for(const $ of t(o)){let I=function(...A){if(new.target)throw a();return R.Readable.from(r(E,this,A))};const E=o[$];e(I,"name",{__proto__:null,value:E.name}),e(I,"length",{__proto__:null,value:E.length}),e(R.Readable.prototype,$,{__proto__:null,value:I,enumerable:!1,configurable:!0,writable:!0})}for(const $ of t(s)){let I=function(...A){if(new.target)throw a();return r(E,this,A)};const E=s[$];e(I,"name",{__proto__:null,value:E.name}),e(I,"length",{__proto__:null,value:E.length}),e(R.Readable.prototype,$,{__proto__:null,value:I,enumerable:!1,configurable:!0,writable:!0})}R.Writable=wl(),R.Duplex=Gn(),R.Transform=uh,R.PassThrough=fh,R.pipeline=h;const{addAbortSignal:L}=la;return R.addAbortSignal=L,R.finished=w,R.destroy=p,R.compose=l,R.setDefaultHighWaterMark=u,R.getDefaultHighWaterMark=c,e(R,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return x}}),e(h,i,{__proto__:null,enumerable:!0,get(){return x.pipeline}}),e(w,i,{__proto__:null,enumerable:!0,get(){return x.finished}}),R.Stream=R,R._isUint8Array=function(E){return E instanceof Uint8Array},R._uint8ArrayToBuffer=function(E){return n.from(E.buffer,E.byteOffset,E.byteLength)},Ma.exports}(function(n){const e=mh(),t=bh(),r=e.Readable.destroy;n.exports=e.Readable,n.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,n.exports._isUint8Array=e._isUint8Array,n.exports.isDisturbed=e.isDisturbed,n.exports.isErrored=e.isErrored,n.exports.isReadable=e.isReadable,n.exports.Readable=e.Readable,n.exports.Writable=e.Writable,n.exports.Duplex=e.Duplex,n.exports.Transform=e.Transform,n.exports.PassThrough=e.PassThrough,n.exports.addAbortSignal=e.addAbortSignal,n.exports.finished=e.finished,n.exports.destroy=e.destroy,n.exports.destroy=r,n.exports.pipeline=e.pipeline,n.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return t}}),n.exports.Stream=e.Stream,n.exports.default=n.exports})(x0);function zb(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function vh(n,...e){if(!zb(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function rd(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Gb(n,e){vh(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Is=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ic=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ln=(n,e)=>n<<32-e|n>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Yb(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Eh(n){return typeof n=="string"&&(n=Yb(n)),vh(n),n}let Jb=class{clone(){return this._cloneInto()}};function Xb(n){const e=r=>n().update(Eh(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Zb(n=32){if(Is&&typeof Is.getRandomValues=="function")return Is.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}function Qb(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),l=r?4:0,u=r?0:4;n.setUint32(e+l,s,r),n.setUint32(e+u,a,r)}const em=(n,e,t)=>n&e^~n&t,tm=(n,e,t)=>n&e^n&t^e&t;class nm extends Jb{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ic(this.buffer)}update(e){rd(this);const{view:t,buffer:r,blockLen:i}=this;e=Eh(e);const o=e.length;for(let s=0;s<o;){const a=Math.min(i-this.pos,o-s);if(a===i){const l=ic(e);for(;i<=o-s;s+=i)this.process(l,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){rd(this),Gb(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:o}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let h=s;h<i;h++)t[h]=0;Qb(r,i-8,BigInt(this.length*8),o),this.process(r,0);const a=ic(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,c[h],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%t&&e.buffer.set(r),e}}const rm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),sr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ar=new Uint32Array(64);let im=class extends nm{constructor(){super(64,32,8,!1),this.A=sr[0]|0,this.B=sr[1]|0,this.C=sr[2]|0,this.D=sr[3]|0,this.E=sr[4]|0,this.F=sr[5]|0,this.G=sr[6]|0,this.H=sr[7]|0}get(){const{A:e,B:t,C:r,D:i,E:o,F:s,G:a,H:l}=this;return[e,t,r,i,o,s,a,l]}set(e,t,r,i,o,s,a,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=l|0}process(e,t){for(let h=0;h<16;h++,t+=4)ar[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const p=ar[h-15],w=ar[h-2],x=ln(p,7)^ln(p,18)^p>>>3,g=ln(w,17)^ln(w,19)^w>>>10;ar[h]=g+ar[h-7]+x+ar[h-16]|0}let{A:r,B:i,C:o,D:s,E:a,F:l,G:u,H:c}=this;for(let h=0;h<64;h++){const p=ln(a,6)^ln(a,11)^ln(a,25),w=c+p+em(a,l,u)+rm[h]+ar[h]|0,g=(ln(r,2)^ln(r,13)^ln(r,22))+tm(r,i,o)|0;c=u,u=l,l=a,a=s+w|0,s=o,o=i,i=r,r=w+g|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(r,i,o,s,a,l,u,c)}roundClean(){ar.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ro=Xb(()=>new im);var om=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class _h{static digest(e){return om(this,arguments,void 0,function*({data:t}){return Ro(t)})}}class _l{}var sm=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class am extends _l{digest(e){return sm(this,arguments,void 0,function*({algorithm:t,data:r}){switch(t){case"SHA-256":return yield _h.digest({data:r})}})}}function id(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function cm(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function xh(n,...e){if(!cm(n))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function lm(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");id(n.outputLen),id(n.blockLen)}function Ws(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function um(n,e){xh(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const oc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Sh(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const sc=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),un=(n,e)=>n<<32-e|n>>>e,dm=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!dm)throw new Error("Non little-endian hardware is not supported");function Ah(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function xl(n){if(typeof n=="string"&&(n=Ah(n)),!Sh(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function Th(...n){let e=0;for(let r=0;r<n.length;r++){const i=n[r];if(!Sh(i))throw new Error("Uint8Array expected");e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<n.length;r++){const o=n[r];t.set(o,i),i+=o.length}return t}class Ih{clone(){return this._cloneInto()}}function Rh(n){const e=r=>n().update(xl(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Sl(n=32){if(oc&&typeof oc.getRandomValues=="function")return oc.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}function fm(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),l=r?4:0,u=r?0:4;n.setUint32(e+l,s,r),n.setUint32(e+u,a,r)}class Oh extends Ih{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=sc(this.buffer)}update(e){Ws(this);const{view:t,buffer:r,blockLen:i}=this;e=xl(e);const o=e.length;for(let s=0;s<o;){const a=Math.min(i-this.pos,o-s);if(a===i){const l=sc(e);for(;i<=o-s;s+=i)this.process(l,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ws(this),um(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:o}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let h=s;h<i;h++)t[h]=0;fm(r,i-8,BigInt(this.length*8),o),this.process(r,0);const a=sc(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,c[h],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%t&&e.buffer.set(r),e}}const hm=(n,e,t)=>n&e^~n&t,ym=(n,e,t)=>n&e^n&t^e&t,pm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),lr=new Uint32Array(64);class gm extends Oh{constructor(){super(64,32,8,!1),this.A=cr[0]|0,this.B=cr[1]|0,this.C=cr[2]|0,this.D=cr[3]|0,this.E=cr[4]|0,this.F=cr[5]|0,this.G=cr[6]|0,this.H=cr[7]|0}get(){const{A:e,B:t,C:r,D:i,E:o,F:s,G:a,H:l}=this;return[e,t,r,i,o,s,a,l]}set(e,t,r,i,o,s,a,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=l|0}process(e,t){for(let h=0;h<16;h++,t+=4)lr[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const p=lr[h-15],w=lr[h-2],x=un(p,7)^un(p,18)^p>>>3,g=un(w,17)^un(w,19)^w>>>10;lr[h]=g+lr[h-7]+x+lr[h-16]|0}let{A:r,B:i,C:o,D:s,E:a,F:l,G:u,H:c}=this;for(let h=0;h<64;h++){const p=un(a,6)^un(a,11)^un(a,25),w=c+p+hm(a,l,u)+pm[h]+lr[h]|0,g=(un(r,2)^un(r,13)^un(r,22))+ym(r,i,o)|0;c=u,u=l,l=a,a=s+w|0,s=o,o=i,i=r,r=w+g|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(r,i,o,s,a,l,u,c)}roundClean(){lr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const kh=Rh(()=>new gm);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bh=BigInt(0),ha=BigInt(1),wm=BigInt(2);function xn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const bm=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function ni(n){if(!xn(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=bm[n[t]];return e}function Lh(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function Al(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}const Dn={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function od(n){if(n>=Dn._0&&n<=Dn._9)return n-Dn._0;if(n>=Dn._A&&n<=Dn._F)return n-(Dn._A-10);if(n>=Dn._a&&n<=Dn._f)return n-(Dn._a-10)}function Mi(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length,t=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){const s=od(n.charCodeAt(o)),a=od(n.charCodeAt(o+1));if(s===void 0||a===void 0){const l=n[o]+n[o+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+o)}r[i]=s*16+a}return r}function Xr(n){return Al(ni(n))}function vr(n){if(!xn(n))throw new Error("Uint8Array expected");return Al(ni(Uint8Array.from(n).reverse()))}function Sn(n,e){return Mi(n.toString(16).padStart(e*2,"0"))}function Ki(n,e){return Sn(n,e).reverse()}function mm(n){return Mi(Lh(n))}function nt(n,e,t){let r;if(typeof e=="string")try{r=Mi(e)}catch(o){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${o}`)}else if(xn(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function ri(...n){let e=0;for(let i=0;i<n.length;i++){const o=n[i];if(!xn(o))throw new Error("Uint8Array expected");e+=o.length}let t=new Uint8Array(e),r=0;for(let i=0;i<n.length;i++){const o=n[i];t.set(o,r),r+=o.length}return t}function vm(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0}function Em(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function _m(n){let e;for(e=0;n>Bh;n>>=ha,e+=1);return e}function xm(n,e){return n>>BigInt(e)&ha}const Sm=(n,e,t)=>n|(t?ha:Bh)<<BigInt(e),Tl=n=>(wm<<BigInt(n-1))-ha,ac=n=>new Uint8Array(n),sd=n=>Uint8Array.from(n);function Ch(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=ac(n),i=ac(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=(...h)=>t(i,r,...h),l=(h=ac())=>{i=a(sd([0]),h),r=a(),h.length!==0&&(i=a(sd([1]),h),r=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){r=a();const w=r.slice();p.push(w),h+=r.length}return ri(...p)};return(h,p)=>{s(),l(h);let w;for(;!(w=p(u()));)l();return s(),w}}const Am={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||xn(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function fi(n,e,t={}){const r=(i,o,s)=>{const a=Am[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);const l=n[i];if(!(s&&l===void 0)&&!a(l,n))throw new Error(`Invalid param ${String(i)}=${l} (${typeof l}), expected ${o}`)};for(const[i,o]of Object.entries(e))r(i,o,!1);for(const[i,o]of Object.entries(t))r(i,o,!0);return n}const Tm=Object.freeze(Object.defineProperty({__proto__:null,bitGet:xm,bitLen:_m,bitMask:Tl,bitSet:Sm,bytesToHex:ni,bytesToNumberBE:Xr,bytesToNumberLE:vr,concatBytes:ri,createHmacDrbg:Ch,ensureBytes:nt,equalBytes:vm,hexToBytes:Mi,hexToNumber:Al,isBytes:xn,numberToBytesBE:Sn,numberToBytesLE:Ki,numberToHexUnpadded:Lh,numberToVarBytesBE:mm,utf8ToBytes:Em,validateObject:fi},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ht=BigInt(0),Ye=BigInt(1),Hr=BigInt(2),Im=BigInt(3),Cc=BigInt(4),ad=BigInt(5),cd=BigInt(8);BigInt(9);BigInt(16);function He(n,e){const t=n%e;return t>=ht?t:e+t}function $h(n,e,t){if(t<=ht||e<ht)throw new Error("Expected power/modulo > 0");if(t===Ye)return ht;let r=Ye;for(;e>ht;)e&Ye&&(r=r*n%t),n=n*n%t,e>>=Ye;return r}function ze(n,e,t){let r=n;for(;e-- >ht;)r*=r,r%=t;return r}function $c(n,e){if(n===ht||e<=ht)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=He(n,e),r=e,i=ht,o=Ye;for(;t!==ht;){const a=r/t,l=r%t,u=i-o*a;r=t,t=l,i=o,o=u}if(r!==Ye)throw new Error("invert: does not exist");return He(i,e)}function Rm(n){const e=(n-Ye)/Hr;let t,r,i;for(t=n-Ye,r=0;t%Hr===ht;t/=Hr,r++);for(i=Hr;i<n&&$h(i,e,n)!==n-Ye;i++);if(r===1){const s=(n+Ye)/Cc;return function(l,u){const c=l.pow(u,s);if(!l.eql(l.sqr(c),u))throw new Error("Cannot find square root");return c}}const o=(t+Ye)/Hr;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,c=a.pow(a.mul(a.ONE,i),t),h=a.pow(l,o),p=a.pow(l,t);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let w=1;for(let g=a.sqr(p);w<u&&!a.eql(g,a.ONE);w++)g=a.sqr(g);const x=a.pow(c,Ye<<BigInt(u-w-1));c=a.sqr(x),h=a.mul(h,x),p=a.mul(p,c),u=w}return h}}function Om(n){if(n%Cc===Im){const e=(n+Ye)/Cc;return function(r,i){const o=r.pow(i,e);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(n%cd===ad){const e=(n-ad)/cd;return function(r,i){const o=r.mul(i,Hr),s=r.pow(o,e),a=r.mul(i,s),l=r.mul(r.mul(a,Hr),s),u=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(u),i))throw new Error("Cannot find square root");return u}}return Rm(n)}const km=(n,e)=>(He(n,e)&Ye)===Ye,Bm=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Lm(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Bm.reduce((r,i)=>(r[i]="function",r),e);return fi(n,t)}function Cm(n,e,t){if(t<ht)throw new Error("Expected power > 0");if(t===ht)return n.ONE;if(t===Ye)return e;let r=n.ONE,i=e;for(;t>ht;)t&Ye&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Ye;return r}function $m(n,e){const t=new Array(e.length),r=e.reduce((o,s,a)=>n.is0(s)?o:(t[a]=o,n.mul(o,s)),n.ONE),i=n.inv(r);return e.reduceRight((o,s,a)=>n.is0(s)?o:(t[a]=n.mul(o,t[a]),n.mul(o,s)),i),t}function Uh(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Il(n,e,t=!1,r={}){if(n<=ht)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=Uh(n,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Om(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:Tl(i),ZERO:ht,ONE:Ye,create:l=>He(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return ht<=l&&l<n},is0:l=>l===ht,isOdd:l=>(l&Ye)===Ye,neg:l=>He(-l,n),eql:(l,u)=>l===u,sqr:l=>He(l*l,n),add:(l,u)=>He(l+u,n),sub:(l,u)=>He(l-u,n),mul:(l,u)=>He(l*u,n),pow:(l,u)=>Cm(a,l,u),div:(l,u)=>He(l*$c(u,n),n),sqrN:l=>l*l,addN:(l,u)=>l+u,subN:(l,u)=>l-u,mulN:(l,u)=>l*u,inv:l=>$c(l,n),sqrt:r.sqrt||(l=>s(a,l)),invertBatch:l=>$m(a,l),cmov:(l,u,c)=>c?u:l,toBytes:l=>t?Ki(l,o):Sn(l,o),fromBytes:l=>{if(l.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${l.length}`);return t?vr(l):Xr(l)}});return Object.freeze(a)}function Um(n,e){if(!n.isOdd)throw new Error("Field doesn't have isOdd");const t=n.sqrt(e);return n.isOdd(t)?n.neg(t):t}function Nh(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function Dh(n){const e=Nh(n);return e+Math.ceil(e/2)}function Nm(n,e,t=!1){const r=n.length,i=Nh(e),o=Dh(e);if(r<16||r<o||r>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${r}`);const s=t?Xr(n):vr(n),a=He(s,e-Ye)+Ye;return t?Ki(a,i):Sn(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dm=BigInt(0),cc=BigInt(1);function Ph(n,e){const t=(i,o)=>{const s=o.negate();return i?s:o},r=i=>{const o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:t,unsafeLadder(i,o){let s=n.ZERO,a=i;for(;o>Dm;)o&cc&&(s=s.add(a)),a=a.double(),o>>=cc;return s},precomputeWindow(i,o){const{windows:s,windowSize:a}=r(o),l=[];let u=i,c=u;for(let h=0;h<s;h++){c=u,l.push(c);for(let p=1;p<a;p++)c=c.add(u),l.push(c);u=c.double()}return l},wNAF(i,o,s){const{windows:a,windowSize:l}=r(i);let u=n.ZERO,c=n.BASE;const h=BigInt(2**i-1),p=2**i,w=BigInt(i);for(let x=0;x<a;x++){const g=x*l;let R=Number(s&h);s>>=w,R>l&&(R-=p,s+=cc);const L=g,$=g+Math.abs(R)-1,E=x%2!==0,I=R<0;R===0?c=c.add(t(E,o[L])):u=u.add(t(I,o[$]))}return{p:u,f:c}},wNAFCached(i,o,s,a){const l=i._WINDOW_SIZE||1;let u=o.get(i);return u||(u=this.precomputeWindow(i,l),l!==1&&o.set(i,a(u))),this.wNAF(l,u,s)}}}function Rl(n){return Lm(n.Fp),fi(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Uh(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Pm(n){const e=Rl(n);fi(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Mm,hexToBytes:Km}=Tm,zr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=zr;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Mm(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=zr,t=typeof n=="string"?Km(n):n;if(!xn(t))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=zr._parseInt(t.subarray(2)),{d:s,l:a}=zr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(n){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,t=u=>{const c=u.toString(16);return c.length&1?`0${c}`:c},r=e(t(n.s)),i=e(t(n.r)),o=r.length/2,s=i.length/2,a=t(o),l=t(s);return`30${t(s+o+4)}02${l}${i}02${a}${r}`}},Vn=BigInt(0),Wt=BigInt(1);BigInt(2);const ld=BigInt(3);BigInt(4);function Fm(n){const e=Pm(n),{Fp:t}=e,r=e.toBytes||((x,g,R)=>{const L=g.toAffine();return ri(Uint8Array.from([4]),t.toBytes(L.x),t.toBytes(L.y))}),i=e.fromBytes||(x=>{const g=x.subarray(1),R=t.fromBytes(g.subarray(0,t.BYTES)),L=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:R,y:L}});function o(x){const{a:g,b:R}=e,L=t.sqr(x),$=t.mul(L,x);return t.add(t.add($,t.mul(x,g)),R)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(x){return typeof x=="bigint"&&Vn<x&&x<e.n}function a(x){if(!s(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(x){const{allowedPrivateKeyLengths:g,nByteLength:R,wrapPrivateKey:L,n:$}=e;if(g&&typeof x!="bigint"){if(xn(x)&&(x=ni(x)),typeof x!="string"||!g.includes(x.length))throw new Error("Invalid key");x=x.padStart(R*2,"0")}let E;try{E=typeof x=="bigint"?x:Xr(nt("private key",x,R))}catch{throw new Error(`private key must be ${R} bytes, hex or bigint, not ${typeof x}`)}return L&&(E=He(E,$)),a(E),E}const u=new Map;function c(x){if(!(x instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,R,L){if(this.px=g,this.py=R,this.pz=L,g==null||!t.isValid(g))throw new Error("x required");if(R==null||!t.isValid(R))throw new Error("y required");if(L==null||!t.isValid(L))throw new Error("z required")}static fromAffine(g){const{x:R,y:L}=g||{};if(!g||!t.isValid(R)||!t.isValid(L))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const $=E=>t.eql(E,t.ZERO);return $(R)&&$(L)?h.ZERO:new h(R,L,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const R=t.invertBatch(g.map(L=>L.pz));return g.map((L,$)=>L.toAffine(R[$])).map(h.fromAffine)}static fromHex(g){const R=h.fromAffine(i(nt("pointHex",g)));return R.assertValidity(),R}static fromPrivateKey(g){return h.BASE.multiply(l(g))}_setWindowSize(g){this._WINDOW_SIZE=g,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:R}=this.toAffine();if(!t.isValid(g)||!t.isValid(R))throw new Error("bad point: x or y not FE");const L=t.sqr(R),$=o(g);if(!t.eql(L,$))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){c(g);const{px:R,py:L,pz:$}=this,{px:E,py:I,pz:A}=g,U=t.eql(t.mul(R,A),t.mul(E,$)),H=t.eql(t.mul(L,A),t.mul(I,$));return U&&H}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:g,b:R}=e,L=t.mul(R,ld),{px:$,py:E,pz:I}=this;let A=t.ZERO,U=t.ZERO,H=t.ZERO,W=t.mul($,$),ee=t.mul(E,E),re=t.mul(I,I),ne=t.mul($,E);return ne=t.add(ne,ne),H=t.mul($,I),H=t.add(H,H),A=t.mul(g,H),U=t.mul(L,re),U=t.add(A,U),A=t.sub(ee,U),U=t.add(ee,U),U=t.mul(A,U),A=t.mul(ne,A),H=t.mul(L,H),re=t.mul(g,re),ne=t.sub(W,re),ne=t.mul(g,ne),ne=t.add(ne,H),H=t.add(W,W),W=t.add(H,W),W=t.add(W,re),W=t.mul(W,ne),U=t.add(U,W),re=t.mul(E,I),re=t.add(re,re),W=t.mul(re,ne),A=t.sub(A,W),H=t.mul(re,ee),H=t.add(H,H),H=t.add(H,H),new h(A,U,H)}add(g){c(g);const{px:R,py:L,pz:$}=this,{px:E,py:I,pz:A}=g;let U=t.ZERO,H=t.ZERO,W=t.ZERO;const ee=e.a,re=t.mul(e.b,ld);let ne=t.mul(R,E),Q=t.mul(L,I),M=t.mul($,A),pe=t.add(R,L),F=t.add(E,I);pe=t.mul(pe,F),F=t.add(ne,Q),pe=t.sub(pe,F),F=t.add(R,$);let G=t.add(E,A);return F=t.mul(F,G),G=t.add(ne,M),F=t.sub(F,G),G=t.add(L,$),U=t.add(I,A),G=t.mul(G,U),U=t.add(Q,M),G=t.sub(G,U),W=t.mul(ee,F),U=t.mul(re,M),W=t.add(U,W),U=t.sub(Q,W),W=t.add(Q,W),H=t.mul(U,W),Q=t.add(ne,ne),Q=t.add(Q,ne),M=t.mul(ee,M),F=t.mul(re,F),Q=t.add(Q,M),M=t.sub(ne,M),M=t.mul(ee,M),F=t.add(F,M),ne=t.mul(Q,F),H=t.add(H,ne),ne=t.mul(G,F),U=t.mul(pe,U),U=t.sub(U,ne),ne=t.mul(pe,Q),W=t.mul(G,W),W=t.add(W,ne),new h(U,H,W)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return w.wNAFCached(this,u,g,R=>{const L=t.invertBatch(R.map($=>$.pz));return R.map(($,E)=>$.toAffine(L[E])).map(h.fromAffine)})}multiplyUnsafe(g){const R=h.ZERO;if(g===Vn)return R;if(a(g),g===Wt)return this;const{endo:L}=e;if(!L)return w.unsafeLadder(this,g);let{k1neg:$,k1:E,k2neg:I,k2:A}=L.splitScalar(g),U=R,H=R,W=this;for(;E>Vn||A>Vn;)E&Wt&&(U=U.add(W)),A&Wt&&(H=H.add(W)),W=W.double(),E>>=Wt,A>>=Wt;return $&&(U=U.negate()),I&&(H=H.negate()),H=new h(t.mul(H.px,L.beta),H.py,H.pz),U.add(H)}multiply(g){a(g);let R=g,L,$;const{endo:E}=e;if(E){const{k1neg:I,k1:A,k2neg:U,k2:H}=E.splitScalar(R);let{p:W,f:ee}=this.wNAF(A),{p:re,f:ne}=this.wNAF(H);W=w.constTimeNegate(I,W),re=w.constTimeNegate(U,re),re=new h(t.mul(re.px,E.beta),re.py,re.pz),L=W.add(re),$=ee.add(ne)}else{const{p:I,f:A}=this.wNAF(R);L=I,$=A}return h.normalizeZ([L,$])[0]}multiplyAndAddUnsafe(g,R,L){const $=h.BASE,E=(A,U)=>U===Vn||U===Wt||!A.equals($)?A.multiplyUnsafe(U):A.multiply(U),I=E(this,R).add(E(g,L));return I.is0()?void 0:I}toAffine(g){const{px:R,py:L,pz:$}=this,E=this.is0();g==null&&(g=E?t.ONE:t.inv($));const I=t.mul(R,g),A=t.mul(L,g),U=t.mul($,g);if(E)return{x:t.ZERO,y:t.ZERO};if(!t.eql(U,t.ONE))throw new Error("invZ was invalid");return{x:I,y:A}}isTorsionFree(){const{h:g,isTorsionFree:R}=e;if(g===Wt)return!0;if(R)return R(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:R}=e;return g===Wt?this:R?R(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(h,this,g)}toHex(g=!0){return ni(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const p=e.nBitLength,w=Ph(h,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:o,isWithinCurveOrder:s}}function jm(n){const e=Rl(n);return fi(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Hm(n){const e=jm(n),{Fp:t,n:r}=e,i=t.BYTES+1,o=2*t.BYTES+1;function s(F){return Vn<F&&F<t.ORDER}function a(F){return He(F,r)}function l(F){return $c(F,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:p}=Fm({...e,toBytes(F,G,ie){const q=G.toAffine(),K=t.toBytes(q.x),Y=ri;return ie?Y(Uint8Array.from([G.hasEvenY()?2:3]),K):Y(Uint8Array.from([4]),K,t.toBytes(q.y))},fromBytes(F){const G=F.length,ie=F[0],q=F.subarray(1);if(G===i&&(ie===2||ie===3)){const K=Xr(q);if(!s(K))throw new Error("Point is not on curve");const Y=h(K);let z=t.sqrt(Y);const te=(z&Wt)===Wt;return(ie&1)===1!==te&&(z=t.neg(z)),{x:K,y:z}}else if(G===o&&ie===4){const K=t.fromBytes(q.subarray(0,t.BYTES)),Y=t.fromBytes(q.subarray(t.BYTES,2*t.BYTES));return{x:K,y:Y}}else throw new Error(`Point of length ${G} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),w=F=>ni(Sn(F,e.nByteLength));function x(F){const G=r>>Wt;return F>G}function g(F){return x(F)?a(-F):F}const R=(F,G,ie)=>Xr(F.slice(G,ie));class L{constructor(G,ie,q){this.r=G,this.s=ie,this.recovery=q,this.assertValidity()}static fromCompact(G){const ie=e.nByteLength;return G=nt("compactSignature",G,ie*2),new L(R(G,0,ie),R(G,ie,2*ie))}static fromDER(G){const{r:ie,s:q}=zr.toSig(nt("DER",G));return new L(ie,q)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(G){return new L(this.r,this.s,G)}recoverPublicKey(G){const{r:ie,s:q,recovery:K}=this,Y=H(nt("msgHash",G));if(K==null||![0,1,2,3].includes(K))throw new Error("recovery id invalid");const z=K===2||K===3?ie+e.n:ie;if(z>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const te=K&1?"03":"02",J=u.fromHex(te+w(z)),se=l(z),me=a(-Y*se),ge=a(q*se),de=u.BASE.multiplyAndAddUnsafe(J,me,ge);if(!de)throw new Error("point at infinify");return de.assertValidity(),de}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new L(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Mi(this.toDERHex())}toDERHex(){return zr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Mi(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}const $={isValidPrivateKey(F){try{return c(F),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const F=Dh(e.n);return Nm(e.randomBytes(F),e.n)},precompute(F=8,G=u.BASE){return G._setWindowSize(F),G.multiply(BigInt(3)),G}};function E(F,G=!0){return u.fromPrivateKey(F).toRawBytes(G)}function I(F){const G=xn(F),ie=typeof F=="string",q=(G||ie)&&F.length;return G?q===i||q===o:ie?q===2*i||q===2*o:F instanceof u}function A(F,G,ie=!0){if(I(F))throw new Error("first arg must be private key");if(!I(G))throw new Error("second arg must be public key");return u.fromHex(G).multiply(c(F)).toRawBytes(ie)}const U=e.bits2int||function(F){const G=Xr(F),ie=F.length*8-e.nBitLength;return ie>0?G>>BigInt(ie):G},H=e.bits2int_modN||function(F){return a(U(F))},W=Tl(e.nBitLength);function ee(F){if(typeof F!="bigint")throw new Error("bigint expected");if(!(Vn<=F&&F<W))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Sn(F,e.nByteLength)}function re(F,G,ie=ne){if(["recovered","canonical"].some(Re=>Re in ie))throw new Error("sign() legacy options not supported");const{hash:q,randomBytes:K}=e;let{lowS:Y,prehash:z,extraEntropy:te}=ie;Y==null&&(Y=!0),F=nt("msgHash",F),z&&(F=nt("prehashed msgHash",q(F)));const J=H(F),se=c(G),me=[ee(se),ee(J)];if(te!=null){const Re=te===!0?K(t.BYTES):te;me.push(nt("extraEntropy",Re))}const ge=ri(...me),de=J;function _e(Re){const Ke=U(Re);if(!p(Ke))return;const Ue=l(Ke),Le=u.BASE.multiply(Ke).toAffine(),k=a(Le.x);if(k===Vn)return;const C=a(Ue*a(de+k*se));if(C===Vn)return;let V=(Le.x===k?0:2)|Number(Le.y&Wt),y=C;return Y&&x(C)&&(y=g(C),V^=1),new L(k,y,V)}return{seed:ge,k2sig:_e}}const ne={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function M(F,G,ie=ne){const{seed:q,k2sig:K}=re(F,G,ie),Y=e;return Ch(Y.hash.outputLen,Y.nByteLength,Y.hmac)(q,K)}u.BASE._setWindowSize(8);function pe(F,G,ie,q=Q){var Le;const K=F;if(G=nt("msgHash",G),ie=nt("publicKey",ie),"strict"in q)throw new Error("options.strict was renamed to lowS");const{lowS:Y,prehash:z}=q;let te,J;try{if(typeof K=="string"||xn(K))try{te=L.fromDER(K)}catch(k){if(!(k instanceof zr.Err))throw k;te=L.fromCompact(K)}else if(typeof K=="object"&&typeof K.r=="bigint"&&typeof K.s=="bigint"){const{r:k,s:C}=K;te=new L(k,C)}else throw new Error("PARSE");J=u.fromHex(ie)}catch(k){if(k.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Y&&te.hasHighS())return!1;z&&(G=e.hash(G));const{r:se,s:me}=te,ge=H(G),de=l(me),_e=a(ge*de),Re=a(se*de),Ke=(Le=u.BASE.multiplyAndAddUnsafe(J,_e,Re))==null?void 0:Le.toAffine();return Ke?a(Ke.x)===se:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:A,sign:M,verify:pe,ProjectivePoint:u,Signature:L,utils:$}}class Mh extends Ih{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,lm(e);const r=xl(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?e.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Ws(this),this.iHash.update(e),this}digestInto(e){Ws(this),xh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Kh=(n,e,t)=>new Mh(n,e).update(t).digest();Kh.create=(n,e)=>new Mh(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Vm(n){return{hash:n,hmac:(e,...t)=>Kh(n,e,Th(...t)),randomBytes:Sl}}function Fh(n,e){const t=r=>Hm({...n,...Vm(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ud=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Wm=BigInt(1),Uc=BigInt(2),dd=(n,e)=>(n+e/Uc)/e;function qm(n){const e=jh,t=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),l=BigInt(88),u=n*n*n%e,c=u*u*n%e,h=ze(c,t,e)*c%e,p=ze(h,t,e)*c%e,w=ze(p,Uc,e)*u%e,x=ze(w,i,e)*w%e,g=ze(x,o,e)*x%e,R=ze(g,a,e)*g%e,L=ze(R,l,e)*R%e,$=ze(L,a,e)*g%e,E=ze($,t,e)*c%e,I=ze(E,s,e)*x%e,A=ze(I,r,e)*u%e,U=ze(A,Uc,e);if(!Nc.eql(Nc.sqr(U),n))throw new Error("Cannot find square root");return U}const Nc=Il(jh,void 0,void 0,{sqrt:qm}),Ct=Fh({a:BigInt(0),b:BigInt(7),Fp:Nc,n:ud,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=ud,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Wm*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,s=BigInt("0x100000000000000000000000000000000"),a=dd(o*n,e),l=dd(-r*n,e);let u=He(n-a*t-l*i,e),c=He(-a*r-l*o,e);const h=u>s,p=c>s;if(h&&(u=e-u),p&&(c=e-c),u>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:u,k2neg:p,k2:c}}}},kh);BigInt(0);Ct.ProjectivePoint;function zm(n){const e=r=>{if(r!==null&&typeof r=="object"&&!Array.isArray(r)){const i=Object.keys(r).sort(),o={};for(const s of i)o[s]=e(r[s]);return o}return r},t=e(n);return JSON.stringify(t)}var Gm=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const fd="urn:jwk:";function Pe(n){return Gm(this,arguments,void 0,function*({jwk:e}){const t=e.kty;let r;if(t==="EC")r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(t==="oct")r={k:e.k,kty:e.kty};else if(t==="OKP")r={crv:e.crv,kty:e.kty,x:e.x};else if(t==="RSA")r={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${t}`);Qd(r);const i=zm(r),o=oe.string(i).toUint8Array(),s=yield _h.digest({data:o});return oe.uint8Array(s).toBase64Url()})}function Zr(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n&&"d"in n)||n.kty!=="EC"||typeof n.d!="string"||typeof n.x!="string")}function Ol(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n)||"d"in n||n.kty!=="EC"||typeof n.x!="string")}function Qr(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n&&"d"in n)||n.kty!=="OKP"||typeof n.d!="string"||typeof n.x!="string")}function kl(n){return!(!n||typeof n!="object"||"d"in n||!("kty"in n&&"crv"in n&&"x"in n)||n.kty!=="OKP"||typeof n.x!="string")}function Ym(n){if(!n||typeof n!="object")return!1;switch(n.kty){case"EC":case"OKP":case"RSA":return"d"in n;case"oct":return"k"in n;default:return!1}}var yt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Jm=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Ge{static adjustSignatureToLowS(e){return yt(this,arguments,void 0,function*({signature:t}){const r=Ct.Signature.fromCompact(t);return r.hasHighS()?r.normalizeS().toCompactRawBytes():t})}static bytesToPrivateKey(e){return yt(this,arguments,void 0,function*({privateKeyBytes:t}){const r=yield Ge.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"secp256k1",d:oe.uint8Array(t).toBase64Url(),x:oe.uint8Array(r.x).toBase64Url(),y:oe.uint8Array(r.y).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static bytesToPublicKey(e){return yt(this,arguments,void 0,function*({publicKeyBytes:t}){const r=yield Ge.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"secp256k1",x:oe.uint8Array(r.x).toBase64Url(),y:oe.uint8Array(r.y).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static compressPublicKey(e){return yt(this,arguments,void 0,function*({publicKeyBytes:t}){return Ct.ProjectivePoint.fromHex(t).toRawBytes(!0)})}static computePublicKey(e){return yt(this,arguments,void 0,function*({key:t}){const r=yield Ge.privateKeyToBytes({privateKey:t}),i=yield Ge.getCurvePoint({keyBytes:r}),o={kty:"EC",crv:"secp256k1",x:oe.uint8Array(i.x).toBase64Url(),y:oe.uint8Array(i.y).toBase64Url()};return o.kid=yield Pe({jwk:o}),o})}static convertDerToCompactSignature(e){return yt(this,arguments,void 0,function*({derSignature:t}){return Ct.Signature.fromDER(t).toCompactRawBytes()})}static decompressPublicKey(e){return yt(this,arguments,void 0,function*({publicKeyBytes:t}){return Ct.ProjectivePoint.fromHex(t).toRawBytes(!1)})}static generateKey(){return yt(this,void 0,void 0,function*(){const e=Ct.utils.randomPrivateKey(),t=yield Ge.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Pe({jwk:t}),t})}static getPublicKey(e){return yt(this,arguments,void 0,function*({key:t}){var r;if(!(Zr(t)&&t.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let i=Jm(t,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield Pe({jwk:i})),i})}static privateKeyToBytes(e){return yt(this,arguments,void 0,function*({privateKey:t}){if(!Zr(t))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return oe.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return yt(this,arguments,void 0,function*({publicKey:t}){if(!(Ol(t)&&t.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),i=oe.base64Url(t.x).toUint8Array(),o=oe.base64Url(t.y).toUint8Array();return new Uint8Array([...r,...i,...o])})}static sharedSecret(e){return yt(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:r}){if("x"in t&&"x"in r&&t.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const i=yield Ge.privateKeyToBytes({privateKey:t}),o=yield Ge.publicKeyToBytes({publicKey:r});return Ct.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return yt(this,arguments,void 0,function*({data:t,key:r}){const i=yield Ge.privateKeyToBytes({privateKey:r}),o=Ro(t);return Ct.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return yt(this,arguments,void 0,function*({privateKeyBytes:t}){return Ct.utils.isValidPrivateKey(t)})}static validatePublicKey(e){return yt(this,arguments,void 0,function*({publicKeyBytes:t}){try{Ct.ProjectivePoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return yt(this,arguments,void 0,function*({key:t,signature:r,data:i}){const o=yield Ge.publicKeyToBytes({publicKey:t}),s=Ro(i);return Ct.verify(r,s,o,{lowS:!1})})}static getCurvePoint(e){return yt(this,arguments,void 0,function*({keyBytes:t}){t.byteLength===32&&(t=Ct.getPublicKey(t));const r=Ct.ProjectivePoint.fromHex(t),i=Sn(r.x,32),o=Sn(r.y,32);return{x:i,y:o}})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hh=Il(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Xm=Hh.create(BigInt("-3")),Zm=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Qm=Fh({a:Xm,b:Zm,Fp:Hh,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},kh),Ft=Qm;var pt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},ev=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Je{static adjustSignatureToLowS(e){return pt(this,arguments,void 0,function*({signature:t}){const r=Ft.Signature.fromCompact(t);return r.hasHighS()?r.normalizeS().toCompactRawBytes():t})}static bytesToPrivateKey(e){return pt(this,arguments,void 0,function*({privateKeyBytes:t}){const r=yield Je.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"P-256",d:oe.uint8Array(t).toBase64Url(),x:oe.uint8Array(r.x).toBase64Url(),y:oe.uint8Array(r.y).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static bytesToPublicKey(e){return pt(this,arguments,void 0,function*({publicKeyBytes:t}){const r=yield Je.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"P-256",x:oe.uint8Array(r.x).toBase64Url(),y:oe.uint8Array(r.y).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static compressPublicKey(e){return pt(this,arguments,void 0,function*({publicKeyBytes:t}){return Ft.ProjectivePoint.fromHex(t).toRawBytes(!0)})}static computePublicKey(e){return pt(this,arguments,void 0,function*({key:t}){const r=yield Je.privateKeyToBytes({privateKey:t}),i=yield Je.getCurvePoint({keyBytes:r}),o={kty:"EC",crv:"P-256",x:oe.uint8Array(i.x).toBase64Url(),y:oe.uint8Array(i.y).toBase64Url()};return o.kid=yield Pe({jwk:o}),o})}static convertDerToCompactSignature(e){return pt(this,arguments,void 0,function*({derSignature:t}){return Ft.Signature.fromDER(t).toCompactRawBytes()})}static decompressPublicKey(e){return pt(this,arguments,void 0,function*({publicKeyBytes:t}){return Ft.ProjectivePoint.fromHex(t).toRawBytes(!1)})}static generateKey(){return pt(this,void 0,void 0,function*(){const e=Ft.utils.randomPrivateKey(),t=yield Je.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Pe({jwk:t}),t})}static getPublicKey(e){return pt(this,arguments,void 0,function*({key:t}){var r;if(!(Zr(t)&&t.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let i=ev(t,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield Pe({jwk:i})),i})}static privateKeyToBytes(e){return pt(this,arguments,void 0,function*({privateKey:t}){if(!Zr(t))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return oe.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return pt(this,arguments,void 0,function*({publicKey:t}){if(!(Ol(t)&&t.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),i=oe.base64Url(t.x).toUint8Array(),o=oe.base64Url(t.y).toUint8Array();return new Uint8Array([...r,...i,...o])})}static sharedSecret(e){return pt(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:r}){if("x"in t&&"x"in r&&t.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const i=yield Je.privateKeyToBytes({privateKey:t}),o=yield Je.publicKeyToBytes({publicKey:r});return Ft.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return pt(this,arguments,void 0,function*({data:t,key:r}){const i=yield Je.privateKeyToBytes({privateKey:r}),o=Ro(t);return Ft.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return pt(this,arguments,void 0,function*({privateKeyBytes:t}){return Ft.utils.isValidPrivateKey(t)})}static validatePublicKey(e){return pt(this,arguments,void 0,function*({publicKeyBytes:t}){try{Ft.ProjectivePoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return pt(this,arguments,void 0,function*({key:t,signature:r,data:i}){const o=yield Je.publicKeyToBytes({publicKey:t}),s=Ro(i);return Ft.verify(r,s,o,{lowS:!1})})}static getCurvePoint(e){return pt(this,arguments,void 0,function*({keyBytes:t}){t.byteLength===32&&(t=Ft.getPublicKey(t));const r=Ft.ProjectivePoint.fromHex(t),i=Sn(r.x,32),o=Sn(r.y,32);return{x:i,y:o}})}}var co=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class hd extends _l{computePublicKey(e){return co(this,arguments,void 0,function*({key:t}){if(!Zr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":{const r=yield Ge.computePublicKey({key:t});return r.alg="ES256K",r}case"P-256":{const r=yield Je.computePublicKey({key:t});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}generateKey(e){return co(this,arguments,void 0,function*({algorithm:t}){switch(t){case"ES256K":case"secp256k1":{const r=yield Ge.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{const r=yield Je.generateKey();return r.alg="ES256",r}}})}getPublicKey(e){return co(this,arguments,void 0,function*({key:t}){if(!Zr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":{const r=yield Ge.getPublicKey({key:t});return r.alg="ES256K",r}case"P-256":{const r=yield Je.getPublicKey({key:t});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}sign(e){return co(this,arguments,void 0,function*({key:t,data:r}){if(!Zr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":return yield Ge.sign({key:t,data:r});case"P-256":return yield Je.sign({key:t,data:r});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}verify(e){return co(this,arguments,void 0,function*({key:t,signature:r,data:i}){if(!Ol(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(t.crv){case"secp256k1":return yield Ge.verify({key:t,signature:r,data:i});case"P-256":return yield Je.verify({key:t,signature:r,data:i});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}}const ys=BigInt(2**32-1),Dc=BigInt(32);function Vh(n,e=!1){return e?{h:Number(n&ys),l:Number(n>>Dc&ys)}:{h:Number(n>>Dc&ys)|0,l:Number(n&ys)|0}}function tv(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:o,l:s}=Vh(n[i],e);[t[i],r[i]]=[o,s]}return[t,r]}const nv=(n,e)=>BigInt(n>>>0)<<Dc|BigInt(e>>>0),rv=(n,e,t)=>n>>>t,iv=(n,e,t)=>n<<32-t|e>>>t,ov=(n,e,t)=>n>>>t|e<<32-t,sv=(n,e,t)=>n<<32-t|e>>>t,av=(n,e,t)=>n<<64-t|e>>>t-32,cv=(n,e,t)=>n>>>t-32|e<<64-t,lv=(n,e)=>e,uv=(n,e)=>n,dv=(n,e,t)=>n<<t|e>>>32-t,fv=(n,e,t)=>e<<t|n>>>32-t,hv=(n,e,t)=>e<<t-32|n>>>64-t,yv=(n,e,t)=>n<<t-32|e>>>64-t;function pv(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}const gv=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),wv=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,bv=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),mv=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,vv=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),Ev=(n,e,t,r,i,o)=>e+t+r+i+o+(n/2**32|0)|0,Se={fromBig:Vh,split:tv,toBig:nv,shrSH:rv,shrSL:iv,rotrSH:ov,rotrSL:sv,rotrBH:av,rotrBL:cv,rotr32H:lv,rotr32L:uv,rotlSH:dv,rotlSL:fv,rotlBH:hv,rotlBL:yv,add:pv,add3L:gv,add3H:wv,add4L:bv,add4H:mv,add5H:Ev,add5L:vv},[_v,xv]=Se.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),ur=new Uint32Array(80),dr=new Uint32Array(80);class Sv extends Oh{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:o,Cl:s,Dh:a,Dl:l,Eh:u,El:c,Fh:h,Fl:p,Gh:w,Gl:x,Hh:g,Hl:R}=this;return[e,t,r,i,o,s,a,l,u,c,h,p,w,x,g,R]}set(e,t,r,i,o,s,a,l,u,c,h,p,w,x,g,R){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=l|0,this.Eh=u|0,this.El=c|0,this.Fh=h|0,this.Fl=p|0,this.Gh=w|0,this.Gl=x|0,this.Hh=g|0,this.Hl=R|0}process(e,t){for(let E=0;E<16;E++,t+=4)ur[E]=e.getUint32(t),dr[E]=e.getUint32(t+=4);for(let E=16;E<80;E++){const I=ur[E-15]|0,A=dr[E-15]|0,U=Se.rotrSH(I,A,1)^Se.rotrSH(I,A,8)^Se.shrSH(I,A,7),H=Se.rotrSL(I,A,1)^Se.rotrSL(I,A,8)^Se.shrSL(I,A,7),W=ur[E-2]|0,ee=dr[E-2]|0,re=Se.rotrSH(W,ee,19)^Se.rotrBH(W,ee,61)^Se.shrSH(W,ee,6),ne=Se.rotrSL(W,ee,19)^Se.rotrBL(W,ee,61)^Se.shrSL(W,ee,6),Q=Se.add4L(H,ne,dr[E-7],dr[E-16]),M=Se.add4H(Q,U,re,ur[E-7],ur[E-16]);ur[E]=M|0,dr[E]=Q|0}let{Ah:r,Al:i,Bh:o,Bl:s,Ch:a,Cl:l,Dh:u,Dl:c,Eh:h,El:p,Fh:w,Fl:x,Gh:g,Gl:R,Hh:L,Hl:$}=this;for(let E=0;E<80;E++){const I=Se.rotrSH(h,p,14)^Se.rotrSH(h,p,18)^Se.rotrBH(h,p,41),A=Se.rotrSL(h,p,14)^Se.rotrSL(h,p,18)^Se.rotrBL(h,p,41),U=h&w^~h&g,H=p&x^~p&R,W=Se.add5L($,A,H,xv[E],dr[E]),ee=Se.add5H(W,L,I,U,_v[E],ur[E]),re=W|0,ne=Se.rotrSH(r,i,28)^Se.rotrBH(r,i,34)^Se.rotrBH(r,i,39),Q=Se.rotrSL(r,i,28)^Se.rotrBL(r,i,34)^Se.rotrBL(r,i,39),M=r&o^r&a^o&a,pe=i&s^i&l^s&l;L=g|0,$=R|0,g=w|0,R=x|0,w=h|0,x=p|0,{h,l:p}=Se.add(u|0,c|0,ee|0,re|0),u=a|0,c=l|0,a=o|0,l=s|0,o=r|0,s=i|0;const F=Se.add3L(re,Q,pe);r=Se.add3H(F,ee,ne,M),i=F|0}({h:r,l:i}=Se.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:o,l:s}=Se.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l}=Se.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:u,l:c}=Se.add(this.Dh|0,this.Dl|0,u|0,c|0),{h,l:p}=Se.add(this.Eh|0,this.El|0,h|0,p|0),{h:w,l:x}=Se.add(this.Fh|0,this.Fl|0,w|0,x|0),{h:g,l:R}=Se.add(this.Gh|0,this.Gl|0,g|0,R|0),{h:L,l:$}=Se.add(this.Hh|0,this.Hl|0,L|0,$|0),this.set(r,i,o,s,a,l,u,c,h,p,w,x,g,R,L,$)}roundClean(){ur.fill(0),dr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Wh=Rh(()=>new Sv);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qt=BigInt(0),Bt=BigInt(1),ps=BigInt(2),Av=BigInt(8),Tv={zip215:!0};function Iv(n){const e=Rl(n);return fi(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Bl(n){const e=Iv(n),{Fp:t,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:l}=e,u=ps<<BigInt(a*8)-Bt,c=t.create,h=e.uvRatio||((q,K)=>{try{return{isValid:!0,value:t.sqrt(q*t.inv(K))}}catch{return{isValid:!1,value:Qt}}}),p=e.adjustScalarBytes||(q=>q),w=e.domain||((q,K,Y)=>{if(K.length||Y)throw new Error("Contexts/pre-hash are not supported");return q}),x=q=>typeof q=="bigint"&&Qt<q,g=(q,K)=>x(q)&&x(K)&&q<K,R=q=>q===Qt||g(q,u);function L(q,K){if(g(q,K))return q;throw new Error(`Expected valid scalar < ${K}, got ${typeof q} ${q}`)}function $(q){return q===Qt?q:L(q,r)}const E=new Map;function I(q){if(!(q instanceof A))throw new Error("ExtendedPoint expected")}class A{constructor(K,Y,z,te){if(this.ex=K,this.ey=Y,this.ez=z,this.et=te,!R(K))throw new Error("x required");if(!R(Y))throw new Error("y required");if(!R(z))throw new Error("z required");if(!R(te))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(K){if(K instanceof A)throw new Error("extended point not allowed");const{x:Y,y:z}=K||{};if(!R(Y)||!R(z))throw new Error("invalid affine point");return new A(Y,z,Bt,c(Y*z))}static normalizeZ(K){const Y=t.invertBatch(K.map(z=>z.ez));return K.map((z,te)=>z.toAffine(Y[te])).map(A.fromAffine)}_setWindowSize(K){this._WINDOW_SIZE=K,E.delete(this)}assertValidity(){const{a:K,d:Y}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:z,ey:te,ez:J,et:se}=this,me=c(z*z),ge=c(te*te),de=c(J*J),_e=c(de*de),Re=c(me*K),Ke=c(de*c(Re+ge)),Ue=c(_e+c(Y*c(me*ge)));if(Ke!==Ue)throw new Error("bad point: equation left != right (1)");const Le=c(z*te),k=c(J*se);if(Le!==k)throw new Error("bad point: equation left != right (2)")}equals(K){I(K);const{ex:Y,ey:z,ez:te}=this,{ex:J,ey:se,ez:me}=K,ge=c(Y*me),de=c(J*te),_e=c(z*me),Re=c(se*te);return ge===de&&_e===Re}is0(){return this.equals(A.ZERO)}negate(){return new A(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){const{a:K}=e,{ex:Y,ey:z,ez:te}=this,J=c(Y*Y),se=c(z*z),me=c(ps*c(te*te)),ge=c(K*J),de=Y+z,_e=c(c(de*de)-J-se),Re=ge+se,Ke=Re-me,Ue=ge-se,Le=c(_e*Ke),k=c(Re*Ue),C=c(_e*Ue),V=c(Ke*Re);return new A(Le,k,V,C)}add(K){I(K);const{a:Y,d:z}=e,{ex:te,ey:J,ez:se,et:me}=this,{ex:ge,ey:de,ez:_e,et:Re}=K;if(Y===BigInt(-1)){const D=c((J-te)*(de+ge)),he=c((J+te)*(de-ge)),Te=c(he-D);if(Te===Qt)return this.double();const Ce=c(se*ps*Re),qe=c(me*ps*_e),Ne=qe+Ce,Zt=he+D,it=qe-Ce,Ot=c(Ne*Te),On=c(Zt*it),hi=c(Ne*it),kn=c(Te*Zt);return new A(Ot,On,kn,hi)}const Ke=c(te*ge),Ue=c(J*de),Le=c(me*z*Re),k=c(se*_e),C=c((te+J)*(ge+de)-Ke-Ue),V=k-Le,y=k+Le,d=c(Ue-Y*Ke),f=c(C*V),m=c(y*d),B=c(C*d),j=c(V*y);return new A(f,m,j,B)}subtract(K){return this.add(K.negate())}wNAF(K){return W.wNAFCached(this,E,K,A.normalizeZ)}multiply(K){const{p:Y,f:z}=this.wNAF(L(K,r));return A.normalizeZ([Y,z])[0]}multiplyUnsafe(K){let Y=$(K);return Y===Qt?H:this.equals(H)||Y===Bt?this:this.equals(U)?this.wNAF(Y).p:W.unsafeLadder(this,Y)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return W.unsafeLadder(this,r).is0()}toAffine(K){const{ex:Y,ey:z,ez:te}=this,J=this.is0();K==null&&(K=J?Av:t.inv(te));const se=c(Y*K),me=c(z*K),ge=c(te*K);if(J)return{x:Qt,y:Bt};if(ge!==Bt)throw new Error("invZ was invalid");return{x:se,y:me}}clearCofactor(){const{h:K}=e;return K===Bt?this:this.multiplyUnsafe(K)}static fromHex(K,Y=!1){const{d:z,a:te}=e,J=t.BYTES;K=nt("pointHex",K,J);const se=K.slice(),me=K[J-1];se[J-1]=me&-129;const ge=vr(se);ge===Qt||(Y?L(ge,u):L(ge,t.ORDER));const de=c(ge*ge),_e=c(de-Bt),Re=c(z*de-te);let{isValid:Ke,value:Ue}=h(_e,Re);if(!Ke)throw new Error("Point.fromHex: invalid y coordinate");const Le=(Ue&Bt)===Bt,k=(me&128)!==0;if(!Y&&Ue===Qt&&k)throw new Error("Point.fromHex: x=0 and x_0=1");return k!==Le&&(Ue=c(-Ue)),A.fromAffine({x:Ue,y:ge})}static fromPrivateKey(K){return ne(K).point}toRawBytes(){const{x:K,y:Y}=this.toAffine(),z=Ki(Y,t.BYTES);return z[z.length-1]|=K&Bt?128:0,z}toHex(){return ni(this.toRawBytes())}}A.BASE=new A(e.Gx,e.Gy,Bt,c(e.Gx*e.Gy)),A.ZERO=new A(Qt,Bt,Bt,Qt);const{BASE:U,ZERO:H}=A,W=Ph(A,a*8);function ee(q){return He(q,r)}function re(q){return ee(vr(q))}function ne(q){const K=a;q=nt("private key",q,K);const Y=nt("hashed private key",o(q),2*K),z=p(Y.slice(0,K)),te=Y.slice(K,2*K),J=re(z),se=U.multiply(J),me=se.toRawBytes();return{head:z,prefix:te,scalar:J,point:se,pointBytes:me}}function Q(q){return ne(q).pointBytes}function M(q=new Uint8Array,...K){const Y=ri(...K);return re(o(w(Y,nt("context",q),!!i)))}function pe(q,K,Y={}){q=nt("message",q),i&&(q=i(q));const{prefix:z,scalar:te,pointBytes:J}=ne(K),se=M(Y.context,z,q),me=U.multiply(se).toRawBytes(),ge=M(Y.context,me,J,q),de=ee(se+ge*te);$(de);const _e=ri(me,Ki(de,t.BYTES));return nt("result",_e,a*2)}const F=Tv;function G(q,K,Y,z=F){const{context:te,zip215:J}=z,se=t.BYTES;q=nt("signature",q,2*se),K=nt("message",K),i&&(K=i(K));const me=vr(q.slice(se,2*se));let ge,de,_e;try{ge=A.fromHex(Y,J),de=A.fromHex(q.slice(0,se),J),_e=U.multiplyUnsafe(me)}catch{return!1}if(!J&&ge.isSmallOrder())return!1;const Re=M(te,de.toRawBytes(),ge.toRawBytes(),K);return de.add(ge.multiplyUnsafe(Re)).subtract(_e).clearCofactor().equals(A.ZERO)}return U._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:pe,verify:G,ExtendedPoint:A,utils:{getExtendedPublicKey:ne,randomPrivateKey:()=>s(t.BYTES),precompute(q=8,K=A.BASE){return K._setWindowSize(q),K.multiply(BigInt(3)),K}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lo=BigInt(0),lc=BigInt(1);function Rv(n){return fi(n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n})}function Ov(n){const e=Rv(n),{P:t}=e,r=E=>He(E,t),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(E=>E),l=e.powPminus2||(E=>$h(E,t-BigInt(2),t));function u(E,I,A){const U=r(E*(I-A));return I=r(I-U),A=r(A+U),[I,A]}function c(E){if(typeof E=="bigint"&&lo<=E&&E<t)return E;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const h=(e.a-BigInt(2))/BigInt(4);function p(E,I){const A=c(E),U=c(I),H=A;let W=lc,ee=lo,re=A,ne=lc,Q=lo,M;for(let F=BigInt(i-1);F>=lo;F--){const G=U>>F&lc;Q^=G,M=u(Q,W,re),W=M[0],re=M[1],M=u(Q,ee,ne),ee=M[0],ne=M[1],Q=G;const ie=W+ee,q=r(ie*ie),K=W-ee,Y=r(K*K),z=q-Y,te=re+ne,J=re-ne,se=r(J*ie),me=r(te*K),ge=se+me,de=se-me;re=r(ge*ge),ne=r(H*r(de*de)),W=r(q*Y),ee=r(z*(q+r(h*z)))}M=u(Q,W,re),W=M[0],re=M[1],M=u(Q,ee,ne),ee=M[0],ne=M[1];const pe=l(ee);return r(W*pe)}function w(E){return Ki(r(E),o)}function x(E){const I=nt("u coordinate",E,o);return s===32&&(I[31]&=127),vr(I)}function g(E){const I=nt("scalar",E),A=I.length;if(A!==o&&A!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${A}`);return vr(a(I))}function R(E,I){const A=x(I),U=g(E),H=p(A,U);if(H===lo)throw new Error("Invalid private or public key received");return w(H)}const L=w(e.Gu);function $(E){return R(E,L)}return{scalarMult:R,scalarMultBase:$,getSharedSecret:(E,I)=>R(E,I),getPublicKey:E=>$(E),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:L}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Oo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),yd=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const kv=BigInt(1),Pc=BigInt(2),Bv=BigInt(5),pd=BigInt(10),Lv=BigInt(20),Cv=BigInt(40),gd=BigInt(80);function qh(n){const e=Oo,r=n*n%e*n%e,i=ze(r,Pc,e)*r%e,o=ze(i,kv,e)*n%e,s=ze(o,Bv,e)*o%e,a=ze(s,pd,e)*s%e,l=ze(a,Lv,e)*a%e,u=ze(l,Cv,e)*l%e,c=ze(u,gd,e)*u%e,h=ze(c,gd,e)*u%e,p=ze(h,pd,e)*s%e;return{pow_p_5_8:ze(p,Pc,e)*n%e,b2:r}}function zh(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function $v(n,e){const t=Oo,r=He(e*e*e,t),i=He(r*r*e,t),o=qh(n*i).pow_p_5_8;let s=He(n*r*o,t);const a=He(e*s*s,t),l=s,u=He(s*yd,t),c=a===n,h=a===He(-n,t),p=a===He(-n*yd,t);return c&&(s=l),(h||p)&&(s=u),km(s,t)&&(s=He(-s,t)),{isValid:c||h,value:s}}const Gt=Il(Oo,void 0,!0),ko={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Gt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Wh,randomBytes:Sl,adjustScalarBytes:zh,uvRatio:$v},Fr=Bl(ko);function Gh(n,e,t){if(e.length>255)throw new Error("Context is too big");return Th(Ah("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,n)}({...ko});({...ko});const wo=Ov({P:Oo,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:n=>{const e=Oo,{pow_p_5_8:t,b2:r}=qh(n);return He(ze(t,BigInt(3),e)*r,e)},adjustScalarBytes:zh,randomBytes:Sl});function Uv(n){const{y:e}=Fr.ExtendedPoint.fromHex(n),t=BigInt(1);return Gt.toBytes(Gt.create((t+e)*Gt.inv(t-e)))}function Nv(n){const e=ko.hash(n.subarray(0,32));return ko.adjustScalarBytes(e).subarray(0,32)}const Dv=(Gt.ORDER+BigInt(3))/BigInt(8);Gt.pow(Pc,Dv);Gt.sqrt(Gt.neg(Gt.ONE));(Gt.ORDER-BigInt(5))/BigInt(8);BigInt(486662);Um(Gt,Gt.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var jt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Pv=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Xe{static bytesToPrivateKey(e){return jt(this,arguments,void 0,function*({privateKeyBytes:t}){const r=Fr.getPublicKey(t),i={crv:"Ed25519",d:oe.uint8Array(t).toBase64Url(),kty:"OKP",x:oe.uint8Array(r).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static bytesToPublicKey(e){return jt(this,arguments,void 0,function*({publicKeyBytes:t}){const r={kty:"OKP",crv:"Ed25519",x:oe.uint8Array(t).toBase64Url()};return r.kid=yield Pe({jwk:r}),r})}static computePublicKey(e){return jt(this,arguments,void 0,function*({key:t}){const r=yield Xe.privateKeyToBytes({privateKey:t}),i=Fr.getPublicKey(r),o={kty:"OKP",crv:"Ed25519",x:oe.uint8Array(i).toBase64Url()};return o.kid=yield Pe({jwk:o}),o})}static convertPrivateKeyToX25519(e){return jt(this,arguments,void 0,function*({privateKey:t}){const r=yield Xe.privateKeyToBytes({privateKey:t}),i=Nv(r),o=wo.getPublicKey(i),s={kty:"OKP",crv:"X25519",d:oe.uint8Array(i).toBase64Url(),x:oe.uint8Array(o).toBase64Url()};return s.kid=yield Pe({jwk:s}),s})}static convertPublicKeyToX25519(e){return jt(this,arguments,void 0,function*({publicKey:t}){const r=yield Xe.publicKeyToBytes({publicKey:t});if(!(yield Xe.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");const o=Uv(r),s={kty:"OKP",crv:"X25519",x:oe.uint8Array(o).toBase64Url()};return s.kid=yield Pe({jwk:s}),s})}static generateKey(){return jt(this,void 0,void 0,function*(){const e=Fr.utils.randomPrivateKey(),t=yield Xe.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Pe({jwk:t}),t})}static getPublicKey(e){return jt(this,arguments,void 0,function*({key:t}){var r;if(!(Qr(t)&&t.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let i=Pv(t,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield Pe({jwk:i})),i})}static privateKeyToBytes(e){return jt(this,arguments,void 0,function*({privateKey:t}){if(!Qr(t))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return oe.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return jt(this,arguments,void 0,function*({publicKey:t}){if(!kl(t))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return oe.base64Url(t.x).toUint8Array()})}static sign(e){return jt(this,arguments,void 0,function*({key:t,data:r}){const i=yield Xe.privateKeyToBytes({privateKey:t});return Fr.sign(r,i)})}static validatePublicKey(e){return jt(this,arguments,void 0,function*({publicKeyBytes:t}){try{Fr.ExtendedPoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return jt(this,arguments,void 0,function*({key:t,signature:r,data:i}){const o=yield Xe.publicKeyToBytes({publicKey:t});return Fr.verify(r,i,o)})}}var uo=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Mv extends _l{computePublicKey(e){return uo(this,arguments,void 0,function*({key:t}){if(!Qr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":{const r=yield Xe.computePublicKey({key:t});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}generateKey(e){return uo(this,arguments,void 0,function*({algorithm:t}){switch(t){case"Ed25519":{const r=yield Xe.generateKey();return r.alg="EdDSA",r}}})}getPublicKey(e){return uo(this,arguments,void 0,function*({key:t}){if(!Qr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":{const r=yield Xe.getPublicKey({key:t});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}sign(e){return uo(this,arguments,void 0,function*({key:t,data:r}){if(!Qr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":return yield Xe.sign({key:t,data:r});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}verify(e){return uo(this,arguments,void 0,function*({key:t,signature:r,data:i}){if(!kl(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(t.crv){case"Ed25519":return yield Xe.verify({key:t,signature:r,data:i});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}}var Pn=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const uc={Ed25519:{implementation:Mv,names:["Ed25519"]},secp256k1:{implementation:hd,names:["ES256K","secp256k1"]},secp256r1:{implementation:hd,names:["ES256","secp256r1"]},"SHA-256":{implementation:am,names:["SHA-256"]}};class Jn{constructor(e){var t;this._algorithmInstances=new Map,this._keyStore=(t=e==null?void 0:e.keyStore)!==null&&t!==void 0?t:new _0}digest(e){return Pn(this,arguments,void 0,function*({algorithm:t,data:r}){return yield this.getAlgorithm({algorithm:t}).digest({algorithm:t,data:r})})}exportKey(e){return Pn(this,arguments,void 0,function*({keyUri:t}){return yield this.getPrivateKey({keyUri:t})})}generateKey(e){return Pn(this,arguments,void 0,function*({algorithm:t}){const i=yield this.getAlgorithm({algorithm:t}).generateKey({algorithm:t});if((i==null?void 0:i.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const o=`${fd}${i.kid}`;return yield this._keyStore.set(o,i),o})}getKeyUri(e){return Pn(this,arguments,void 0,function*({key:t}){const r=yield Pe({jwk:t});return`${fd}${r}`})}getPublicKey(e){return Pn(this,arguments,void 0,function*({keyUri:t}){const r=yield this.getPrivateKey({keyUri:t}),i=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:i}).getPublicKey({key:r})})}importKey(e){return Pn(this,arguments,void 0,function*({key:t}){var r;if(!Ym(t))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const i=structuredClone(t);(r=i.kid)!==null&&r!==void 0||(i.kid=yield Pe({jwk:i}));const o=yield this.getKeyUri({key:i});return yield this._keyStore.set(o,i),o})}sign(e){return Pn(this,arguments,void 0,function*({keyUri:t,data:r}){const i=yield this.getPrivateKey({keyUri:t}),o=this.getAlgorithmName({key:i});return this.getAlgorithm({algorithm:o}).sign({data:r,key:i})})}verify(e){return Pn(this,arguments,void 0,function*({key:t,signature:r,data:i}){const o=this.getAlgorithmName({key:t});return this.getAlgorithm({algorithm:o}).verify({key:t,signature:r,data:i})})}getAlgorithm({algorithm:e}){var t;const r=(t=uc[e])===null||t===void 0?void 0:t.implementation;if(!r)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(r)||this._algorithmInstances.set(r,new r),this._algorithmInstances.get(r)}getAlgorithmName({key:e}){const t=e.alg,r=e.crv;for(const i in uc){const o=uc[i];if(t&&o.names.includes(t))return i;if(r&&o.names.includes(r))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${t}, crv=${r}`)}getPrivateKey(e){return Pn(this,arguments,void 0,function*({keyUri:t}){const r=yield this._keyStore.get(t);if(!r)throw new Error(`Key not found: ${t}`);return r})}}function Kv(n){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(n.alg&&Object.values(e).includes(n.alg))return n.alg;if(n.crv&&Object.keys(e).includes(n.crv))return e[n.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${n.alg}, crv=${n.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}function Mc(n){return Zb(n)}function Fv(){return Is.randomUUID()}function jv({length:n}){if(3>n||n>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");const e=Math.pow(10,n)-1;let t;if(n<=6){const r=Math.pow(10,n);do{const i=Mc(Math.ceil(n/2));t=new DataView(i.buffer).getUint16(0,!1)%r}while(t>e)}else{const r=Math.pow(10,10);do{const i=Mc(4);t=new DataView(i.buffer).getUint32(0,!1)%r}while(t>e)}return t.toString().padStart(n,"0")}const Hv={randomPin:jv,randomUuid:Fv,randomBytes:Mc,getJoseSignatureAlgorithmFromPublicKey:Kv};var fr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Vv=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Gr{static bytesToPrivateKey(e){return fr(this,arguments,void 0,function*({privateKeyBytes:t}){const r=wo.getPublicKey(t),i={kty:"OKP",crv:"X25519",d:oe.uint8Array(t).toBase64Url(),x:oe.uint8Array(r).toBase64Url()};return i.kid=yield Pe({jwk:i}),i})}static bytesToPublicKey(e){return fr(this,arguments,void 0,function*({publicKeyBytes:t}){const r={kty:"OKP",crv:"X25519",x:oe.uint8Array(t).toBase64Url()};return r.kid=yield Pe({jwk:r}),r})}static computePublicKey(e){return fr(this,arguments,void 0,function*({key:t}){const r=yield Gr.privateKeyToBytes({privateKey:t}),i=wo.getPublicKey(r),o={kty:"OKP",crv:"X25519",x:oe.uint8Array(i).toBase64Url()};return o.kid=yield Pe({jwk:o}),o})}static generateKey(){return fr(this,void 0,void 0,function*(){const e=wo.utils.randomPrivateKey(),t=yield Gr.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Pe({jwk:t}),t})}static getPublicKey(e){return fr(this,arguments,void 0,function*({key:t}){var r;if(!(Qr(t)&&t.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let i=Vv(t,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield Pe({jwk:i})),i})}static privateKeyToBytes(e){return fr(this,arguments,void 0,function*({privateKey:t}){if(!Qr(t))throw new Error("X25519: The provided key is not a valid OKP private key.");return oe.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return fr(this,arguments,void 0,function*({publicKey:t}){if(!kl(t))throw new Error("X25519: The provided key is not a valid OKP public key.");return oe.base64Url(t.x).toUint8Array()})}static sharedSecret(e){return fr(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:r}){if("x"in t&&"x"in r&&t.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const i=yield Gr.privateKeyToBytes({privateKey:t}),o=yield Gr.publicKeyToBytes({publicKey:r});return wo.getSharedSecret(i,o)})}}function nn(n){if(typeof n=="string"&&n.length!==0)return n.split("#").pop()}function Yh({didDocument:n}){var e,t;if(!n)throw new TypeError("Required parameter missing: 'didDocument'");const r=[];return r.push(...(t=(e=n.verificationMethod)===null||e===void 0?void 0:e.filter(Kc))!==null&&t!==void 0?t:[]),Object.keys(To).forEach(i=>{var o,s;r.push(...(s=(o=n[i])===null||o===void 0?void 0:o.filter(Kc))!==null&&s!==void 0?s:[])}),r}function Wv({didDocument:n}){const t=Yh({didDocument:n}).map(r=>r.type);return[...new Set(t)]}function qv({didDocument:n,methodId:e}){const t=[];return Object.keys(To).forEach(r=>{if(Array.isArray(n[r])){const i=n[r],o=nn(e);i.some(a=>{const l=nn(a)===o,u=Kc(a)&&nn(a.id)===o;return l||u})&&t.push(r)}}),t}function Kc(n){return!(!n||typeof n!="object"||n===null||!("id"in n&&"type"in n&&"controller"in n)||typeof n.id!="string"||typeof n.type!="string"||typeof n.controller!="string")}function Jh({keyBytes:n,multicodecCode:e,multicodecName:t}){const r=at.addPrefix({code:e,data:n,name:t}),i=oe.uint8Array(r).toBase58Btc();return oe.base58Btc(i).toMultibase()}function wd({multibaseKeyId:n}){try{const e=oe.multibase(n).toBase58Btc(),t=oe.base58Btc(e).toUint8Array(),{code:r,data:i,name:o}=at.removePrefix({prefixedData:t});return{keyBytes:i,multicodecCode:r,multicodecName:o}}catch{throw new ye(fe.InvalidDid,`Invalid multibase identifier: ${n}`)}}var fo=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class An{constructor({uri:e,document:t,metadata:r,keyManager:i}){this.uri=e,this.document=t,this.metadata=r,this.keyManager=i}export(){return fo(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const t=[];for(let r of this.document.verificationMethod){if(!r.publicKeyJwk)throw new Error(`Verification method '${r.id}' does not contain a public key in JWK format`);const i=yield this.keyManager.getKeyUri({key:r.publicKeyJwk}),o=yield this.keyManager.exportKey({keyUri:i});t.push(Object.assign({},o))}e.privateKeys=t}return e})}getSigner(e){return fo(this,void 0,void 0,function*(){var t;const r=(t=this.document.verificationMethod)===null||t===void 0?void 0:t.find(l=>{var u,c;return nn(l.id)===((u=nn(e==null?void 0:e.methodId))!==null&&u!==void 0?u:nn((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(r&&r.publicKeyJwk))throw new ye(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");const i=yield this.keyManager.getKeyUri({key:r.publicKeyJwk}),o=yield this.keyManager.getPublicKey({keyUri:i}),s=this.keyManager;return{algorithm:Hv.getJoseSignatureAlgorithmFromPublicKey(o),keyId:r.id,sign(l){return fo(this,arguments,void 0,function*({data:u}){return yield s.sign({data:u,keyUri:i})})},verify(l){return fo(this,arguments,void 0,function*({data:u,signature:c}){return yield s.verify({data:u,key:o,signature:c})})}}})}static import(e){return fo(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Jn}){var i;const o=Yh({didDocument:t.document});if(o.length===0)throw new ye(fe.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(i=t.privateKeys)!==null&&i!==void 0?i:[])yield r.importKey({key:a});for(let a of o){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const l=yield r.getKeyUri({key:a.publicKeyJwk});yield r.getPublicKey({keyUri:l})}return new An({uri:t.uri,document:t.document,metadata:t.metadata,keyManager:r})})}}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const bd="0123456789abcdef",Xh=[];for(let n=0;n<256;n++)Xh[n]=bd[n>>4&15]+bd[n&15];const zv=n=>{const e=n.length;let t="",r=0;for(;r<e;)t+=Xh[n[r++]];return t},Gv=(n,e=0)=>{const t=n.length||0;if(!e){let s=t;for(;s--;)e+=n[s].length}const r=new Uint8Array(e);let i=e,o=t;for(;o--;)i-=n[o].length,r.set(n[o],i);return r};var md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yv=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var gs=0;gs<md.length;gs++)Yv[md.charCodeAt(gs)]=gs;const Jv=new TextDecoder,Zh=(n,e)=>Jv.decode(n),Xv=new TextEncoder,Xn=n=>Xv.encode(n),vd=typeof window<"u"?window:self,Ed=vd.crypto||vd.msCrypto||{};Ed.subtle||Ed.webkitSubtle;function Fo(n){const e=n<0?1:0;return n=Math.abs(Number(n||1)),Math.floor(Math.log10(n))+1+e}function Qh(n){return ArrayBuffer.isView(n)?"arraybufferview":Array.isArray(n)?"array":n instanceof Number?"number":n instanceof Boolean?"boolean":n instanceof Set?"set":n instanceof Map?"map":n instanceof String?"string":n instanceof ArrayBuffer?"arraybuffer":typeof n}function $e(n,e,t){const r=[];let i=null;return $e._encode(r,n),i=Gv(r),$e.bytes=i.length,ArrayBuffer.isView(e)?(e.set(i,t),e):i}$e.bytes=-1;$e._floatConversionDetected=!1;$e._encode=function(n,e){if(e!=null)switch(Qh(e)){case"object":$e.dict(n,e);break;case"map":$e.dictMap(n,e);break;case"array":$e.list(n,e);break;case"set":$e.listSet(n,e);break;case"string":$e.string(n,e);break;case"number":$e.number(n,e);break;case"boolean":$e.number(n,e);break;case"arraybufferview":$e.buffer(n,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":$e.buffer(n,new Uint8Array(e));break}};const ya=new Uint8Array([101]),ey=new Uint8Array([100]),ty=new Uint8Array([108]);$e.buffer=function(n,e){n.push(Xn(e.length+":"),e)};$e.string=function(n,e){n.push(Xn(Xn(e).byteLength+":"+e))};$e.number=function(n,e){if(Number.isInteger(e))return n.push(Xn("i"+BigInt(e)+"e"));const t=2147483648,r=e/t<<0,i=e%t<<0,o=r*t+i;n.push(Xn("i"+o+"e")),o!==e&&!$e._floatConversionDetected&&($e._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+o+'"'),console.trace())};$e.dict=function(n,e){n.push(ey);let t=0,r;const i=Object.keys(e).sort(),o=i.length;for(;t<o;t++)r=i[t],e[r]!=null&&($e.string(n,r),$e._encode(n,e[r]));n.push(ya)};$e.dictMap=function(n,e){n.push(ey);const t=Array.from(e.keys()).sort();for(const r of t)e.get(r)!=null&&(ArrayBuffer.isView(r)?$e._encode(n,r):$e.string(n,String(r)),$e._encode(n,e.get(r)));n.push(ya)};$e.list=function(n,e){let t=0;const r=e.length;for(n.push(ty);t<r;t++)e[t]!=null&&$e._encode(n,e[t]);n.push(ya)};$e.listSet=function(n,e){n.push(ty);for(const t of e)t!=null&&$e._encode(n,t);n.push(ya)};const Zv=105,Qv=58,eE=100,tE=108,Ll=101;function ny(n,e,t){let r=0,i=1;for(let o=e;o<t;o++){const s=n[o];if(s<58&&s>=48){r=r*10+(s-48);continue}if(!(o===e&&s===43)){if(o===e&&s===45){i=-1;continue}if(s===46)break;throw new Error("not a number: buffer["+o+"] = "+s)}}return r*i}function be(n,e,t,r){return n==null||n.length===0?null:(typeof e!="number"&&r==null&&(r=e,e=void 0),typeof t!="number"&&r==null&&(r=t,t=void 0),be.position=0,be.encoding=r||null,be.data=ArrayBuffer.isView(n)?new Uint8Array(n.slice(e,t)):Xn(n),be.bytes=be.data.length,be.next())}be.bytes=0;be.position=0;be.data=null;be.encoding=null;be.next=function(){switch(be.data[be.position]){case eE:return be.dictionary();case tE:return be.list();case Zv:return be.integer();default:return be.buffer()}};be.find=function(n){let e=be.position;const t=be.data.length,r=be.data;for(;e<t;){if(r[e]===n)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(n)+'" [0x'+n.toString(16)+"]")};be.dictionary=function(){be.position++;const n={};for(;be.data[be.position]!==Ll;){const e=be.buffer();let t=Zh(e);t.includes("")&&(t=zv(e)),n[t]=be.next()}return be.position++,n};be.list=function(){be.position++;const n=[];for(;be.data[be.position]!==Ll;)n.push(be.next());return be.position++,n};be.integer=function(){const n=be.find(Ll),e=ny(be.data,be.position+1,n);return be.position+=n+1-be.position,e};be.buffer=function(){let n=be.find(Qv);const e=ny(be.data,be.position,n),t=++n+e;return be.position=t,be.encoding?Zh(be.data.slice(n,t)):be.data.slice(n,t)};function nE(n){let e=2;for(const t of n)e+=jo(t);return e}function rE(n){let e=2;for(const[t,r]of n){const i=Xn(t).byteLength;e+=Fo(i)+1+i,e+=jo(r)}return e}function iE(n){let e=2;const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=Xn(t[r]).byteLength;e+=Fo(i)+1+i,e+=jo(n[t[r]])}return e}function oE(n){const e=Xn(n).byteLength;return Fo(e)+1+e}function sE(n){const e=n.byteLength-n.byteOffset;return Fo(e)+1+e}function jo(n){if(n==null)return 0;const t=Qh(n);switch(t){case"arraybufferview":return sE(n);case"string":return oE(n);case"array":case"set":return nE(n);case"number":return 1+Fo(Math.floor(n))+1;case"bigint":return 1+n.toString().length+1;case"object":return iE(n);case"map":return rE(n);default:throw new TypeError(`Unsupported value of type "${t}"`)}}const aE=jo,_d={encode:$e,decode:be,byteLength:jo,encodingLength:aE},cE=/^(\d{1,3}\.){3,3}\d{1,3}$/,xd=4,lE=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,ws=16,vn={name:"v4",size:xd,isFormat:n=>cE.test(n),encode(n,e,t){t=~~t,e=e||new Uint8Array(t+xd);const r=n.length;let i=0;for(let o=0;o<r;){const s=n.charCodeAt(o++);s===46?(e[t++]=i,i=0):i=i*10+(s-48)}return e[t]=i,e},decode(n,e){return e=~~e,`${n[e++]}.${n[e++]}.${n[e++]}.${n[e]}`}},Er={name:"v6",size:ws,isFormat:n=>n.length>0&&lE.test(n),encode(n,e,t){t=~~t;let r=t+ws,i=-1,o=0,s=0,a=!0,l=!1;e=e||new Uint8Array(t+ws);for(let u=0;u<n.length;u++){let c=n.charCodeAt(u);c===58?(a?i!==-1?(t<r&&(e[t]=0),t<r-1&&(e[t+1]=0),t+=2):t<r&&(i=t):(l===!0?(t<r&&(e[t]=s),t++):(t<r&&(e[t]=o>>8),t<r-1&&(e[t+1]=o&255),t+=2),o=0,s=0),a=!0,l=!1):c===46?(t<r&&(e[t]=s),t++,s=0,o=0,a=!1,l=!0):(a=!1,c>=97?c-=87:c>=65?c-=55:(c-=48,s=s*10+c),o=(o<<4)+c)}if(a===!1)l===!0?(t<r&&(e[t]=s),t++):(t<r&&(e[t]=o>>8),t<r-1&&(e[t+1]=o&255),t+=2);else if(i===0)t<r&&(e[t]=0),t<r-1&&(e[t+1]=0),t+=2;else if(i!==-1){t+=2;for(let u=Math.min(t-1,r-1);u>=i+2;u--)e[u]=e[u-2];e[i]=0,e[i+1]=0,i=t}if(i!==t&&i!==-1)for(t>r-2&&(t=r-2);r>i;)e[--r]=t<r&&t>i?e[--t]:0;else for(;t<r;)e[t++]=0;return e},decode(n,e){e=~~e;let t="";for(let r=0;r<ws;r+=2)r!==0&&(t+=":"),t+=(n[e+r]<<8|n[e+r+1]).toString(16);return t.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function ry(n){if(vn.isFormat(n))return vn.size;if(Er.isFormat(n))return Er.size;throw Error(`Invalid ip address: ${n}`)}function uE(n){return ry(n)===vn.size?1:2}function dE(n,e,t){t=~~t;const r=ry(n);return typeof e=="function"&&(e=e(t+r)),r===vn.size?vn.encode(n,e,t):Er.encode(n,e,t)}function fE(n,e,t){if(e=~~e,t=t||n.length-e,t===vn.size)return vn.decode(n,e,t);if(t===Er.size)return Er.decode(n,e,t);throw Error(`Invalid buffer size needs to be ${vn.size} for v4 or ${Er.size} for v6.`)}function pa(n){switch(n){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+n}function Bo(n){switch(n.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return n.toUpperCase().startsWith("UNKNOWN_")?parseInt(n.slice(8)):0}function hE(n){switch(n){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+n}function yE(n){switch(n){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+n}function iy(n){switch(n){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+n}function oy(n){switch(n.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}function pE(n){switch(n){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return n<0?null:`OPTION_${n}`}function Sd(n){if(typeof n=="number")return n;if(!n)return-1;switch(n.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=n.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}const Cl=55296,Lo=56320;function sy(n){let e=0;const t=n.length;for(let r=0;r<t;r+=1){const i=n.charCodeAt(r);if(i<=127)e+=1;else if(i<=2047)e+=2;else if((i&63488)!==Cl)e+=3;else{const o=r+1;o===t||i>=Lo||(n.charCodeAt(o)&64512)!==Lo?e+=3:(r=o,e+=4)}}return e}function Co(n,e,t){const r=n.length;t==null&&(t=0),e===void 0&&(e=new Uint8Array(sy(n)+t));let i=t;for(let o=0;o<r;o+=1){let s=n.charCodeAt(o);if(s<=127)e[i++]=s;else if(s<=2047)e[i++]=192|(s&1984)>>6,e[i++]=128|s&63;else if((s&63488)!==Cl)e[i++]=224|(s&61440)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63;else{const a=o+1;if(a===r||s>=Lo)e[i++]=239,e[i++]=191,e[i++]=189;else{const l=n.charCodeAt(a);(l&64512)!==Lo?(e[i++]=239,e[i++]=191,e[i++]=189):(o=a,s=65536|(s&1023)<<10|l&1023,e[i++]=240|(s&1835008)>>18,e[i++]=128|(s&258048)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63)}}}return Co.bytes=i-t,e}Co.bytes=0;function Ho(n,e,t){let r="";e==null&&(e=0),t==null&&(t=n.length);for(let i=e;i<t;){const o=n[i++];let s;if(o<=128)s=o;else if(o>191&&o<224)s=(o&31)<<6|n[i++]&63;else if(o>239&&o<365){s=((o&7)<<18|(n[i++]&63)<<12|(n[i++]&63)<<6|n[i++]&63)-65536;const a=Cl|s>>10&1023;r+=String.fromCharCode(a),s=Lo|s&1023}else s=(o&15)<<12|(n[i++]&63)<<6|n[i++]&63;r+=String.fromCharCode(s)}return Ho.bytes=t-e,r}Ho.bytes=0;const ii=n=>n instanceof Uint8Array;function Ir(n){return typeof n=="string"?sy(n):n.byteLength}function $l(n){return n instanceof Uint8Array?n:Array.isArray(n)?new Uint8Array(n):Co(n)}function Ul(n,e,t){if(typeof e!="string")throw new Error("unknown input type");return Co(e,n,t),Co.bytes}const bo={},ay=new Array(255);for(let n=0;n<=15;n+=1){const e=n.toString(16),t=e.toUpperCase();for(let r=0;r<=15;r+=1){const i=r.toString(16),o=i.toUpperCase(),s=n<<4|r,a=`${e}${i}`;ay[s]=a,bo[a]=s,bo[`${t}${i}`]=s,bo[`${e}${o}`]=s,bo[`${t}${o}`]=s}}function gE(n,e,t){let r="";for(let i=e;i<t;){const o=n[i++];r+=ay[o]}return r}function Ad(n){return n.length>>>1}function wE(n,e,t,r){let i=0;for(;t<r;){const o=e.substr(i,2),s=bo[o];if(s===void 0)return;n[t++]=s,i+=2}return n}const bE=Math.pow(2,24),mE=Math.pow(2,16),vE=Math.pow(2,8),Wn=(n,e)=>n[e]*bE+n[e+1]*mE+n[e+2]*vE+n[e+3],Ae=(n,e)=>n[e]<<8|n[e+1],qn=(n,e,t)=>(e=+e,n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e,t+4),we=(n,e,t)=>(n[t]=e>>8,n[t+1]=e&255,t+2);function Yt(n,e,t,r,i){return t<0&&(r-=t,t=0),r<0&&(r=0),i<0?new Uint8Array(0):t>=e.length||r>=i?0:EE(n,e,t,r,i)}function EE(n,e,t,r,i){i-r>e.length-t&&(i=r+e.length-t);let o=i-r;const s=n.length-r;return o>s&&(o=s),(r!==0||i<n.length)&&(n=new Uint8Array(n.buffer,n.byteOffset+r,o)),e.set(n,t),o}const _E=0,Td=32768,Fc=32768,xE=~Fc,cy=32768,SE=~cy;function je({bytes:n=0,encode:e,decode:t,encodingLength:r}){return e.bytes=n,t.bytes=n,{encode:e,decode:t,encodingLength:r||(()=>n)}}const ce=je({encode(n,e,t){e||(e=new Uint8Array(ce.encodingLength(n))),t||(t=0);const r=t,i=n.replace(/^\.|\.$/gm,"");if(i.length){const o=i.split(".");for(let s=0;s<o.length;s++){const a=Ul(e,o[s],t+1);e[t]=a,t+=a+1}}return e[t++]=0,ce.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=[];let r=e,i=0,o=0,s=!1;for(;;){if(e>=n.length)throw new Error("Cannot decode name (buffer overflow)");const a=n[e++];if(o+=s?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>n.length)throw new Error("Cannot decode name (buffer overflow)");const l=Ae(n,e-1)-49152;if(l>=r)throw new Error("Cannot decode name (bad pointer)");e=l,r=l,o+=s?0:1,s=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>n.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=a+1,i>254)throw new Error("Cannot decode name (name too long)");t.push(Ho(n,e,e+a)),e+=a,o+=s?0:a}}return ce.decode.bytes=o,t.length===0?".":t.join(".")},encodingLength(n){return n==="."||n===".."?1:Ir(n.replace(/^\.|\.$/gm,""))+2}}),ct=je({encode(n,e,t){e||(e=new Uint8Array(ct.encodingLength(n))),t||(t=0);const r=Ul(e,n,t+1);return e[t]=r,ct.encode.bytes=r+1,e},decode(n,e){e||(e=0);const t=n[e],r=Ho(n,e+1,e+1+t);return ct.decode.bytes=t+1,r},encodingLength(n){return Ir(n)+1}}),Ai=je({bytes:12,encode(n,e,t){e||(e=new Uint8Array(Ai.encodingLength(n))),t||(t=0);const r=(n.flags||0)&32767,i=n.type==="response"?Td:_E;return we(e,n.id||0,t),we(e,r|i,t+2),we(e,n.questions.length,t+4),we(e,n.answers.length,t+6),we(e,n.authorities.length,t+8),we(e,n.additionals.length,t+10),e},decode(n,e){if(e||(e=0),n.length<12)throw new Error("Header must be 12 bytes");const t=Ae(n,e+2);return{id:Ae(n,e),type:t&Td?"response":"query",flags:t&32767,flag_qr:(t>>15&1)===1,opcode:yE(t>>11&15),flag_aa:(t>>10&1)===1,flag_tc:(t>>9&1)===1,flag_rd:(t>>8&1)===1,flag_ra:(t>>7&1)===1,flag_z:(t>>6&1)===1,flag_ad:(t>>5&1)===1,flag_cd:(t>>4&1)===1,rcode:hE(t&15),questions:new Array(Ae(n,e+4)),answers:new Array(Ae(n,e+6)),authorities:new Array(Ae(n,e+8)),additionals:new Array(Ae(n,e+10))}},encodingLength(){return 12}}),Rs=je({encode(n,e,t){e||(e=new Uint8Array(Rs.encodingLength(n))),t||(t=0);const r=n.length;return we(e,r,t),Yt(n,e,t+2,0,r),Rs.encode.bytes=r+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r=n.slice(e+2,e+2+t);return Rs.decode.bytes=t+2,r},encodingLength(n){return n.length+2}}),Os=je({encode(n,e,t){return e||(e=new Uint8Array(Os.encodingLength(n))),t||(t=0),ce.encode(n,e,t+2),we(e,ce.encode.bytes,t),Os.encode.bytes=ce.encode.bytes+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r=ce.decode(n,e+2);return Os.decode.bytes=t+2,r},encodingLength(n){return ce.encodingLength(n)+2}}),ks=je({encode(n,e,t){e||(e=new Uint8Array(ks.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.mname,e,t),t+=ce.encode.bytes,ce.encode(n.rname,e,t),t+=ce.encode.bytes,qn(e,n.serial||0,t),t+=4,qn(e,n.refresh||0,t),t+=4,qn(e,n.retry||0,t),t+=4,qn(e,n.expire||0,t),t+=4,qn(e,n.minimum||0,t),t+=4,we(e,t-r-2,r),ks.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.mname=ce.decode(n,e),e+=ce.decode.bytes,r.rname=ce.decode(n,e),e+=ce.decode.bytes,r.serial=Wn(n,e),e+=4,r.refresh=Wn(n,e),e+=4,r.retry=Wn(n,e),e+=4,r.expire=Wn(n,e),e+=4,r.minimum=Wn(n,e),e+=4,ks.decode.bytes=e-t,r},encodingLength(n){return 22+ce.encodingLength(n.mname)+ce.encodingLength(n.rname)}}),Bs=je({encode(n,e,t){Array.isArray(n)||(n=[n]);for(let i=0;i<n.length;i++)if(typeof n[i]=="string"&&(n[i]=$l(n[i])),!ii(n[i]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(Bs.encodingLength(n))),t||(t=0);const r=t;return t+=2,n.forEach(function(i){e[t++]=i.length,Yt(i,e,t,0,i.length),t+=i.length}),we(e,t-r-2,r),Bs.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e;let r=Ae(n,e);e+=2;const i=[];for(;r>0;){const o=n[e++];if(--r,r<o)throw new Error("Buffer overflow");i.push(n.slice(e,e+o)),e+=o,r-=o}return Bs.decode.bytes=e-t,i},encodingLength(n){Array.isArray(n)||(n=[n]);let e=2;return n.forEach(function(t){typeof t=="string"?e+=Ir(t)+1:e+=t.length+1}),e}}),Ls=je({encode(n,e,t){e||(e=new Uint8Array(Ls.encodingLength(n))),t||(t=0),typeof n=="string"&&(n=$l(n)),n||(n=new Uint8Array(0));const r=t;t+=2;const i=n.length;return Yt(n,e,t,0,i),t+=i,we(e,t-r-2,r),Ls.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r=Ae(n,e);e+=2;const i=n.slice(e,e+r);return e+=r,Ls.decode.bytes=e-t,i},encodingLength(n){return n?(ii(n)?n.length:Ir(n))+2:2}}),Cs=je({encode(n,e,t){e||(e=new Uint8Array(Cs.encodingLength(n))),t||(t=0);const r=t;return t+=2,ct.encode(n.cpu,e,t),t+=ct.encode.bytes,ct.encode(n.os,e,t),t+=ct.encode.bytes,we(e,t-r-2,r),Cs.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.cpu=ct.decode(n,e),e+=ct.decode.bytes,r.os=ct.decode(n,e),e+=ct.decode.bytes,Cs.decode.bytes=e-t,r},encodingLength(n){return ct.encodingLength(n.cpu)+ct.encodingLength(n.os)+2}}),Ci=je({encode(n,e,t){return e||(e=new Uint8Array(Ci.encodingLength(n))),t||(t=0),ce.encode(n,e,t+2),we(e,ce.encode.bytes,t),Ci.encode.bytes=ce.encode.bytes+2,e},decode(n,e){e||(e=0);const t=ce.decode(n,e+2);return Ci.decode.bytes=ce.decode.bytes+2,t},encodingLength(n){return ce.encodingLength(n)+2}}),$s=je({encode(n,e,t){e||(e=new Uint8Array($s.encodingLength(n))),t||(t=0),we(e,n.priority||0,t+2),we(e,n.weight||0,t+4),we(e,n.port||0,t+6),ce.encode(n.target,e,t+8);const r=ce.encode.bytes+6;return we(e,r,t),$s.encode.bytes=r+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r={};return r.priority=Ae(n,e+2),r.weight=Ae(n,e+4),r.port=Ae(n,e+6),r.target=ce.decode(n,e+8),$s.decode.bytes=t+2,r},encodingLength(n){return 8+ce.encodingLength(n.target)}}),pr=je({encode(n,e,t){const r=pr.encodingLength(n);return e||(e=new Uint8Array(pr.encodingLength(n))),t||(t=0),n.issuerCritical&&(n.flags=pr.ISSUER_CRITICAL),we(e,r-2,t),t+=2,e[t]=n.flags||0,t+=1,ct.encode(n.tag,e,t),t+=ct.encode.bytes,Ul(e,n.value,t),t+=Ir(n.value),pr.encode.bytes=r,e},decode(n,e){e||(e=0);const t=Ae(n,e);e+=2;const r=e,i={};return i.flags=n[e],e+=1,i.tag=ct.decode(n,e),e+=ct.decode.bytes,i.value=Ho(n,e,r+t),i.issuerCritical=!!(i.flags&pr.ISSUER_CRITICAL),pr.decode.bytes=t+2,i},encodingLength(n){return ct.encodingLength(n.tag)+ct.encodingLength(n.value)+2}});pr.ISSUER_CRITICAL=128;const Us=je({encode(n,e,t){e||(e=new Uint8Array(Us.encodingLength(n))),t||(t=0);const r=t;return t+=2,we(e,n.preference||0,t),t+=2,ce.encode(n.exchange,e,t),t+=ce.encode.bytes,we(e,t-r-2,r),Us.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.preference=Ae(n,e),e+=2,r.exchange=ce.decode(n,e),e+=ce.decode.bytes,Us.decode.bytes=e-t,r},encodingLength(n){return 4+ce.encodingLength(n.exchange)}}),ly=je({encode(n,e,t){return e||(e=new Uint8Array(ly.encodingLength(n))),t||(t=0),we(e,4,t),t+=2,vn.encode(n,e,t),e},decode(n,e){return e||(e=0),e+=2,vn.decode(n,e)},bytes:6}),Ns=je({encode(n,e,t){return e||(e=new Uint8Array(Ns.encodingLength(n))),t||(t=0),we(e,16,t),t+=2,Er.encode(n,e,t),Ns.encode.bytes=18,e},decode(n,e){e||(e=0),e+=2;const t=Er.decode(n,e);return Ns.decode.bytes=18,t},bytes:18}),AE=n=>new Uint8Array(n),Fn=je({encode(n,e,t){e||(e=new Uint8Array(Fn.encodingLength(n))),t||(t=0);const r=t,i=Sd(n.code);if(we(e,i,t),t+=2,n.data)we(e,n.data.length,t),t+=2,Yt(n.data,e,t),t+=n.data.length;else switch(i){case 8:{const o=n.sourcePrefixLength||0,s=n.family||uE(n.ip),a=dE(n.ip,AE),l=Math.ceil(o/8);we(e,l+4,t),t+=2,we(e,s,t),t+=2,e[t++]=o,e[t++]=n.scopePrefixLength||0,Yt(a,e,t,0,l),t+=l}break;case 11:n.timeout?(we(e,2,t),t+=2,we(e,n.timeout,t),t+=2):(we(e,0,t),t+=2);break;case 12:{const o=n.length||0;we(e,o,t),t+=2,e.fill(0,t,t+o),t+=o}break;case 14:{const o=n.tags.length*2;we(e,o,t),t+=2;for(const s of n.tags)we(e,s,t),t+=2}break;default:throw new Error(`Unknown roption code: ${n.code}`)}return Fn.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t={};t.code=Ae(n,e),t.type=pE(t.code),e+=2;const r=Ae(n,e);switch(e+=2,t.data=n.slice(e,e+r),t.code){case 8:t.family=Ae(n,e),e+=2,t.sourcePrefixLength=n[e++],t.scopePrefixLength=n[e++];{const i=new Uint8Array(t.family===1?4:16);Yt(n,i,0,e,e+r-4),t.ip=fE(i)}break;case 11:r>0&&(t.timeout=Ae(n,e),e+=2);break;case 14:t.tags=[];for(let i=0;i<r;i+=2)t.tags.push(Ae(n,e)),e+=2}return Fn.decode.bytes=r+4,t},encodingLength(n){if(n.data)return n.data.length+4;switch(Sd(n.code)){case 8:{const t=n.sourcePrefixLength||0;return Math.ceil(t/8)+8}case 11:return typeof n.timeout=="number"?6:4;case 12:return n.length+4;case 14:return 4+n.tags.length*2}throw new Error(`Unknown roption code: ${n.code}`)}}),wr=je({encode(n,e,t){e||(e=new Uint8Array(wr.encodingLength(n))),t||(t=0);const r=t,i=Ii(n,Fn);return we(e,i,t),t=So(n,Fn,e,t+2),wr.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r=[];let i=Ae(n,e);e+=2;let o=0;for(;i>0;)r[o++]=Fn.decode(n,e),e+=Fn.decode.bytes,i-=Fn.decode.bytes;return wr.decode.bytes=e-t,r},encodingLength(n){return 2+Ii(n||[],Fn)}}),pn=je({encode(n,e,t){e||(e=new Uint8Array(pn.encodingLength(n))),t||(t=0);const r=t,i=n.key;if(!ii(i))throw new Error("Key must be a Buffer");return t+=2,we(e,n.flags,t),t+=2,e[t]=pn.PROTOCOL_DNSSEC,t+=1,e[t]=n.algorithm,t+=1,Yt(i,e,t,0,i.length),t+=i.length,pn.encode.bytes=t-r,we(e,pn.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);if(e+=2,r.flags=Ae(n,e),e+=2,n[e]!==pn.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,r.algorithm=n[e],e+=1,r.key=n.slice(e,t+i+2),e+=r.key.length,pn.decode.bytes=e-t,r},encodingLength(n){return 6+Ir(n.key)}});pn.PROTOCOL_DNSSEC=3;pn.ZONE_KEY=128;pn.SECURE_ENTRYPOINT=32768;const mo=je({encode(n,e,t){e||(e=new Uint8Array(mo.encodingLength(n))),t||(t=0);const r=t,i=n.signature;if(!ii(i))throw new Error("Signature must be a Buffer");return t+=2,we(e,Bo(n.typeCovered),t),t+=2,e[t]=n.algorithm,t+=1,e[t]=n.labels,t+=1,qn(e,n.originalTTL,t),t+=4,qn(e,n.expiration,t),t+=4,qn(e,n.inception,t),t+=4,we(e,n.keyTag,t),t+=2,ce.encode(n.signersName,e,t),t+=ce.encode.bytes,Yt(i,e,t,0,i.length),t+=i.length,mo.encode.bytes=t-r,we(e,mo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.typeCovered=pa(Ae(n,e)),e+=2,r.algorithm=n[e],e+=1,r.labels=n[e],e+=1,r.originalTTL=Wn(n,e),e+=4,r.expiration=Wn(n,e),e+=4,r.inception=Wn(n,e),e+=4,r.keyTag=Ae(n,e),e+=2,r.signersName=ce.decode(n,e),e+=ce.decode.bytes,r.signature=n.slice(e,t+i+2),e+=r.signature.length,mo.decode.bytes=e-t,r},encodingLength(n){return 20+ce.encodingLength(n.signersName)+Ir(n.signature)}}),vo=je({encode(n,e,t){e||(e=new Uint8Array(vo.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.mbox||".",e,t),t+=ce.encode.bytes,ce.encode(n.txt||".",e,t),t+=ce.encode.bytes,vo.encode.bytes=t-r,we(e,vo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.mbox=ce.decode(n,e)||".",e+=ce.decode.bytes,r.txt=ce.decode(n,e)||".",e+=ce.decode.bytes,vo.decode.bytes=e-t,r},encodingLength(n){return 2+ce.encodingLength(n.mbox||".")+ce.encodingLength(n.txt||".")}}),Nt=je({encode(n,e,t){e||(e=new Uint8Array(Nt.encodingLength(n))),t||(t=0);const r=t,i=[];for(let o=0;o<n.length;o++){const s=Bo(n[o]);i[s>>8]===void 0&&(i[s>>8]=[]),i[s>>8][s>>3&31]|=1<<7-(s&7)}for(let o=0;o<i.length;o++)if(i[o]!==void 0){const s=$l(i[o]);e[t]=o,t+=1,e[t]=s.length,t+=1,Yt(s,e,t,0,s.length),t+=s.length}return Nt.encode.bytes=t-r,e},decode(n,e,t){e||(e=0);const r=e,i=[];for(;e-r<t;){const o=n[e];e+=1;const s=n[e];e+=1;for(let a=0;a<s;a++){const l=n[e+a];for(let u=0;u<8;u++)if(l&1<<7-u){const c=pa(o<<8|a<<3|u);i.push(c)}}e+=s}return Nt.decode.bytes=e-r,i},encodingLength(n){const e=[];for(let r=0;r<n.length;r++){const i=Bo(n[r]);e[i>>8]=Math.max(e[i>>8]||0,i&255)}let t=0;for(let r=0;r<e.length;r++)e[r]!==void 0&&(t+=2+Math.ceil((e[r]+1)/8));return t}}),Eo=je({encode(n,e,t){e||(e=new Uint8Array(Eo.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.nextDomain,e,t),t+=ce.encode.bytes,Nt.encode(n.rrtypes,e,t),t+=Nt.encode.bytes,Eo.encode.bytes=t-r,we(e,Eo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.nextDomain=ce.decode(n,e),e+=ce.decode.bytes,r.rrtypes=Nt.decode(n,e,i-(e-t)),e+=Nt.decode.bytes,Eo.decode.bytes=e-t,r},encodingLength(n){return 2+ce.encodingLength(n.nextDomain)+Nt.encodingLength(n.rrtypes)}}),_o=je({encode(n,e,t){e||(e=new Uint8Array(_o.encodingLength(n))),t||(t=0);const r=t,i=n.salt;if(!ii(i))throw new Error("salt must be a Buffer");const o=n.nextDomain;if(!ii(o))throw new Error("nextDomain must be a Buffer");return t+=2,e[t]=n.algorithm,t+=1,e[t]=n.flags,t+=1,we(e,n.iterations,t),t+=2,e[t]=i.length,t+=1,Yt(i,e,t,0,i.length),t+=i.length,e[t]=o.length,t+=1,Yt(o,e,t,0,o.length),t+=o.length,Nt.encode(n.rrtypes,e,t),t+=Nt.encode.bytes,_o.encode.bytes=t-r,we(e,_o.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);e+=2,r.algorithm=n[e],e+=1,r.flags=n[e],e+=1,r.iterations=Ae(n,e),e+=2;const o=n[e];e+=1,r.salt=n.slice(e,e+o),e+=o;const s=n[e];return e+=1,r.nextDomain=n.slice(e,e+s),e+=s,r.rrtypes=Nt.decode(n,e,i-(e-t)),e+=Nt.decode.bytes,_o.decode.bytes=e-t,r},encodingLength(n){return 8+n.salt.length+n.nextDomain.length+Nt.encodingLength(n.rrtypes)}}),xo=je({encode(n,e,t){e||(e=new Uint8Array(xo.encodingLength(n))),t||(t=0);const r=t,i=n.digest;if(!ii(i))throw new Error("Digest must be a Buffer");return t+=2,we(e,n.keyTag,t),t+=2,e[t]=n.algorithm,t+=1,e[t]=n.digestType,t+=1,Yt(i,e,t,0,i.length),t+=i.length,xo.encode.bytes=t-r,we(e,xo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.keyTag=Ae(n,e),e+=2,r.algorithm=n[e],e+=1,r.digestType=n[e],e+=1,r.digest=n.slice(e,t+i+2),e+=r.digest.length,xo.decode.bytes=e-t,r},encodingLength(n){return 6+Ir(n.digest)}}),Ti=je({encode(n,e,t){e||(e=new Uint8Array(Ti.encodingLength(n))),t||(t=0);const r=t;t+=2,e[t]=n.algorithm,t+=1,e[t]=n.hash,t+=1;const i=Ad(n.fingerprint),o=jc(n.hash);if(i!==o)throw new Error(`Invalid length of fingerprint "${n.fingerprint}" for hashType=${n.hash}: ${i} != ${o}`);return wE(e,n.fingerprint,t,t+=i),Ti.encode.bytes=t-r,we(e,Ti.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={};e+=2,r.algorithm=n[e],e+=1,r.hash=n[e],e+=1;const i=jc(r.hash);return r.fingerprint=gE(n,e,e+i),e+=i,Ti.decode.bytes=e-t,r},encodingLength(n){return 4+Ad(n.fingerprint)}});function jc(n){if(n===1)return 20;if(n===2)return 32;throw new Error(`Invalid hashType=${n}, supported=1,2`)}Ti.getFingerprintLengthForHashType=jc;function dc(n){switch(n.toUpperCase()){case"A":return ly;case"PTR":return Ci;case"CNAME":return Ci;case"DNAME":return Ci;case"TXT":return Bs;case"NULL":return Ls;case"AAAA":return Ns;case"SRV":return $s;case"HINFO":return Cs;case"CAA":return pr;case"NS":return Os;case"SOA":return ks;case"MX":return Us;case"OPT":return wr;case"DNSKEY":return pn;case"RRSIG":return mo;case"RP":return vo;case"NSEC":return Eo;case"NSEC3":return _o;case"SSHFP":return Ti;case"DS":return xo}return Rs}const Vt=je({encode(n,e,t){e||(e=new Uint8Array(Vt.encodingLength(n))),t||(t=0);const r=t;if(ce.encode(n.name,e,t),t+=ce.encode.bytes,we(e,Bo(n.type),t),n.type.toUpperCase()==="OPT"){if(n.name!==".")throw new Error("OPT name must be root.");we(e,n.udpPayloadSize||4096,t+2),e[t+4]=n.extendedRcode||0,e[t+5]=n.ednsVersion||0,we(e,n.flags||0,t+6),t+=8,wr.encode(n.options||[],e,t),t+=wr.encode.bytes}else{let i=oy(n.class===void 0?"IN":n.class);n.flush&&(i|=Fc),we(e,i,t+2),qn(e,n.ttl||0,t+4),t+=8;const o=dc(n.type);o.encode(n.data,e,t),t+=o.encode.bytes}return Vt.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t={},r=e;if(t.name=ce.decode(n,e),e+=ce.decode.bytes,t.type=pa(Ae(n,e)),t.type==="OPT")t.udpPayloadSize=Ae(n,e+2),t.extendedRcode=n[e+4],t.ednsVersion=n[e+5],t.flags=Ae(n,e+6),t.flag_do=(t.flags>>15&1)===1,t.options=wr.decode(n,e+8),e+=8+wr.decode.bytes;else{const i=Ae(n,e+2);t.ttl=Wn(n,e+4),t.class=iy(i&xE),t.flush=!!(i&Fc);const o=dc(t.type);t.data=o.decode(n,e+8),e+=8+o.decode.bytes}return Vt.decode.bytes=e-r,t},encodingLength(n){const e=n.data!==null&&n.data!==void 0?n.data:n.options;return ce.encodingLength(n.name)+8+dc(n.type).encodingLength(e)}}),$i=je({encode(n,e,t){e||(e=new Uint8Array($i.encodingLength(n))),t||(t=0);const r=t;return ce.encode(n.name,e,t),t+=ce.encode.bytes,we(e,Bo(n.type),t),t+=2,we(e,oy(n.class===void 0?"IN":n.class),t),t+=2,$i.encode.bytes=t-r,n},decode(n,e){e||(e=0);const t=e,r={};return r.name=ce.decode(n,e),e+=ce.decode.bytes,r.type=pa(Ae(n,e)),e+=2,r.class=iy(Ae(n,e)),e+=2,!!(r.class&cy)&&(r.class&=SE),$i.decode.bytes=e-t,r},encodingLength(n){return ce.encodingLength(n.name)+4}}),TE=1024,oi={encode:function(n,e,t){const r=!e;r&&(e=new Uint8Array(RE(n))),t||(t=0);const i=t;return n.questions||(n.questions=[]),n.answers||(n.answers=[]),n.authorities||(n.authorities=[]),n.additionals||(n.additionals=[]),Ai.encode(n,e,t),t+=Ai.encode.bytes,t=So(n.questions,$i,e,t),t=So(n.answers,Vt,e,t),t=So(n.authorities,Vt,e,t),t=So(n.additionals,Vt,e,t),oi.encode.bytes=t-i,r&&Hc.bytes!==e.length?e.slice(0,Hc.bytes):e},decode:function(n,e){e||(e=0);const t=e,r=Ai.decode(n,e);return e+=Ai.decode.bytes,e=bs(r.questions,$i,n,e),e=bs(r.answers,Vt,n,e),e=bs(r.authorities,Vt,n,e),e=bs(r.additionals,Vt,n,e),oi.decode.bytes=e-t,r},encodingLength:function(n){return Ai.encodingLength(n)+Ii(n.questions||[],$i)+Ii(n.answers||[],Vt)+Ii(n.authorities||[],Vt)+Ii(n.additionals||[],Vt)}};oi.encode.bytes=0;oi.decode.bytes=0;const Hc=oi.encode,IE=oi.decode,RE=oi.encodingLength;function Ii(n,e){let t=0;for(let r=0;r<n.length;r++)t+=e.encodingLength(n[r]);return t}function So(n,e,t,r){for(let i=0;i<n.length;i++)e.encode(n[i],t,r),r+=e.encode.bytes;return r}function bs(n,e,t,r){for(let i=0;i<n.length;i++)n[i]=e.decode(t,r),r+=e.decode.bytes;return r}var Id=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Vo{static getSigningMethod(e){return Id(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,t){return Id(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}}var ft=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Rd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Od="https://diddht.tbddev.org",OE=0,hr=7200,Ds=";",_t=",";var Vc;(function(n){n[n.Discoverable=0]="Discoverable",n[n.Organization=1]="Organization",n[n.Government=2]="Government",n[n.Corporation=3]="Corporation",n[n.LocalBusiness=4]="LocalBusiness",n[n.SoftwarePackage=5]="SoftwarePackage",n[n.WebApp=6]="WebApp",n[n.FinancialInstitution=7]="FinancialInstitution"})(Vc||(Vc={}));var xt;(function(n){n[n.Ed25519=0]="Ed25519",n[n.secp256k1=1]="secp256k1",n[n.secp256r1=2]="secp256r1",n[n.X25519=3]="X25519"})(xt||(xt={}));var Wc;(function(n){n.authentication="auth",n.assertionMethod="asm",n.capabilityDelegation="del",n.capabilityInvocation="inv",n.keyAgreement="agm"})(Wc||(Wc={}));const uy={Ed25519:xt.Ed25519,ES256K:xt.secp256k1,ES256:xt.secp256r1,"P-256":xt.secp256r1,secp256k1:xt.secp256k1,secp256r1:xt.secp256r1,X25519:xt.X25519},kd={[xt.Ed25519]:"EdDSA",[xt.secp256k1]:"ES256K",[xt.secp256r1]:"ES256",[xt.X25519]:"ECDH-ES+A256KW"};class si extends Vo{static create(){return ft(this,arguments,void 0,function*({keyManager:e=new Jn,options:t={}}={}){var r,i,o,s,a,l,u,c,h,p,w;if(!((r=t.verificationMethods)===null||r===void 0)&&r.some(A=>!(A.algorithm in uy)))throw new Error("One or more verification method algorithms are not supported");const x=(i=t.verificationMethods)===null||i===void 0?void 0:i.filter(A=>"id"in A).map(A=>A.id);if(x&&x.length!==new Set(x).size)throw new Error("One or more verification method IDs are not unique");if(!((o=t.services)===null||o===void 0)&&o.some(A=>!A.id||!A.type||!A.serviceEndpoint))throw new Error("One or more services are missing required properties");const g=yield e.generateKey({algorithm:"Ed25519"}),R=yield e.getPublicKey({keyUri:g}),L=yield st.identityKeyToIdentifier({identityKey:R}),$=Object.assign(Object.assign({id:L},t.alsoKnownAs&&{alsoKnownAs:t.alsoKnownAs}),t.controllers&&{controller:t.controllers}),E=[...(s=t.verificationMethods)!==null&&s!==void 0?s:[]];E!=null&&E.some(A=>{var U;return((U=A.id)===null||U===void 0?void 0:U.split("#").pop())==="0"})||E.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const A of E){const U=A.id&&A.id.split("#").pop()==="0"?g:yield e.generateKey({algorithm:A.algorithm}),H=yield e.getPublicKey({keyUri:U});let W=(l=(a=A.id)!==null&&a!==void 0?a:H.kid)!==null&&l!==void 0?l:yield Pe({jwk:H});W=`${L}#${nn(W)}`,(u=$.verificationMethod)!==null&&u!==void 0||($.verificationMethod=[]),$.verificationMethod.push({id:W,type:"JsonWebKey",controller:(c=A.controller)!==null&&c!==void 0?c:L,publicKeyJwk:H});for(const ee of(h=A.purposes)!==null&&h!==void 0?h:[])$[ee]||($[ee]=[]),$[ee].push(W)}(p=t.services)===null||p===void 0||p.forEach(A=>{var U;(U=$.service)!==null&&U!==void 0||($.service=[]),A.id=`${L}#${A.id.split("#").pop()}`,$.service.push(A)});const I=new An({uri:L,document:$,metadata:Object.assign({published:!1},t.types&&{types:t.types}),keyManager:e});if(!((w=t.publish)!==null&&w!==void 0)||w){const A=yield si.publish({did:I,gatewayUri:t.gatewayUri});I.metadata=A.didDocumentMetadata}return I})}static import(e){return ft(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Jn}){var i;const o=Be.parse(t.uri);if((o==null?void 0:o.method)!==si.methodName)throw new ye(fe.MethodNotSupported,"Method not supported");const s=yield An.import({portableDid:t,keyManager:r});if(!(!((i=s.document.verificationMethod)===null||i===void 0)&&i.some(a=>{var l;return((l=a.id)===null||l===void 0?void 0:l.split("#").pop())==="0"})))throw new ye(fe.InvalidDidDocument,"DID document must contain an Identity Key");return s})}static getSigningMethod(e){return ft(this,arguments,void 0,function*({didDocument:t,methodId:r="#0"}){var i;const o=Be.parse(t.id);if(o&&o.method!==this.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${o.method}`);const s=(i=t.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var l,u;return nn(a.id)===((l=nn(r))!==null&&l!==void 0?l:nn((u=t.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(s&&s.publicKeyJwk))throw new ye(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static publish(e){return ft(this,arguments,void 0,function*({did:t,gatewayUri:r=Od}){return yield jn.put({did:t,gatewayUri:r})})}static resolve(e){return ft(this,arguments,void 0,function*(t,r={}){var i;const o=(i=r==null?void 0:r.gatewayUri)!==null&&i!==void 0?i:Od;try{yield st.identifierToIdentityKey({didUri:t});const{didDocument:s,didDocumentMetadata:a}=yield jn.get({didUri:t,gatewayUri:o});return Object.assign(Object.assign({},gt),{didDocument:s,didDocumentMetadata:a})}catch(s){if(!(s instanceof ye))throw new Error(s);return Object.assign(Object.assign({},gt),{didResolutionMetadata:Object.assign({error:s.code},s.message&&{errorMessage:s.message})})}})}}si.methodName="dht";class jn{static get(e){return ft(this,arguments,void 0,function*({didUri:t,gatewayUri:r}){const i=st.identifierToIdentityKeyBytes({didUri:t}),o=yield jn.pkarrGet({gatewayUri:r,publicKeyBytes:i}),s=yield st.parseBep44GetMessage({bep44Message:o}),a=yield jn.fromDnsPacket({didUri:t,dnsPacket:s});return a.didDocumentMetadata.versionId=o.seq.toString(),a})}static put(e){return ft(this,arguments,void 0,function*({did:t,gatewayUri:r}){const i=yield jn.toDnsPacket({didDocument:t.document,didMetadata:t.metadata,authoritativeGatewayUris:[r]}),o=yield st.createBep44PutMessage({dnsPacket:i,publicKeyBytes:st.identifierToIdentityKeyBytes({didUri:t.uri}),signer:yield t.getSigner({methodId:"0"})}),s=yield jn.pkarrPut({gatewayUri:r,bep44Message:o});return{didDocument:t.document,didDocumentMetadata:Object.assign(Object.assign({},t.metadata),{published:s,versionId:o.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ft(this,arguments,void 0,function*({gatewayUri:t,publicKeyBytes:r}){const i=oe.uint8Array(r).toBase32Z(),o=new URL(i,t).href;let s;try{if(s=yield fetch(o,{method:"GET"}),!s.ok)throw new ye(fe.NotFound,`Pkarr record not found for: ${i}`)}catch(u){throw u instanceof ye?u:new ye(fe.InternalError,`Failed to fetch Pkarr record: ${u.message}`)}const a=yield s.arrayBuffer();if(!a)throw new ye(fe.NotFound,`Pkarr record not found for: ${i}`);if(a.byteLength<72)throw new ye(fe.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new ye(fe.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:r,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ft(this,arguments,void 0,function*({gatewayUri:t,bep44Message:r}){const i=oe.uint8Array(r.k).toBase32Z(),o=new URL(i,t).href,s=new Uint8Array(r.v.length+72);s.set(r.sig,0),new DataView(s.buffer).setBigUint64(r.sig.length,BigInt(r.seq)),s.set(r.v,r.sig.length+8);let a;try{a=yield fetch(o,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:s})}catch(l){throw new ye(fe.InternalError,`Failed to put Pkarr record for identifier ${i}: ${l.message}`)}return a.ok})}static fromDnsPacket(e){return ft(this,arguments,void 0,function*({didUri:t,dnsPacket:r}){var i,o,s;const a={id:t},l={published:!0},u=new Map;for(const c of(i=r==null?void 0:r.answers)!==null&&i!==void 0?i:[]){if(c.type!=="TXT")continue;const h=c.name.split(".")[0].substring(1);switch(!0){case h.startsWith("aka"):{const p=st.parseTxtDataToString(c.data);a.alsoKnownAs=p.split(_t);break}case h.startsWith("cnt"):{const p=st.parseTxtDataToString(c.data);a.controller=p.includes(_t)?p.split(_t):p;break}case h.startsWith("k"):{const{id:p,t:w,k:x,c:g,a:R}=st.parseTxtDataToObject(c.data),L=oe.base64Url(x).toUint8Array(),$=xt[Number(w)];let E=yield st.keyConverter($).bytesToPublicKey({publicKeyBytes:L});E.alg=R||kd[Number(w)];const I=h==="k0"?"0":p!==void 0?p:yield Pe({jwk:E});(o=a.verificationMethod)!==null&&o!==void 0||(a.verificationMethod=[]);const A=`${t}#${I}`;a.verificationMethod.push({id:A,type:"JsonWebKey",controller:g??t,publicKeyJwk:E}),u.set(h,A);break}case h.startsWith("s"):{const p=st.parseTxtDataToObject(c.data),{id:w,t:x,se:g}=p,R=Rd(p,["id","t","se"]),L=g.includes(_t)?g.split(_t):[g],$=Object.fromEntries(Object.entries(R).map(([E,I])=>[E,I.includes(_t)?I.split(_t):I]));(s=a.service)!==null&&s!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},$),{id:`${t}#${w}`,type:x,serviceEndpoint:L}));break}case h.startsWith("typ"):{const{id:p}=st.parseTxtDataToObject(c.data);l.types=p.split(_t).map(w=>Number(w));break}case h.startsWith("did"):{const p=$=>$.split(_t).map(E=>u.get(E)).filter(E=>typeof E=="string"),{auth:w,asm:x,del:g,inv:R,agm:L}=st.parseTxtDataToObject(c.data);w&&(a.authentication=p(w)),x&&(a.assertionMethod=p(x)),g&&(a.capabilityDelegation=p(g)),R&&(a.capabilityInvocation=p(R)),L&&(a.keyAgreement=p(L));break}}}return{didDocument:a,didDocumentMetadata:l,didResolutionMetadata:{}}})}static toDnsPacket(e){return ft(this,arguments,void 0,function*({didDocument:t,didMetadata:r,authoritativeGatewayUris:i,previousDidProof:o}){var s,a,l,u,c;const h=[],p=[],w=new Map,x=[],g=[];if(o!==void 0){const{signature:$,previousDid:E}=o;yield st.validatePreviousDidProof({newDid:t.id,previousDidProof:o}),h.push({type:"TXT",name:"_prv._did.",ttl:hr,data:`id=${E};s=${$}`})}if(t.alsoKnownAs&&h.push({type:"TXT",name:"_aka._did.",ttl:hr,data:t.alsoKnownAs.join(_t)}),t.controller){const $=Array.isArray(t.controller)?t.controller.join(_t):t.controller;h.push({type:"TXT",name:"_cnt._did.",ttl:hr,data:$})}for(const[$,E]of(a=(s=t.verificationMethod)===null||s===void 0?void 0:s.entries())!==null&&a!==void 0?a:[]){const I=`k${$}`;g.push(I);let A=E.id.split("#").pop();w.set(A,I);const U=E.publicKeyJwk;if(!(U!=null&&U.crv&&U.crv in uy))throw new ye(fe.InvalidPublicKeyType,`Verification method '${E.id}' contains an unsupported key type: ${(l=U==null?void 0:U.crv)!==null&&l!==void 0?l:"undefined"}`);const H=xt[U.crv],W=yield st.keyConverter(U.crv).publicKeyToBytes({publicKey:U}),ee=oe.uint8Array(W).toBase64Url(),re=[`t=${H}`,`k=${ee}`];A!=="0"&&(yield Pe({jwk:U}))!==A&&re.unshift(`id=${A}`),U.alg!==kd[H]&&re.push(`a=${U.alg}`),E.controller!==t.id&&re.push(`c=${E.controller}`),h.push({type:"TXT",name:`_${I}._did.`,ttl:hr,data:re.join(Ds)})}(u=t.service)===null||u===void 0||u.forEach(($,E)=>{const I=`s${E}`;x.push(I);let{id:A,type:U,serviceEndpoint:H}=$,W=Rd($,["id","type","serviceEndpoint"]);A=nn(A),H=Array.isArray(H)?H.join(","):H;const re=Object.entries(Object.assign({id:A,t:U,se:H},W)).map(([Q,M])=>`${Q}=${M}`).join(Ds),ne=st.chunkDataIfNeeded(re);h.push({type:"TXT",name:`_${I}._did.`,ttl:hr,data:ne})});const R=[`v=${OE}`];if(g.length&&R.push(`vm=${g.join(_t)}`),Object.keys(To).forEach($=>{var E;const I=(E=t[$])===null||E===void 0?void 0:E.map(A=>w.get(A.split("#").pop()));if(I){const A=Wc[$];R.push(`${A}=${I.join(_t)}`)}}),x.length&&R.push(`svc=${x.join(_t)}`),!((c=r.types)===null||c===void 0)&&c.length){const E=r.types.map(I=>typeof I=="string"?Vc[I]:I);h.push({type:"TXT",name:"_typ._did.",ttl:hr,data:`id=${E.join(_t)}`})}h.push({type:"TXT",name:"_did."+jn.getUniqueDidSuffix(t.id)+".",ttl:hr,data:R.join(Ds)});for(const $ of i||[])p.push({type:"NS",name:"_did."+jn.getUniqueDidSuffix(t.id)+".",ttl:hr,data:$+"."});return{id:0,type:"response",flags:TE,answers:[...h,...p]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}}class st{static createBep44PutMessage(e){return ft(this,arguments,void 0,function*({dnsPacket:t,publicKeyBytes:r,signer:i}){const o=Math.ceil(Date.now()/1e3),s=Hc(t),a=_d.encode({seq:o,v:s}).subarray(1,-1);if(a.length>1e3)throw new ye(fe.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const l=yield i.sign({data:a});return{k:r,seq:o,sig:l,v:s}})}static identifierToIdentityKey(e){return ft(this,arguments,void 0,function*({didUri:t}){let r=st.identifierToIdentityKeyBytes({didUri:t});return yield Xe.bytesToPublicKey({publicKeyBytes:r})})}static identifierToIdentityKeyBytes({didUri:e}){const t=Be.parse(e);if(!t)throw new ye(fe.InvalidDid,`Invalid DID URI: ${e}`);if(t.method!==si.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${t.method}`);let r;try{r=oe.base32Z(t.id).toUint8Array()}catch{throw new ye(fe.InvalidPublicKey,"Failed to decode method-specific identifier")}if(r.length!==32)throw new ye(fe.InvalidPublicKeyLength,`Invalid public key length: ${r.length}`);return r}static identityKeyToIdentifier(e){return ft(this,arguments,void 0,function*({identityKey:t}){const r=yield Xe.publicKeyToBytes({publicKey:t}),i=oe.uint8Array(r).toBase32Z();return`did:${si.methodName}:${i}`})}static keyConverter(e){const r={Ed25519:Xe,"P-256":{publicKeyToBytes:i=>ft(this,[i],void 0,function*({publicKey:o}){const s=yield Je.publicKeyToBytes({publicKey:o});return yield Je.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Je.bytesToPublicKey,privateKeyToBytes:Je.privateKeyToBytes,bytesToPrivateKey:Je.bytesToPrivateKey},secp256k1:{publicKeyToBytes:i=>ft(this,[i],void 0,function*({publicKey:o}){const s=yield Ge.publicKeyToBytes({publicKey:o});return yield Ge.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Ge.bytesToPublicKey,privateKeyToBytes:Ge.privateKeyToBytes,bytesToPrivateKey:Ge.bytesToPrivateKey},X25519:Gr}[e];if(!r)throw new ye(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static parseBep44GetMessage(e){return ft(this,arguments,void 0,function*({bep44Message:t}){const r=yield Xe.bytesToPublicKey({publicKeyBytes:t.k}),i=_d.encode({seq:t.seq,v:t.v}).subarray(1,-1);if(!(yield Xe.verify({key:r,signature:t.sig,data:i})))throw new ye(fe.InvalidSignature,"Invalid signature for DHT BEP44 message");return IE(t.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(Ds).reduce((t,r)=>{const[i,o]=r.split("=");return t[i]=o,t},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return oe.uint8Array(e).toString();if(Array.isArray(e))return e.map(t=>this.parseTxtDataToString(t)).join("");throw new ye(fe.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ft(this,arguments,void 0,function*({newDid:t,previousDidProof:r}){const i=yield st.identifierToIdentityKey({didUri:r.previousDid}),o=st.identifierToIdentityKeyBytes({didUri:t}),s=oe.base64Url(r.signature).toUint8Array();if(!(yield Xe.verify({key:i,data:o,signature:s})))throw new ye(fe.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const t=[];for(let r=0;r<e.length;r+=255)t.push(e.slice(r,r+255));return t}}const et={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};class tt extends Error{constructor(e,t){super(`${e}: ${t}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}}const kE=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")};let BE=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}};class LE{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return dy(this,e)}}class CE{constructor(e){this.decoders=e}or(e){return dy(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const dy=(n,e)=>new CE({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class $E{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new BE(e,t,r),this.decoder=new LE(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const UE=({name:n,prefix:e,encode:t,decode:r})=>new $E(n,e,t,r),NE=(n,e,t,r)=>{const i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=n.length;for(;n[o-1]==="=";)--o;const s=new Uint8Array(o*t/8|0);let a=0,l=0,u=0;for(let c=0;c<o;++c){const h=i[n[c]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return s},DE=(n,e,t)=>{const r=e[e.length-1]==="=",i=(1<<t)-1;let o="",s=0,a=0;for(let l=0;l<n.length;++l)for(a=a<<8|n[l],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),r)for(;o.length*t&7;)o+="=";return o},ga=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>UE({prefix:e,name:n,encode(i){return DE(i,r,t)},decode(i){return NE(i,r,t,n)}});ga({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});ga({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Bd=ga({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});ga({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});class En{static encode(e){return Bd.baseEncode(e)}static decodeAsBytes(e,t){if(!En.isBase64UrlString(e))throw new tt(et.EncodedStringIncorrectEncoding,`Given ${t} must be base64url string.`);return Bd.baseDecode(e)}static decodeAsString(e,t){const r=En.decodeAsBytes(e,t);return En.bytesToString(r)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}}var qc={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(n,e){(function(t,r){r(e)})(xy,function(t){function r(){for(var T=arguments.length,v=Array(T),O=0;O<T;O++)v[O]=arguments[O];if(v.length>1){v[0]=v[0].slice(0,-1);for(var P=v.length-1,N=1;N<P;++N)v[N]=v[N].slice(1,-1);return v[P]=v[P].slice(1),v.join("")}else return v[0]}function i(T){return"(?:"+T+")"}function o(T){return T===void 0?"undefined":T===null?"null":Object.prototype.toString.call(T).split(" ").pop().split("]").shift().toLowerCase()}function s(T){return T.toUpperCase()}function a(T){return T!=null?T instanceof Array?T:typeof T.length!="number"||T.split||T.setInterval||T.call?[T]:Array.prototype.slice.call(T):[]}function l(T,v){var O=T;if(v)for(var P in v)O[P]=v[P];return O}function u(T){var v="[A-Za-z]",O="[0-9]",P=r(O,"[A-Fa-f]"),N=i(i("%[EFef]"+P+"%"+P+P+"%"+P+P)+"|"+i("%[89A-Fa-f]"+P+"%"+P+P)+"|"+i("%"+P+P)),le="[\\:\\/\\?\\#\\[\\]\\@]",ue="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Ie=r(le,ue),De=T?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Fe=T?"[\\uE000-\\uF8FF]":"[]",ve=r(v,O,"[\\-\\.\\_\\~]",De);i(v+r(v,O,"[\\+\\-\\.]")+"*"),i(i(N+"|"+r(ve,ue,"[\\:]"))+"*");var ke=i(i("25[0-5]")+"|"+i("2[0-4]"+O)+"|"+i("1"+O+O)+"|"+i("0?[1-9]"+O)+"|0?0?"+O),Qe=i(ke+"\\."+ke+"\\."+ke+"\\."+ke),Ee=i(P+"{1,4}"),Ve=i(i(Ee+"\\:"+Ee)+"|"+Qe),ot=i(i(Ee+"\\:")+"{6}"+Ve),We=i("\\:\\:"+i(Ee+"\\:")+"{5}"+Ve),tr=i(i(Ee)+"?\\:\\:"+i(Ee+"\\:")+"{4}"+Ve),rn=i(i(i(Ee+"\\:")+"{0,1}"+Ee)+"?\\:\\:"+i(Ee+"\\:")+"{3}"+Ve),on=i(i(i(Ee+"\\:")+"{0,2}"+Ee)+"?\\:\\:"+i(Ee+"\\:")+"{2}"+Ve),yi=i(i(i(Ee+"\\:")+"{0,3}"+Ee)+"?\\:\\:"+Ee+"\\:"+Ve),Rr=i(i(i(Ee+"\\:")+"{0,4}"+Ee)+"?\\:\\:"+Ve),Mt=i(i(i(Ee+"\\:")+"{0,5}"+Ee)+"?\\:\\:"+Ee),sn=i(i(i(Ee+"\\:")+"{0,6}"+Ee)+"?\\:\\:"),Or=i([ot,We,tr,rn,on,yi,Rr,Mt,sn].join("|")),Bn=i(i(ve+"|"+N)+"+");i("[vV]"+P+"+\\."+r(ve,ue,"[\\:]")+"+"),i(i(N+"|"+r(ve,ue))+"*");var Gi=i(N+"|"+r(ve,ue,"[\\:\\@]"));return i(i(N+"|"+r(ve,ue,"[\\@]"))+"+"),i(i(Gi+"|"+r("[\\/\\?]",Fe))+"*"),{NOT_SCHEME:new RegExp(r("[^]",v,O,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",ve,ue),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",ve,ue),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",ve,ue),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",ve,ue),"g"),NOT_QUERY:new RegExp(r("[^\\%]",ve,ue,"[\\:\\@\\/\\?]",Fe),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",ve,ue,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",ve,ue),"g"),UNRESERVED:new RegExp(ve,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",ve,Ie),"g"),PCT_ENCODED:new RegExp(N,"g"),IPV4ADDRESS:new RegExp("^("+Qe+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Or+")"+i(i("\\%25|\\%(?!"+P+"{2})")+"("+Bn+")")+"?\\]?$")}}var c=u(!1),h=u(!0),p=function(){function T(v,O){var P=[],N=!0,le=!1,ue=void 0;try{for(var Ie=v[Symbol.iterator](),De;!(N=(De=Ie.next()).done)&&(P.push(De.value),!(O&&P.length===O));N=!0);}catch(Fe){le=!0,ue=Fe}finally{try{!N&&Ie.return&&Ie.return()}finally{if(le)throw ue}}return P}return function(v,O){if(Array.isArray(v))return v;if(Symbol.iterator in Object(v))return T(v,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(T){if(Array.isArray(T)){for(var v=0,O=Array(T.length);v<T.length;v++)O[v]=T[v];return O}else return Array.from(T)},x=2147483647,g=36,R=1,L=26,$=38,E=700,I=72,A=128,U="-",H=/^xn--/,W=/[^\0-\x7E]/,ee=/[\x2E\u3002\uFF0E\uFF61]/g,re={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ne=g-R,Q=Math.floor,M=String.fromCharCode;function pe(T){throw new RangeError(re[T])}function F(T,v){for(var O=[],P=T.length;P--;)O[P]=v(T[P]);return O}function G(T,v){var O=T.split("@"),P="";O.length>1&&(P=O[0]+"@",T=O[1]),T=T.replace(ee,".");var N=T.split("."),le=F(N,v).join(".");return P+le}function ie(T){for(var v=[],O=0,P=T.length;O<P;){var N=T.charCodeAt(O++);if(N>=55296&&N<=56319&&O<P){var le=T.charCodeAt(O++);(le&64512)==56320?v.push(((N&1023)<<10)+(le&1023)+65536):(v.push(N),O--)}else v.push(N)}return v}var q=function(v){return String.fromCodePoint.apply(String,w(v))},K=function(v){return v-48<10?v-22:v-65<26?v-65:v-97<26?v-97:g},Y=function(v,O){return v+22+75*(v<26)-((O!=0)<<5)},z=function(v,O,P){var N=0;for(v=P?Q(v/E):v>>1,v+=Q(v/O);v>ne*L>>1;N+=g)v=Q(v/ne);return Q(N+(ne+1)*v/(v+$))},te=function(v){var O=[],P=v.length,N=0,le=A,ue=I,Ie=v.lastIndexOf(U);Ie<0&&(Ie=0);for(var De=0;De<Ie;++De)v.charCodeAt(De)>=128&&pe("not-basic"),O.push(v.charCodeAt(De));for(var Fe=Ie>0?Ie+1:0;Fe<P;){for(var ve=N,ke=1,Qe=g;;Qe+=g){Fe>=P&&pe("invalid-input");var Ee=K(v.charCodeAt(Fe++));(Ee>=g||Ee>Q((x-N)/ke))&&pe("overflow"),N+=Ee*ke;var Ve=Qe<=ue?R:Qe>=ue+L?L:Qe-ue;if(Ee<Ve)break;var ot=g-Ve;ke>Q(x/ot)&&pe("overflow"),ke*=ot}var We=O.length+1;ue=z(N-ve,We,ve==0),Q(N/We)>x-le&&pe("overflow"),le+=Q(N/We),N%=We,O.splice(N++,0,le)}return String.fromCodePoint.apply(String,O)},J=function(v){var O=[];v=ie(v);var P=v.length,N=A,le=0,ue=I,Ie=!0,De=!1,Fe=void 0;try{for(var ve=v[Symbol.iterator](),ke;!(Ie=(ke=ve.next()).done);Ie=!0){var Qe=ke.value;Qe<128&&O.push(M(Qe))}}catch(Yi){De=!0,Fe=Yi}finally{try{!Ie&&ve.return&&ve.return()}finally{if(De)throw Fe}}var Ee=O.length,Ve=Ee;for(Ee&&O.push(U);Ve<P;){var ot=x,We=!0,tr=!1,rn=void 0;try{for(var on=v[Symbol.iterator](),yi;!(We=(yi=on.next()).done);We=!0){var Rr=yi.value;Rr>=N&&Rr<ot&&(ot=Rr)}}catch(Yi){tr=!0,rn=Yi}finally{try{!We&&on.return&&on.return()}finally{if(tr)throw rn}}var Mt=Ve+1;ot-N>Q((x-le)/Mt)&&pe("overflow"),le+=(ot-N)*Mt,N=ot;var sn=!0,Or=!1,Bn=void 0;try{for(var Gi=v[Symbol.iterator](),Pl;!(sn=(Pl=Gi.next()).done);sn=!0){var Ml=Pl.value;if(Ml<N&&++le>x&&pe("overflow"),Ml==N){for(var Yo=le,Jo=g;;Jo+=g){var Xo=Jo<=ue?R:Jo>=ue+L?L:Jo-ue;if(Yo<Xo)break;var Kl=Yo-Xo,Fl=g-Xo;O.push(M(Y(Xo+Kl%Fl,0))),Yo=Q(Kl/Fl)}O.push(M(Y(Yo,0))),ue=z(le,Mt,Ve==Ee),le=0,++Ve}}}catch(Yi){Or=!0,Bn=Yi}finally{try{!sn&&Gi.return&&Gi.return()}finally{if(Or)throw Bn}}++le,++N}return O.join("")},se=function(v){return G(v,function(O){return H.test(O)?te(O.slice(4).toLowerCase()):O})},me=function(v){return G(v,function(O){return W.test(O)?"xn--"+J(O):O})},ge={version:"2.1.0",ucs2:{decode:ie,encode:q},decode:te,encode:J,toASCII:me,toUnicode:se},de={};function _e(T){var v=T.charCodeAt(0),O=void 0;return v<16?O="%0"+v.toString(16).toUpperCase():v<128?O="%"+v.toString(16).toUpperCase():v<2048?O="%"+(v>>6|192).toString(16).toUpperCase()+"%"+(v&63|128).toString(16).toUpperCase():O="%"+(v>>12|224).toString(16).toUpperCase()+"%"+(v>>6&63|128).toString(16).toUpperCase()+"%"+(v&63|128).toString(16).toUpperCase(),O}function Re(T){for(var v="",O=0,P=T.length;O<P;){var N=parseInt(T.substr(O+1,2),16);if(N<128)v+=String.fromCharCode(N),O+=3;else if(N>=194&&N<224){if(P-O>=6){var le=parseInt(T.substr(O+4,2),16);v+=String.fromCharCode((N&31)<<6|le&63)}else v+=T.substr(O,6);O+=6}else if(N>=224){if(P-O>=9){var ue=parseInt(T.substr(O+4,2),16),Ie=parseInt(T.substr(O+7,2),16);v+=String.fromCharCode((N&15)<<12|(ue&63)<<6|Ie&63)}else v+=T.substr(O,9);O+=9}else v+=T.substr(O,3),O+=3}return v}function Ke(T,v){function O(P){var N=Re(P);return N.match(v.UNRESERVED)?N:P}return T.scheme&&(T.scheme=String(T.scheme).replace(v.PCT_ENCODED,O).toLowerCase().replace(v.NOT_SCHEME,"")),T.userinfo!==void 0&&(T.userinfo=String(T.userinfo).replace(v.PCT_ENCODED,O).replace(v.NOT_USERINFO,_e).replace(v.PCT_ENCODED,s)),T.host!==void 0&&(T.host=String(T.host).replace(v.PCT_ENCODED,O).toLowerCase().replace(v.NOT_HOST,_e).replace(v.PCT_ENCODED,s)),T.path!==void 0&&(T.path=String(T.path).replace(v.PCT_ENCODED,O).replace(T.scheme?v.NOT_PATH:v.NOT_PATH_NOSCHEME,_e).replace(v.PCT_ENCODED,s)),T.query!==void 0&&(T.query=String(T.query).replace(v.PCT_ENCODED,O).replace(v.NOT_QUERY,_e).replace(v.PCT_ENCODED,s)),T.fragment!==void 0&&(T.fragment=String(T.fragment).replace(v.PCT_ENCODED,O).replace(v.NOT_FRAGMENT,_e).replace(v.PCT_ENCODED,s)),T}function Ue(T){return T.replace(/^0*(.*)/,"$1")||"0"}function Le(T,v){var O=T.match(v.IPV4ADDRESS)||[],P=p(O,2),N=P[1];return N?N.split(".").map(Ue).join("."):T}function k(T,v){var O=T.match(v.IPV6ADDRESS)||[],P=p(O,3),N=P[1],le=P[2];if(N){for(var ue=N.toLowerCase().split("::").reverse(),Ie=p(ue,2),De=Ie[0],Fe=Ie[1],ve=Fe?Fe.split(":").map(Ue):[],ke=De.split(":").map(Ue),Qe=v.IPV4ADDRESS.test(ke[ke.length-1]),Ee=Qe?7:8,Ve=ke.length-Ee,ot=Array(Ee),We=0;We<Ee;++We)ot[We]=ve[We]||ke[Ve+We]||"";Qe&&(ot[Ee-1]=Le(ot[Ee-1],v));var tr=ot.reduce(function(Mt,sn,Or){if(!sn||sn==="0"){var Bn=Mt[Mt.length-1];Bn&&Bn.index+Bn.length===Or?Bn.length++:Mt.push({index:Or,length:1})}return Mt},[]),rn=tr.sort(function(Mt,sn){return sn.length-Mt.length})[0],on=void 0;if(rn&&rn.length>1){var yi=ot.slice(0,rn.index),Rr=ot.slice(rn.index+rn.length);on=yi.join(":")+"::"+Rr.join(":")}else on=ot.join(":");return le&&(on+="%"+le),on}else return T}var C=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,V="".match(/(){0}/)[1]===void 0;function y(T){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O={},P=v.iri!==!1?h:c;v.reference==="suffix"&&(T=(v.scheme?v.scheme+":":"")+"//"+T);var N=T.match(C);if(N){V?(O.scheme=N[1],O.userinfo=N[3],O.host=N[4],O.port=parseInt(N[5],10),O.path=N[6]||"",O.query=N[7],O.fragment=N[8],isNaN(O.port)&&(O.port=N[5])):(O.scheme=N[1]||void 0,O.userinfo=T.indexOf("@")!==-1?N[3]:void 0,O.host=T.indexOf("//")!==-1?N[4]:void 0,O.port=parseInt(N[5],10),O.path=N[6]||"",O.query=T.indexOf("?")!==-1?N[7]:void 0,O.fragment=T.indexOf("#")!==-1?N[8]:void 0,isNaN(O.port)&&(O.port=T.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?N[4]:void 0)),O.host&&(O.host=k(Le(O.host,P),P)),O.scheme===void 0&&O.userinfo===void 0&&O.host===void 0&&O.port===void 0&&!O.path&&O.query===void 0?O.reference="same-document":O.scheme===void 0?O.reference="relative":O.fragment===void 0?O.reference="absolute":O.reference="uri",v.reference&&v.reference!=="suffix"&&v.reference!==O.reference&&(O.error=O.error||"URI is not a "+v.reference+" reference.");var le=de[(v.scheme||O.scheme||"").toLowerCase()];if(!v.unicodeSupport&&(!le||!le.unicodeSupport)){if(O.host&&(v.domainHost||le&&le.domainHost))try{O.host=ge.toASCII(O.host.replace(P.PCT_ENCODED,Re).toLowerCase())}catch(ue){O.error=O.error||"Host's domain name can not be converted to ASCII via punycode: "+ue}Ke(O,c)}else Ke(O,P);le&&le.parse&&le.parse(O,v)}else O.error=O.error||"URI can not be parsed.";return O}function d(T,v){var O=v.iri!==!1?h:c,P=[];return T.userinfo!==void 0&&(P.push(T.userinfo),P.push("@")),T.host!==void 0&&P.push(k(Le(String(T.host),O),O).replace(O.IPV6ADDRESS,function(N,le,ue){return"["+le+(ue?"%25"+ue:"")+"]"})),(typeof T.port=="number"||typeof T.port=="string")&&(P.push(":"),P.push(String(T.port))),P.length?P.join(""):void 0}var f=/^\.\.?\//,m=/^\/\.(\/|$)/,B=/^\/\.\.(\/|$)/,j=/^\/?(?:.|\n)*?(?=\/|$)/;function D(T){for(var v=[];T.length;)if(T.match(f))T=T.replace(f,"");else if(T.match(m))T=T.replace(m,"/");else if(T.match(B))T=T.replace(B,"/"),v.pop();else if(T==="."||T==="..")T="";else{var O=T.match(j);if(O){var P=O[0];T=T.slice(P.length),v.push(P)}else throw new Error("Unexpected dot segment condition")}return v.join("")}function he(T){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=v.iri?h:c,P=[],N=de[(v.scheme||T.scheme||"").toLowerCase()];if(N&&N.serialize&&N.serialize(T,v),T.host&&!O.IPV6ADDRESS.test(T.host)){if(v.domainHost||N&&N.domainHost)try{T.host=v.iri?ge.toUnicode(T.host):ge.toASCII(T.host.replace(O.PCT_ENCODED,Re).toLowerCase())}catch(Ie){T.error=T.error||"Host's domain name can not be converted to "+(v.iri?"Unicode":"ASCII")+" via punycode: "+Ie}}Ke(T,O),v.reference!=="suffix"&&T.scheme&&(P.push(T.scheme),P.push(":"));var le=d(T,v);if(le!==void 0&&(v.reference!=="suffix"&&P.push("//"),P.push(le),T.path&&T.path.charAt(0)!=="/"&&P.push("/")),T.path!==void 0){var ue=T.path;!v.absolutePath&&(!N||!N.absolutePath)&&(ue=D(ue)),le===void 0&&(ue=ue.replace(/^\/\//,"/%2F")),P.push(ue)}return T.query!==void 0&&(P.push("?"),P.push(T.query)),T.fragment!==void 0&&(P.push("#"),P.push(T.fragment)),P.join("")}function Te(T,v){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments[3],N={};return P||(T=y(he(T,O),O),v=y(he(v,O),O)),O=O||{},!O.tolerant&&v.scheme?(N.scheme=v.scheme,N.userinfo=v.userinfo,N.host=v.host,N.port=v.port,N.path=D(v.path||""),N.query=v.query):(v.userinfo!==void 0||v.host!==void 0||v.port!==void 0?(N.userinfo=v.userinfo,N.host=v.host,N.port=v.port,N.path=D(v.path||""),N.query=v.query):(v.path?(v.path.charAt(0)==="/"?N.path=D(v.path):((T.userinfo!==void 0||T.host!==void 0||T.port!==void 0)&&!T.path?N.path="/"+v.path:T.path?N.path=T.path.slice(0,T.path.lastIndexOf("/")+1)+v.path:N.path=v.path,N.path=D(N.path)),N.query=v.query):(N.path=T.path,v.query!==void 0?N.query=v.query:N.query=T.query),N.userinfo=T.userinfo,N.host=T.host,N.port=T.port),N.scheme=T.scheme),N.fragment=v.fragment,N}function Ce(T,v,O){var P=l({scheme:"null"},O);return he(Te(y(T,P),y(v,P),P,!0),P)}function qe(T,v){return typeof T=="string"?T=he(y(T,v),v):o(T)==="object"&&(T=y(he(T,v),v)),T}function Ne(T,v,O){return typeof T=="string"?T=he(y(T,O),O):o(T)==="object"&&(T=he(T,O)),typeof v=="string"?v=he(y(v,O),O):o(v)==="object"&&(v=he(v,O)),T===v}function Zt(T,v){return T&&T.toString().replace(!v||!v.iri?c.ESCAPE:h.ESCAPE,_e)}function it(T,v){return T&&T.toString().replace(!v||!v.iri?c.PCT_ENCODED:h.PCT_ENCODED,Re)}var Ot={scheme:"http",domainHost:!0,parse:function(v,O){return v.host||(v.error=v.error||"HTTP URIs must have a host."),v},serialize:function(v,O){var P=String(v.scheme).toLowerCase()==="https";return(v.port===(P?443:80)||v.port==="")&&(v.port=void 0),v.path||(v.path="/"),v}},On={scheme:"https",domainHost:Ot.domainHost,parse:Ot.parse,serialize:Ot.serialize};function hi(T){return typeof T.secure=="boolean"?T.secure:String(T.scheme).toLowerCase()==="wss"}var kn={scheme:"ws",domainHost:!0,parse:function(v,O){var P=v;return P.secure=hi(P),P.resourceName=(P.path||"/")+(P.query?"?"+P.query:""),P.path=void 0,P.query=void 0,P},serialize:function(v,O){if((v.port===(hi(v)?443:80)||v.port==="")&&(v.port=void 0),typeof v.secure=="boolean"&&(v.scheme=v.secure?"wss":"ws",v.secure=void 0),v.resourceName){var P=v.resourceName.split("?"),N=p(P,2),le=N[0],ue=N[1];v.path=le&&le!=="/"?le:void 0,v.query=ue,v.resourceName=void 0}return v.fragment=void 0,v}},Vi={scheme:"wss",domainHost:kn.domainHost,parse:kn.parse,serialize:kn.serialize},ma={},Wo="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Pt="[0-9A-Fa-f]",qo=i(i("%[EFef]"+Pt+"%"+Pt+Pt+"%"+Pt+Pt)+"|"+i("%[89A-Fa-f]"+Pt+"%"+Pt+Pt)+"|"+i("%"+Pt+Pt)),zo="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",va="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Go=r(va,'[\\"\\\\]'),Wi="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Ea=new RegExp(Wo,"g"),er=new RegExp(qo,"g"),qi=new RegExp(r("[^]",zo,"[\\.]",'[\\"]',Go),"g"),zi=new RegExp(r("[^]",Wo,Wi),"g"),b=zi;function S(T){var v=Re(T);return v.match(Ea)?v:T}var X={scheme:"mailto",parse:function(v,O){var P=v,N=P.to=P.path?P.path.split(","):[];if(P.path=void 0,P.query){for(var le=!1,ue={},Ie=P.query.split("&"),De=0,Fe=Ie.length;De<Fe;++De){var ve=Ie[De].split("=");switch(ve[0]){case"to":for(var ke=ve[1].split(","),Qe=0,Ee=ke.length;Qe<Ee;++Qe)N.push(ke[Qe]);break;case"subject":P.subject=it(ve[1],O);break;case"body":P.body=it(ve[1],O);break;default:le=!0,ue[it(ve[0],O)]=it(ve[1],O);break}}le&&(P.headers=ue)}P.query=void 0;for(var Ve=0,ot=N.length;Ve<ot;++Ve){var We=N[Ve].split("@");if(We[0]=it(We[0]),O.unicodeSupport)We[1]=it(We[1],O).toLowerCase();else try{We[1]=ge.toASCII(it(We[1],O).toLowerCase())}catch(tr){P.error=P.error||"Email address's domain name can not be converted to ASCII via punycode: "+tr}N[Ve]=We.join("@")}return P},serialize:function(v,O){var P=v,N=a(v.to);if(N){for(var le=0,ue=N.length;le<ue;++le){var Ie=String(N[le]),De=Ie.lastIndexOf("@"),Fe=Ie.slice(0,De).replace(er,S).replace(er,s).replace(qi,_e),ve=Ie.slice(De+1);try{ve=O.iri?ge.toUnicode(ve):ge.toASCII(it(ve,O).toLowerCase())}catch(Ve){P.error=P.error||"Email address's domain name can not be converted to "+(O.iri?"Unicode":"ASCII")+" via punycode: "+Ve}N[le]=Fe+"@"+ve}P.path=N.join(",")}var ke=v.headers=v.headers||{};v.subject&&(ke.subject=v.subject),v.body&&(ke.body=v.body);var Qe=[];for(var Ee in ke)ke[Ee]!==ma[Ee]&&Qe.push(Ee.replace(er,S).replace(er,s).replace(zi,_e)+"="+ke[Ee].replace(er,S).replace(er,s).replace(b,_e));return Qe.length&&(P.query=Qe.join("&")),P}},Z=/^([^\:]+)\:(.*)/,ae={scheme:"urn",parse:function(v,O){var P=v.path&&v.path.match(Z),N=v;if(P){var le=O.scheme||N.scheme||"urn",ue=P[1].toLowerCase(),Ie=P[2],De=le+":"+(O.nid||ue),Fe=de[De];N.nid=ue,N.nss=Ie,N.path=void 0,Fe&&(N=Fe.parse(N,O))}else N.error=N.error||"URN can not be parsed.";return N},serialize:function(v,O){var P=O.scheme||v.scheme||"urn",N=v.nid,le=P+":"+(O.nid||N),ue=de[le];ue&&(v=ue.serialize(v,O));var Ie=v,De=v.nss;return Ie.path=(N||O.nid)+":"+De,Ie}},lt=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,vt={scheme:"urn:uuid",parse:function(v,O){var P=v;return P.uuid=P.nss,P.nss=void 0,!O.tolerant&&(!P.uuid||!P.uuid.match(lt))&&(P.error=P.error||"UUID is not valid."),P},serialize:function(v,O){var P=v;return P.nss=(v.uuid||"").toLowerCase(),P}};de[Ot.scheme]=Ot,de[On.scheme]=On,de[kn.scheme]=kn,de[Vi.scheme]=Vi,de[X.scheme]=X,de[ae.scheme]=ae,de[vt.scheme]=vt,t.SCHEMES=de,t.pctEncChar=_e,t.pctDecChars=Re,t.parse=y,t.removeDotSegments=D,t.serialize=he,t.resolveComponents=Te,t.resolve=Ce,t.normalize=qe,t.equal=Ne,t.escapeComponent=Zt,t.unescapeComponent=it,Object.defineProperty(t,"__esModule",{value:!0})})})(qc,qc.exports);var PE=qc.exports,zc;(function(n){n.Public="public",n.Private="private"})(zc||(zc={}));const dn=zc;class Lt{static validateEs256kOperationKey(e,t){const r=new Set(["kty","crv","x","y"]);t===dn.Private&&r.add("d");for(const i in e)if(!r.has(i))throw new tt(et.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${i}'.`);if(e.crv!=="secp256k1")throw new tt(et.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new tt(et.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new tt(et.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new tt(et.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(t===dn.Private&&(e.d===void 0||e.d.length!==43))throw new tt(et.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new tt(et.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!En.isBase64UrlString(e))throw new tt(et.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;const t=new Set;for(const r of e){if(t.has(r))throw new tt(et.PublicKeyPurposeDuplicated,`Public key purpose '${r}' already specified.`);t.add(r)}}}class Ut{}Ut.hashAlgorithmInMultihashCode=18;Ut.maxCanonicalizedDeltaSizeInBytes=1e3;var ME=function n(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?n(e.toJSON()):Array.isArray(e)?`[${e.reduce((i,o,s)=>`${i}${s===0?"":","}${n(o===void 0||typeof o=="symbol"?null:o)}`,"")}]`:`{${Object.keys(e).sort().reduce((r,i)=>{if(e[i]===void 0||typeof e[i]=="symbol")return r;const o=r.length===0?"":",";return`${r}${o}${n(i)}:${n(e[i])}`},"")}}`};const KE=Sy(ME);class xr{static canonicalizeAsBytes(e){const t=xr.removeAllUndefinedProperties(e),r=KE(t);return En.stringToBytes(r)}static removeAllUndefinedProperties(e){for(const t in e)typeof e[t]=="object"?xr.removeAllUndefinedProperties(e[t]):e[t]===void 0&&delete e[t];return e}}var FE=fy,Ld=128,jE=127,HE=~jE,VE=Math.pow(2,31);function fy(n,e,t){e=e||[],t=t||0;for(var r=t;n>=VE;)e[t++]=n&255|Ld,n/=128;for(;n&HE;)e[t++]=n&255|Ld,n>>>=7;return e[t]=n|0,fy.bytes=t-r+1,e}var WE=Gc,qE=128,Cd=127;function Gc(n,r){var t=0,r=r||0,i=0,o=r,s,a=n.length;do{if(o>=a)throw Gc.bytes=0,new RangeError("Could not decode varint");s=n[o++],t+=i<28?(s&Cd)<<i:(s&Cd)*Math.pow(2,i),i+=7}while(s>=qE);return Gc.bytes=o-r,t}var zE=Math.pow(2,7),GE=Math.pow(2,14),YE=Math.pow(2,21),JE=Math.pow(2,28),XE=Math.pow(2,35),ZE=Math.pow(2,42),QE=Math.pow(2,49),e1=Math.pow(2,56),t1=Math.pow(2,63),n1=function(n){return n<zE?1:n<GE?2:n<YE?3:n<JE?4:n<XE?5:n<ZE?6:n<QE?7:n<e1?8:n<t1?9:10},r1={encode:FE,decode:WE,encodingLength:n1},qs=r1;const $d=(n,e=0)=>[qs.decode(n,e),qs.decode.bytes],Ud=(n,e,t=0)=>(qs.encode(n,e,t),e),Nd=n=>qs.encodingLength(n),Dd=(n,e)=>{const t=e.byteLength,r=Nd(n),i=r+Nd(t),o=new Uint8Array(i+t);return Ud(n,o,0),Ud(t,o,r),o.set(e,i),new hy(n,t,e,o)},i1=n=>{const e=kE(n),[t,r]=$d(e),[i,o]=$d(e.subarray(r)),s=e.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new hy(t,i,s,e)};class hy{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const o1=({name:n,code:e,encode:t})=>new s1(n,e,t);class s1{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Dd(this.code,t):t.then(r=>Dd(this.code,r))}else throw Error("Unknown type, must be binary type")}}const a1=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),Pd=o1({name:"sha2-256",code:18,encode:a1("SHA-256")});var ho=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class ut{static hash(e,t){return ho(this,void 0,void 0,function*(){let r;switch(t){case 18:r=(yield Pd.digest(e)).bytes;break;default:throw new tt(et.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return r})}static hashAsNonMultihashBytes(e,t){return ho(this,void 0,void 0,function*(){let r;switch(t){case 18:r=yield Pd.encode(e);break;default:throw new tt(et.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return r})}static canonicalizeThenHashThenEncode(e,t){return ho(this,void 0,void 0,function*(){const r=xr.canonicalizeAsBytes(e);return yield ut.hashThenEncode(r,t)})}static canonicalizeThenDoubleHashThenEncode(e,t){return ho(this,void 0,void 0,function*(){const r=xr.canonicalizeAsBytes(e),i=yield ut.hashAsNonMultihashBytes(r,t);return yield ut.hashThenEncode(i,t)})}static hashThenEncode(e,t){return ho(this,void 0,void 0,function*(){const r=yield ut.hash(e,t);return En.encode(r)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,t){let r;const i=En.decodeAsBytes(e,t);try{r=i1(i)}catch{throw new tt(et.MultihashStringNotAMultihash,`Given ${t} string '${e}' is not a multihash after decoding.`)}const o=Ut.hashAlgorithmInMultihashCode;if(o!==r.code)throw new tt(et.MultihashUnsupportedHashAlgorithm,`Given ${t} uses unsupported multihash algorithm with code ${r.code}, should use ${o} or change IonSdkConfig to desired hashing algorithm.`)}}var Yc;(function(n){n.Create="create",n.Update="update",n.Deactivate="deactivate",n.Recover="recover"})(Yc||(Yc={}));const ms=Yc;var Jc;(function(n){n.Replace="replace",n.AddPublicKeys="add-public-keys",n.RemovePublicKeys="remove-public-keys",n.AddServices="add-services",n.RemoveServices="remove-services"})(Jc||(Jc={}));const xi=Jc;var vs=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Tt{static createCreateRequest(e){return vs(this,void 0,void 0,function*(){const t=e.recoveryKey,r=e.updateKey,i=e.document.publicKeys,o=e.document.services;Lt.validateEs256kOperationKey(t,dn.Public),Lt.validateEs256kOperationKey(r,dn.Public),Tt.validateDidDocumentKeys(i),Tt.validateServices(o);const s=Ut.hashAlgorithmInMultihashCode,a=[{action:xi.Replace,document:e.document}],l={updateCommitment:yield ut.canonicalizeThenDoubleHashThenEncode(r,s),patches:a};Tt.validateDeltaSize(l);const c={deltaHash:yield ut.canonicalizeThenHashThenEncode(l,s),recoveryCommitment:yield ut.canonicalizeThenDoubleHashThenEncode(t,s)};return{type:ms.Create,suffixData:c,delta:l}})}static createDeactivateRequest(e){return vs(this,void 0,void 0,function*(){Tt.validateDidSuffix(e.didSuffix),Lt.validateEs256kOperationKey(e.recoveryPublicKey,dn.Public);const t=Ut.hashAlgorithmInMultihashCode,r=yield ut.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},o=yield e.signer.sign({alg:"ES256K"},i);return{type:ms.Deactivate,didSuffix:e.didSuffix,revealValue:r,signedData:o}})}static createRecoverRequest(e){return vs(this,void 0,void 0,function*(){Tt.validateDidSuffix(e.didSuffix),Lt.validateEs256kOperationKey(e.recoveryPublicKey,dn.Public),Lt.validateEs256kOperationKey(e.nextRecoveryPublicKey,dn.Public),Lt.validateEs256kOperationKey(e.nextUpdatePublicKey,dn.Public),Tt.validateDidDocumentKeys(e.document.publicKeys),Tt.validateServices(e.document.services);const t=Ut.hashAlgorithmInMultihashCode,r=yield ut.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i=[{action:xi.Replace,document:e.document}],o=yield ut.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,t),s={patches:i,updateCommitment:o},a=yield ut.canonicalizeThenHashThenEncode(s,t),u={recoveryCommitment:yield ut.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,t),recoveryKey:e.recoveryPublicKey,deltaHash:a},c=yield e.signer.sign({alg:"ES256K"},u);return{type:ms.Recover,didSuffix:e.didSuffix,revealValue:r,delta:s,signedData:c}})}static createUpdateRequest(e){return vs(this,void 0,void 0,function*(){if(Tt.validateDidSuffix(e.didSuffix),Lt.validateEs256kOperationKey(e.updatePublicKey,dn.Public),Lt.validateEs256kOperationKey(e.nextUpdatePublicKey,dn.Public),Tt.validateServices(e.servicesToAdd),Tt.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(const x of e.idsOfServicesToRemove)Lt.validateId(x);if(e.idsOfPublicKeysToRemove!==void 0)for(const x of e.idsOfPublicKeysToRemove)Lt.validateId(x);const t=[],r=e.servicesToAdd;if(r!==void 0&&r.length>0){const x={action:xi.AddServices,services:r};t.push(x)}const i=e.idsOfServicesToRemove;if(i!==void 0&&i.length>0){const x={action:xi.RemoveServices,ids:i};t.push(x)}const o=e.publicKeysToAdd;if(o!==void 0&&o.length>0){const x={action:xi.AddPublicKeys,publicKeys:o};t.push(x)}const s=e.idsOfPublicKeysToRemove;if(s!==void 0&&s.length>0){const x={action:xi.RemovePublicKeys,ids:s};t.push(x)}const a=Ut.hashAlgorithmInMultihashCode,l=yield ut.canonicalizeThenHashThenEncode(e.updatePublicKey,a),u=yield ut.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),c={patches:t,updateCommitment:u},h=yield ut.canonicalizeThenHashThenEncode(c,a),p={updateKey:e.updatePublicKey,deltaHash:h},w=yield e.signer.sign({alg:"ES256K"},p);return{type:ms.Update,didSuffix:e.didSuffix,revealValue:l,delta:c,signedData:w}})}static validateDidSuffix(e){ut.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;const t=new Set;for(const r of e){if(Array.isArray(r.publicKeyJwk))throw new tt(et.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(Lt.validateId(r.id),t.has(r.id))throw new tt(et.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${r.id}' already exists.`);t.add(r.id),Lt.validatePublicKeyPurposes(r.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){const t=new Set;for(const r of e){if(Tt.validateService(r),t.has(r.id))throw new tt(et.DidDocumentServiceIdDuplicated,"Service id has to be unique");t.add(r.id)}}}static validateService(e){Lt.validateId(e.id);const t=30;if(e.type.length>t){const r=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${t}.`;throw new tt(et.ServiceTypeTooLong,r)}if(Array.isArray(e.serviceEndpoint)){const r="Service endpoint value cannot be an array.";throw new tt(et.ServiceEndpointCannotBeAnArray,r)}if(typeof e.serviceEndpoint=="string"&&PE.parse(e.serviceEndpoint).error!==void 0)throw new tt(et.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){const t=xr.canonicalizeAsBytes(e);if(t.length>Ut.maxCanonicalizedDeltaSizeInBytes){const r=`Delta of ${t.length} bytes exceeded limit of ${Ut.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new tt(et.DeltaExceedsMaximumSize,r)}}}var Md=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Nl{static createLongFormDid(e){return Md(this,void 0,void 0,function*(){const t=yield Tt.createCreateRequest(e),r=yield Nl.computeDidUniqueSuffix(t.suffixData);let i;Ut.network===void 0||Ut.network==="mainnet"?i=`did:ion:${r}`:i=`did:ion:${Ut.network}:${r}`;const o={suffixData:t.suffixData,delta:t.delta},s=xr.canonicalizeAsBytes(o),a=En.encode(s);return`${i}:${a}`})}static computeDidUniqueSuffix(e){return Md(this,void 0,void 0,function*(){const t=xr.canonicalizeAsBytes(e),r=yield ut.hash(t,Ut.hashAlgorithmInMultihashCode);return En.encode(r)})}}var Kd;(function(n){n.Mainnet="mainnet",n.Testnet="test"})(Kd||(Kd={}));var Fd;(function(n){n.Authentication="authentication",n.AssertionMethod="assertionMethod",n.CapabilityInvocation="capabilityInvocation",n.CapabilityDelegation="capabilityDelegation",n.KeyAgreement="keyAgreement"})(Fd||(Fd={}));var gr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},gn;(function(n){n.Ed25519="Ed25519",n.secp256k1="secp256k1",n.secp256r1="secp256r1",n.X25519="X25519"})(gn||(gn={}));const c1={Ed25519:gn.Ed25519,ES256K:gn.secp256k1,ES256:gn.secp256r1,"P-256":gn.secp256r1,secp256k1:gn.secp256k1,secp256r1:gn.secp256r1},jd="https://ion.tbd.engineering";class Ri extends Vo{static create(){return gr(this,arguments,void 0,function*({keyManager:e=new Jn,options:t={}}={}){var r,i,o,s,a,l,u;if(!((r=t.verificationMethods)===null||r===void 0)&&r.some(A=>!(A.algorithm in c1)))throw new Error("One or more verification method algorithms are not supported");const c=(i=t.verificationMethods)===null||i===void 0?void 0:i.filter(A=>"id"in A).map(A=>A.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((o=t.services)===null||o===void 0)&&o.some(A=>!A.id||!A.type||!A.serviceEndpoint))throw new Error("One or more services are missing required properties");const h={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},p=[];for(const A of(s=t.verificationMethods)!==null&&s!==void 0?s:[h]){const U=yield e.generateKey({algorithm:A.algorithm}),H=yield e.getPublicKey({keyUri:U});p.push({id:A.id,publicKeyJwk:H,purposes:(a=A.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const w=yield e.generateKey({algorithm:gn.secp256k1}),x=yield e.getPublicKey({keyUri:w}),g=yield e.generateKey({algorithm:gn.secp256k1}),R=yield e.getPublicKey({keyUri:g}),L=yield zt.computeLongFormDidUri({recoveryKey:x,updateKey:R,services:(l=t.services)!==null&&l!==void 0?l:[],verificationMethods:p}),{didDocument:$,didResolutionMetadata:E}=yield Ri.resolve(L,{gatewayUri:t.gatewayUri});if($===null)throw new Error(`Unable to resolve DID during creation: ${E==null?void 0:E.error}`);const I=new An({uri:L,document:$,metadata:{published:!1,canonicalId:L.split(":",3).join(":"),recoveryKey:x,updateKey:R},keyManager:e});if(!((u=t.publish)!==null&&u!==void 0)||u){const A=yield Ri.publish({did:I,gatewayUri:t.gatewayUri});I.metadata=A.didDocumentMetadata}return I})}static getSigningMethod(e){return gr(this,arguments,void 0,function*({didDocument:t,methodId:r}){var i;const o=Be.parse(t.id);if(o&&o.method!==this.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${o.method}`);const s=(i=t.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var l;return a.id===(r??((l=t.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(s&&s.publicKeyJwk))throw new ye(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return gr(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Jn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==Ri.methodName)throw new ye(fe.MethodNotSupported,"Method not supported");return yield An.import({portableDid:t,keyManager:r})})}static publish(e){return gr(this,arguments,void 0,function*({did:t,gatewayUri:r=jd}){var i,o,s;const a=(o=(i=t.document.verificationMethod)===null||i===void 0?void 0:i.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:qv({didDocument:t.document,methodId:c.id})})))!==null&&o!==void 0?o:[],l=yield zt.createIonDocument({services:(s=t.document.service)!==null&&s!==void 0?s:[],verificationMethods:a}),u=yield zt.constructCreateRequest({ionDocument:l,recoveryKey:t.metadata.recoveryKey,updateKey:t.metadata.updateKey});try{const c=zt.appendPathToUrl({baseUrl:r,path:"/operations"}),h=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});return{didDocument:t.document,didDocumentMetadata:Object.assign(Object.assign({},t.metadata),{published:h.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:fe.InternalError,errorMessage:`Failed to publish DID document for: ${t.uri}`}}}})}static resolve(e){return gr(this,arguments,void 0,function*(t,r={}){var i,o;const s=Be.parse(t);if(!s)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"invalidDid"}});if(s.method!==Ri.methodName)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(i=r==null?void 0:r.gatewayUri)!==null&&i!==void 0?i:jd;try{const l=zt.appendPathToUrl({baseUrl:a,path:`/identifiers/${t}`}),u=yield fetch(l);if(!u.ok)throw new ye(fe.NotFound,`Unable to find DID document for: ${t}`);const{didDocument:c,didDocumentMetadata:h}=yield u.json();return Object.assign(Object.assign(Object.assign({},gt),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(o=h==null?void 0:h.method)===null||o===void 0?void 0:o.published},h)})}catch(l){if(!(l instanceof ye))throw new Error(l);return Object.assign(Object.assign({},gt),{didResolutionMetadata:Object.assign({error:l.code},l.message&&{errorMessage:l.message})})}})}}Ri.methodName="ion";class zt{static appendPathToUrl({baseUrl:e,path:t}){const r=new URL(e);return r.pathname=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",r.pathname+=t.startsWith("/")?t.substring(1):t,r.toString()}static computeLongFormDidUri(e){return gr(this,arguments,void 0,function*({recoveryKey:t,updateKey:r,services:i,verificationMethods:o}){const s=yield zt.createIonDocument({services:i,verificationMethods:o}),a=zt.normalizeJwk(t),l=zt.normalizeJwk(r);return yield Nl.createLongFormDid({document:s,recoveryKey:a,updateKey:l})})}static constructCreateRequest(e){return gr(this,arguments,void 0,function*({ionDocument:t,recoveryKey:r,updateKey:i}){return yield Tt.createCreateRequest({document:t,recoveryKey:zt.normalizeJwk(r),updateKey:zt.normalizeJwk(i)})})}static createIonDocument(e){return gr(this,arguments,void 0,function*({services:t,verificationMethods:r}){var i,o;const s=[];for(const u of r){let c=(o=(i=u.id)!==null&&i!==void 0?i:u.publicKeyJwk.kid)!==null&&o!==void 0?o:yield Pe({jwk:u.publicKeyJwk});c=`${c.split("#").pop()}`;const h={id:c,publicKeyJwk:zt.normalizeJwk(u.publicKeyJwk),purposes:u.purposes,type:"JsonWebKey2020"};s.push(h)}const a=t.map(u=>Object.assign(Object.assign({},u),{id:`${u.id.split("#").pop()}`}));return{publicKeys:s,services:a}})}static normalizeJwk(e){const t=e.kty;let r;if(t==="EC")r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(t==="oct")r={k:e.k,kty:e.kty};else if(t==="OKP")r={crv:e.crv,kty:e.kty,x:e.x};else if(t==="RSA")r={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${t}`);return r}}var Es=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Oi extends Vo{static create(){return Es(this,arguments,void 0,function*({keyManager:e=new Jn,options:t={}}={}){var r,i,o,s;if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(s=(r=t.algorithm)!==null&&r!==void 0?r:(o=(i=t.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",l=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:l}),c=oe.object(u).toBase64Url(),h=`did:${Oi.methodName}:${c}`,w=(yield Oi.resolve(h)).didDocument;return new An({uri:h,document:w,metadata:{},keyManager:e})})}static getSigningMethod(e){return Es(this,arguments,void 0,function*({didDocument:t}){var r;const i=Be.parse(t.id);if(i&&i.method!==this.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${i.method}`);const[o]=(r=t.verificationMethod)!==null&&r!==void 0?r:[];if(!(o&&o.publicKeyJwk))throw new ye(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Es(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Jn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==Oi.methodName)throw new ye(fe.MethodNotSupported,"Method not supported");const o=yield An.import({portableDid:t,keyManager:r});if(o.document.verificationMethod.length!==1)throw new ye(fe.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,t){return Es(this,void 0,void 0,function*(){const r=Be.parse(e);let i;try{i=oe.base64Url(r.id).toObject()}catch{}if(!r||!i)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"invalidDid"}});if(r.method!==Oi.methodName)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"methodNotSupported"}});const o={"@context":["https://www.w3.org/ns/did/v1"],id:r.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return Object.assign(Object.assign({},gt),{didDocument:o})})}}Oi.methodName="jwk";var tn=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Mn;(function(n){n.Ed25519="Ed25519",n.secp256k1="secp256k1",n.secp256r1="secp256r1",n.X25519="X25519"})(Mn||(Mn={}));const fc={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},l1={Ed25519:Mn.Ed25519,ES256K:Mn.secp256k1,ES256:Mn.secp256r1,"P-256":Mn.secp256r1,secp256k1:Mn.secp256k1,secp256r1:Mn.secp256r1,X25519:Mn.X25519};class fn extends Vo{static create(){return tn(this,arguments,void 0,function*({keyManager:e=new Jn,options:t={}}={}){var r,i,o,s;if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(s=(r=t.algorithm)!==null&&r!==void 0?r:(o=(i=t.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",l=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:l}),c=yield dt.publicKeyToMultibaseId({publicKey:u}),h=`did:${fn.methodName}:${c}`,w=(yield fn.resolve(h,t)).didDocument;return new An({uri:h,document:w,metadata:{},keyManager:e})})}static getSigningMethod(e){return tn(this,arguments,void 0,function*({didDocument:t}){var r;const i=Be.parse(t.id);if(i&&i.method!==this.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${i.method}`);const[o]=t.assertionMethod||[],s=(r=t.verificationMethod)===null||r===void 0?void 0:r.find(a=>a.id===o);if(!(s&&s.publicKeyJwk))throw new ye(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return tn(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Jn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==fn.methodName)throw new ye(fe.MethodNotSupported,"Method not supported");const o=yield An.import({portableDid:t,keyManager:r});if(o.document.verificationMethod.length!==1)throw new ye(fe.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,t){return tn(this,void 0,void 0,function*(){try{const r=yield fn.createDocument({didUri:e,options:t});return Object.assign(Object.assign({},gt),{didDocument:r})}catch(r){if(!(r instanceof ye))throw new Error(r);return Object.assign(Object.assign({},gt),{didResolutionMetadata:Object.assign({error:r.code},r.message&&{errorMessage:r.message})})}})}static createDocument(e){return tn(this,arguments,void 0,function*({didUri:t,options:r={}}){const{defaultContext:i="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:o=!1,enableExperimentalPublicKeyTypes:s=!1,publicKeyFormat:a="JsonWebKey2020"}=r,l={id:""},u=Be.parse(t);if(!u)throw new ye(fe.InvalidDid,`Invalid DID URI: ${t}`);const c=u.id;if(u.method!==fn.methodName)throw new ye(fe.MethodNotSupported,`Method not supported: ${u.method}`);if(!fn.validateIdentifier(u))throw new ye(fe.InvalidDid,`Invalid DID URI: ${t}`);const h=yield fn.createSignatureMethod({didUri:t,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:a}});if(l.id=u.uri,l.verificationMethod=[h],l.authentication=[h.id],l.assertionMethod=[h.id],l.capabilityInvocation=[h.id],l.capabilityDelegation=[h.id],o===!0){const x=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",g=yield this.createEncryptionMethod({didUri:t,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:x}});l.verificationMethod.push(g),l.keyAgreement=[g.id]}const p=[i];return Wv({didDocument:l}).forEach(x=>{const g=fc[x];p.push(g)}),l["@context"]=p,l})}static createEncryptionMethod(e){return tn(this,arguments,void 0,function*({didUri:t,multibaseValue:r,options:i}){const{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:l,multicodecCode:u}=yield fn.deriveEncryptionKey({multibaseValue:r}),c=l.byteLength,h=dt.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(c!==h)throw new ye(fe.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${h}`);const p=Jh({keyBytes:l,multicodecCode:u});a.id=`${t}#${p}`;try{new URL(a.id)}catch{throw new ye(fe.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in fc))throw new ye(fe.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(s))throw new ye(fe.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=t,s==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=p),s==="JsonWebKey2020"){const{crv:x}=yield dt.multicodecToJwk({code:u});a.publicKeyJwk=yield dt.keyConverter(x).bytesToPublicKey({publicKeyBytes:l})}return a})}static createSignatureMethod(e){return tn(this,arguments,void 0,function*({didUri:t,multibaseValue:r,options:i}){const{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:l,multicodecCode:u,multicodecName:c}=wd({multibaseKeyId:r}),h=l.byteLength,p=dt.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(h!==p)throw new ye(fe.InvalidPublicKeyLength,`Expected ${h} bytes. Actual: ${p}`);let w=!1;switch(c){case"secp256k1-pub":w=yield Ge.validatePublicKey({publicKeyBytes:l});break;case"ed25519-pub":w=yield Xe.validatePublicKey({publicKeyBytes:l});break;case"x25519-pub":w=!0;break}if(!w)throw new ye(fe.InvalidPublicKey,"Invalid public key detected.");a.id=`${t}#${r}`;try{new URL(a.id)}catch{throw new ye(fe.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in fc))throw new ye(fe.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(s))throw new ye(fe.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=t,s==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=r),s==="JsonWebKey2020"){const{crv:g}=yield dt.multicodecToJwk({code:u});a.publicKeyJwk=yield dt.keyConverter(g).bytesToPublicKey({publicKeyBytes:l})}return a})}static deriveEncryptionKey(e){return tn(this,arguments,void 0,function*({multibaseValue:t}){let r={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:i,multicodecCode:o}=wd({multibaseKeyId:t});if(o===237){const s=yield dt.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:i}),a=yield Xe.convertPublicKeyToX25519({publicKey:s});r={keyBytes:yield dt.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return r})}static validateIdentifier(e){const{method:t,id:r}=e,[i]=e.uri.split(":",1);return i==="did"&&t==="key"&&Number("1")>0&&pc(r)==="String"&&r.startsWith("z")}}fn.methodName="key";class dt{static jwkToMulticodec(e){return tn(this,arguments,void 0,function*({jwk:t}){const r=[];t.crv&&(r.push(t.crv),t.d?r.push("private"):r.push("public"));const i=r.join(":"),o=dt.JWK_TO_MULTICODEC[i];if(o===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${i}'`);return{code:at.getCodeFromName({name:o}),name:o}})}static keyCompressor(e){const r={"P-256":Je.compressPublicKey,secp256k1:Ge.compressPublicKey}[e];if(!r)throw new ye(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static keyConverter(e){const r={Ed25519:Xe,"P-256":Je,secp256k1:Ge,X25519:Gr}[e];if(!r)throw new ye(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static multicodecToJwk(e){return tn(this,arguments,void 0,function*({code:t,name:r}){if(!(r?!t:t))throw new Error("Either 'name' or 'code' must be defined, but not both.");r=r===void 0?at.getNameFromCode({code:t}):r;const i=r,o=dt.MULTICODEC_TO_JWK[i];if(o===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},o)})}static publicKeyToMultibaseId(e){return tn(this,arguments,void 0,function*({publicKey:t}){var r;if(!(t!=null&&t.crv&&t.crv in l1))throw new ye(fe.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(r=t==null?void 0:t.crv)!==null&&r!==void 0?r:"undefined"}`);let i=yield dt.keyConverter(t.crv).publicKeyToBytes({publicKey:t});/^(secp256k1|P-256|P-384|P-521)$/.test(t.crv)&&(i=yield dt.keyCompressor(t.crv)({publicKeyBytes:i}));const{name:o}=yield dt.jwkToMulticodec({jwk:t});return Jh({keyBytes:i,multicodecName:o})})}}dt.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};dt.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};dt.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var u1=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class wa extends Vo{static resolve(e,t){return u1(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"invalidDid"}});if(r.method!==wa.methodName)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"methodNotSupported"}});let i=`https://${r.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);const o=r.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{const s=yield fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");const a=yield s.json();return Object.assign(Object.assign({},gt),{didDocument:a})}catch{return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:"notFound"}})}})}}wa.methodName="web";const d1={get:function(n){return null},set:function(n,e){return null},delete:function(n){return null},clear:function(){return null},close:function(){return null}};var Hd=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class f1{constructor({cache:e,didResolvers:t}){this.didResolvers=new Map,this.cache=e||d1;for(const r of t)this.didResolvers.set(r.methodName,r)}resolve(e,t){return Hd(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:fe.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const i=this.didResolvers.get(r.method);if(!i)return Object.assign(Object.assign({},gt),{didResolutionMetadata:{error:fe.MethodNotSupported,errorMessage:`Method not supported: ${r.method}`}});const o=yield this.cache.get(r.uri);if(o)return o;{const s=yield i.resolve(r.uri,t);return s.didResolutionMetadata.error||(yield this.cache.set(r.uri,s)),s}})}dereference(e,t){return Hd(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return{dereferencingMetadata:{error:fe.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:i,didResolutionMetadata:o,didDocumentMetadata:s}=yield this.resolve(r.uri);if(!i)return{dereferencingMetadata:{error:o.error},contentStream:null,contentMetadata:{}};if(!r.fragment||r.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:i,contentMetadata:s};const{service:a=[],verificationMethod:l=[]}=i,u=new Set([e,r.fragment,`#${r.fragment}`]);let c;for(let h of l)if(u.has(h.id)){c=h;break}for(let h of a)if(u.has(h.id)){c=h;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:o}:{dereferencingMetadata:{error:fe.NotFound},contentStream:null,contentMetadata:{}}})}}var Sr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,[])).next())})};function h1(){try{return new Function("return import.meta")()}catch{return}}const yy=new f1({didResolvers:[si,wa]}),Xc=/^https?:\/\/dweb\/([^/]+)\/?(.*)?$/,py=/^http:/,zs=/\/$/;function gy(n){var e,t;return Sr(this,void 0,void 0,function*(){const{didDocument:r}=yield yy.resolve(n),i=(t=(e=r==null?void 0:r.service)===null||e===void 0?void 0:e.find(o=>o.type==="DecentralizedWebNode"))===null||t===void 0?void 0:t.serviceEndpoint;return(Array.isArray(i)?i:[i]).filter(o=>o.startsWith("http"))})}function y1(n,e,t,r){return Sr(this,void 0,void 0,function*(){const i=n.request.url.replace(py,"https:").replace(zs,""),o=yield caches.open("drl"),s=yield o.match(i);if(s){if(!navigator.onLine)return s;const a=yield r==null?void 0:r.onCacheCheck(n,i);if(a){const l=s.headers.get("dwn-cache-time");if(l&&Date.now()<Number(l)+(Number(a.ttl)||0))return s}}try{if(t)return yield p1(n,e,i,t,o,r);{const a=yield yy.resolve(e);return new Response(JSON.stringify(a),{status:200,headers:{"Content-Type":"application/json"}})}}catch(a){return a instanceof Response?a:(console.log(`Error in DID URL fetch: ${a}`),new Response("DID URL fetch error",{status:500}))}})}function p1(n,e,t,r,i,o){return Sr(this,void 0,void 0,function*(){const s=yield gy(e);if(!(s!=null&&s.length))throw new Response("DWeb Node resolution failed: no valid endpoints found.",{status:530});for(const a of s)try{const l=`${a.replace(zs,"")}/${e}/${r}`,u=yield fetch(l,{headers:n.request.headers});return u.ok?((yield o==null?void 0:o.onCacheCheck(n,t))&&g1(t,l,u,i),u):(console.log(`DWN endpoint error: ${u.status}`),new Response("DWeb Node request failed",{status:u.status}))}catch(l){return console.log(`DWN endpoint error: ${l}`),new Response("DWeb Node request failed: "+l,{status:500})}})}function g1(n,e,t,r){return Sr(this,void 0,void 0,function*(){const i=t.clone(),o=new Headers(i.headers);o.append("dwn-cache-time",Date.now().toString()),o.append("dwn-composed-url",e);const s=new Response(i.body,{headers:o});r.put(n,s)})}function w1(n={}){var e,t,r;return Sr(this,void 0,void 0,function*(){const i=self;try{if(typeof ServiceWorkerGlobalScope<"u"&&i instanceof ServiceWorkerGlobalScope)i.skipWaiting(),i.addEventListener("activate",o=>{o.waitUntil(i.clients.claim())}),i.addEventListener("fetch",o=>{const s=o.request.url.match(Xc);s&&o.respondWith(y1(o,s[1],s[2],n))});else if(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.serviceWorker){if(!(yield navigator.serviceWorker.getRegistration("/"))){const s=n.path||(globalThis.document?(t=document==null?void 0:document.currentScript)===null||t===void 0?void 0:t.src:(r=h1())===null||r===void 0?void 0:r.url);s&&navigator.serviceWorker.register(s,{type:"module"}).catch(a=>{console.error("DWeb networking feature installation failed: ",a)})}}else throw new Error("DWeb networking features are not available for install in this environment")}catch(o){console.error("Error in installing networking features:",o)}})}const wy=`
  .drl-loading-overlay {
    position: fixed;
    inset: 0;
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    color: #fff;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    z-index: 1000000;
  }

  .drl-loading-overlay > div {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .drl-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
  }

    .drl-loading-spinner div {
      position: relative;
      width: 2em;
      height: 2em;
      margin: 0.1em 0.25em 0 0;
    }
    .drl-loading-spinner div::after,
    .drl-loading-spinner div::before {
      content: '';  
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 0.1em solid #FFF;
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      animation: drl-loading-spinner 2s linear infinite;
    }
    .drl-loading-spinner div::after {
      animation-delay: 1s;
    }

  .drl-loading-overlay span {
    --text-opacity: 2;
    display: flex;
    align-items: center;
    margin: 2em auto 0;
    padding: 0.2em 0.75em 0.25em;
    text-align: center;
    border-radius: 5em;
    background: rgba(255 255 255 / 8%);
    opacity: 0.8;
    transition: opacity 0.3s ease;
    cursor: pointer;
  }

    .drl-loading-overlay span:focus {
      opacity: 1;
    }

    .drl-loading-overlay span:hover {
      opacity: 1;
    }

    .drl-loading-overlay span::before {
      content: ' ';
      margin: 0 0.4em 0 0;
      color: red;
      font-size: 65%;
      font-weight: bold;
    }

    .drl-loading-overlay span::after {
      content: 'stop';
      display: block;
      font-size: 60%;
      line-height: 0;
      color: rgba(255 255 255 / 60%);
    }

    .drl-loading-overlay.new-tab-overlay span::after {
      content: 'close';
    }
  
  @keyframes drl-loading-spinner {
    0% {
      transform: scale(0);
      opacity: 1;
    }
    100% {
      transform: scale(1);
      opacity: 0;
    }
  }
`,b1=`
<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Loading DRL...</title>
  <style>
    html, body {
      background-color: #151518;
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    ${wy}
  </style>
</head>
<body>
  <div class='drl-loading-overlay new-tab-overlay'>
    <div class='drl-loading-spinner'>
      <div></div>
      Loading DRL
    </div>
    <span onclick='window.close()' tabindex='0'></span>
  </div>
</body>
</html>
`;let Vd=!1;function Wd(){if(Vd)return;const n=document.createElement("style");n.innerHTML=`
    ${wy}

    .drl-loading-overlay {
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    :root[drl-link-loading] .drl-loading-overlay {
      opacity: 1;
      pointer-events: all;
    }
  `,document.head.append(n);const e=document.createElement("div");e.classList.add("drl-loading-overlay"),e.innerHTML=`
    <div class='drl-loading-spinner'>
      <div></div>
      Loading DRL
    </div> 
    <span tabindex='0'></span>
  `,e.lastElementChild.addEventListener("click",by),document.body.prepend(e),Vd=!0}function by(){document.documentElement.removeAttribute("drl-link-loading"),Ps=null}let Ps,qd=!1;function m1(){qd||(document.addEventListener("click",n=>Sr(this,void 0,void 0,function*(){const e=n.target.closest("a");if(e){const t=e.href,r=t.match(Xc);if(r){const i=r[1],o=r[2],s=e.target==="_blank";n.preventDefault();try{let a;s?(a=window.open("","_blank"),a.document.write(b1)):(Ps=o,setTimeout(()=>document.documentElement.setAttribute("drl-link-loading",""),50));const l=yield gy(i);if(!l.length)throw null;const u=`${l[0].replace(zs,"")}/${i}/${o}`;s?a.closed||(a.location.href=u):Ps===o&&(window.location.href=u)}catch{throw Ps===o&&by(),new Error(`DID endpoint resolution failed for the DRL: ${t}`)}}}})),document.addEventListener("pointercancel",_s),document.addEventListener("pointerdown",n=>Sr(this,void 0,void 0,function*(){var e;const t=n.composedPath()[0];if(n.pointerType==="mouse"&&n.button===2||n.pointerType==="touch"&&n.isPrimary){if(_s(),t&&(!((e=t==null?void 0:t.src)===null||e===void 0)&&e.match(Xc))){Vr=t,t.__src__=t.src;const r=t.src.replace(py,"https:").replace(zs,""),s=(yield(yield caches.open("drl")).match(r)).headers.get("dwn-composed-url");s&&(t.src=s),t.addEventListener("pointerup",_s,{once:!0})}}else t===Vr&&_s()})),qd=!0)}let Vr;function _s(n){return Sr(this,void 0,void 0,function*(){(n==null?void 0:n.type)==="pointerup"&&(yield new Promise(e=>requestAnimationFrame(e))),Vr&&(Vr.src=Vr.__src__,delete Vr.__src__,Vr=null)})}function v1(n={}){n.serviceWorker!==!1&&w1(n),typeof window<"u"&&typeof window.document<"u"&&(n.injectStyles!==!1&&(document.readyState!=="loading"?Wd():document.addEventListener("DOMContentLoaded",Wd,{once:!0})),n.links!==!1&&m1())}try{self["workbox:core:7.0.0"]&&_()}catch{}const E1=(n,...e)=>{let t=n;return e.length>0&&(t+=` :: ${JSON.stringify(e)}`),t},_1=E1;class It extends Error{constructor(e,t){const r=_1(e,t);super(r),this.name=e,this.details=t}}const Hn={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:typeof registration<"u"?registration.scope:""},hc=n=>[Hn.prefix,n,Hn.suffix].filter(e=>e&&e.length>0).join("-"),x1=n=>{for(const e of Object.keys(Hn))n(e)},ba={updateDetails:n=>{x1(e=>{typeof n[e]=="string"&&(Hn[e]=n[e])})},getGoogleAnalyticsName:n=>n||hc(Hn.googleAnalytics),getPrecacheName:n=>n||hc(Hn.precache),getPrefix:()=>Hn.prefix,getRuntimeName:n=>n||hc(Hn.runtime),getSuffix:()=>Hn.suffix};function zd(n,e){const t=e();return n.waitUntil(t),t}try{self["workbox:precaching:7.0.0"]&&_()}catch{}const S1="__WB_REVISION__";function A1(n){if(!n)throw new It("add-to-cache-list-unexpected-type",{entry:n});if(typeof n=="string"){const o=new URL(n,location.href);return{cacheKey:o.href,url:o.href}}const{revision:e,url:t}=n;if(!t)throw new It("add-to-cache-list-unexpected-type",{entry:n});if(!e){const o=new URL(t,location.href);return{cacheKey:o.href,url:o.href}}const r=new URL(t,location.href),i=new URL(t,location.href);return r.searchParams.set(S1,e),{cacheKey:r.href,url:i.href}}class T1{constructor(){this.updatedURLs=[],this.notUpdatedURLs=[],this.handlerWillStart=async({request:e,state:t})=>{t&&(t.originalRequest=e)},this.cachedResponseWillBeUsed=async({event:e,state:t,cachedResponse:r})=>{if(e.type==="install"&&t&&t.originalRequest&&t.originalRequest instanceof Request){const i=t.originalRequest.url;r?this.notUpdatedURLs.push(i):this.updatedURLs.push(i)}return r}}}class I1{constructor({precacheController:e}){this.cacheKeyWillBeUsed=async({request:t,params:r})=>{const i=(r==null?void 0:r.cacheKey)||this._precacheController.getCacheKeyForURL(t.url);return i?new Request(i,{headers:t.headers}):t},this._precacheController=e}}let yo;function R1(){if(yo===void 0){const n=new Response("");if("body"in n)try{new Response(n.body),yo=!0}catch{yo=!1}yo=!1}return yo}async function O1(n,e){let t=null;if(n.url&&(t=new URL(n.url).origin),t!==self.location.origin)throw new It("cross-origin-copy-response",{origin:t});const r=n.clone(),o={headers:new Headers(r.headers),status:r.status,statusText:r.statusText},s=R1()?r.body:await r.blob();return new Response(s,o)}const k1=n=>new URL(String(n),location.href).href.replace(new RegExp(`^${location.origin}`),"");function Gd(n,e){const t=new URL(n);for(const r of e)t.searchParams.delete(r);return t.href}async function B1(n,e,t,r){const i=Gd(e.url,t);if(e.url===i)return n.match(e,r);const o=Object.assign(Object.assign({},r),{ignoreSearch:!0}),s=await n.keys(e,o);for(const a of s){const l=Gd(a.url,t);if(i===l)return n.match(a,r)}}class L1{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}const C1=new Set;async function $1(){for(const n of C1)await n()}function U1(n){return new Promise(e=>setTimeout(e,n))}try{self["workbox:strategies:7.0.0"]&&_()}catch{}function xs(n){return typeof n=="string"?new Request(n):n}class N1{constructor(e,t){this._cacheKeys={},Object.assign(this,t),this.event=t.event,this._strategy=e,this._handlerDeferred=new L1,this._extendLifetimePromises=[],this._plugins=[...e.plugins],this._pluginStateMap=new Map;for(const r of this._plugins)this._pluginStateMap.set(r,{});this.event.waitUntil(this._handlerDeferred.promise)}async fetch(e){const{event:t}=this;let r=xs(e);if(r.mode==="navigate"&&t instanceof FetchEvent&&t.preloadResponse){const s=await t.preloadResponse;if(s)return s}const i=this.hasCallback("fetchDidFail")?r.clone():null;try{for(const s of this.iterateCallbacks("requestWillFetch"))r=await s({request:r.clone(),event:t})}catch(s){if(s instanceof Error)throw new It("plugin-error-request-will-fetch",{thrownErrorMessage:s.message})}const o=r.clone();try{let s;s=await fetch(r,r.mode==="navigate"?void 0:this._strategy.fetchOptions);for(const a of this.iterateCallbacks("fetchDidSucceed"))s=await a({event:t,request:o,response:s});return s}catch(s){throw i&&await this.runCallbacks("fetchDidFail",{error:s,event:t,originalRequest:i.clone(),request:o.clone()}),s}}async fetchAndCachePut(e){const t=await this.fetch(e),r=t.clone();return this.waitUntil(this.cachePut(e,r)),t}async cacheMatch(e){const t=xs(e);let r;const{cacheName:i,matchOptions:o}=this._strategy,s=await this.getCacheKey(t,"read"),a=Object.assign(Object.assign({},o),{cacheName:i});r=await caches.match(s,a);for(const l of this.iterateCallbacks("cachedResponseWillBeUsed"))r=await l({cacheName:i,matchOptions:o,cachedResponse:r,request:s,event:this.event})||void 0;return r}async cachePut(e,t){const r=xs(e);await U1(0);const i=await this.getCacheKey(r,"write");if(!t)throw new It("cache-put-with-no-response",{url:k1(i.url)});const o=await this._ensureResponseSafeToCache(t);if(!o)return!1;const{cacheName:s,matchOptions:a}=this._strategy,l=await self.caches.open(s),u=this.hasCallback("cacheDidUpdate"),c=u?await B1(l,i.clone(),["__WB_REVISION__"],a):null;try{await l.put(i,u?o.clone():o)}catch(h){if(h instanceof Error)throw h.name==="QuotaExceededError"&&await $1(),h}for(const h of this.iterateCallbacks("cacheDidUpdate"))await h({cacheName:s,oldResponse:c,newResponse:o.clone(),request:i,event:this.event});return!0}async getCacheKey(e,t){const r=`${e.url} | ${t}`;if(!this._cacheKeys[r]){let i=e;for(const o of this.iterateCallbacks("cacheKeyWillBeUsed"))i=xs(await o({mode:t,request:i,event:this.event,params:this.params}));this._cacheKeys[r]=i}return this._cacheKeys[r]}hasCallback(e){for(const t of this._strategy.plugins)if(e in t)return!0;return!1}async runCallbacks(e,t){for(const r of this.iterateCallbacks(e))await r(t)}*iterateCallbacks(e){for(const t of this._strategy.plugins)if(typeof t[e]=="function"){const r=this._pluginStateMap.get(t);yield o=>{const s=Object.assign(Object.assign({},o),{state:r});return t[e](s)}}}waitUntil(e){return this._extendLifetimePromises.push(e),e}async doneWaiting(){let e;for(;e=this._extendLifetimePromises.shift();)await e}destroy(){this._handlerDeferred.resolve(null)}async _ensureResponseSafeToCache(e){let t=e,r=!1;for(const i of this.iterateCallbacks("cacheWillUpdate"))if(t=await i({request:this.request,response:t,event:this.event})||void 0,r=!0,!t)break;return r||t&&t.status!==200&&(t=void 0),t}}class D1{constructor(e={}){this.cacheName=ba.getRuntimeName(e.cacheName),this.plugins=e.plugins||[],this.fetchOptions=e.fetchOptions,this.matchOptions=e.matchOptions}handle(e){const[t]=this.handleAll(e);return t}handleAll(e){e instanceof FetchEvent&&(e={event:e,request:e.request});const t=e.event,r=typeof e.request=="string"?new Request(e.request):e.request,i="params"in e?e.params:void 0,o=new N1(this,{event:t,request:r,params:i}),s=this._getResponse(o,r,t),a=this._awaitComplete(s,o,r,t);return[s,a]}async _getResponse(e,t,r){await e.runCallbacks("handlerWillStart",{event:r,request:t});let i;try{if(i=await this._handle(t,e),!i||i.type==="error")throw new It("no-response",{url:t.url})}catch(o){if(o instanceof Error){for(const s of e.iterateCallbacks("handlerDidError"))if(i=await s({error:o,event:r,request:t}),i)break}if(!i)throw o}for(const o of e.iterateCallbacks("handlerWillRespond"))i=await o({event:r,request:t,response:i});return i}async _awaitComplete(e,t,r,i){let o,s;try{o=await e}catch{}try{await t.runCallbacks("handlerDidRespond",{event:i,request:r,response:o}),await t.doneWaiting()}catch(a){a instanceof Error&&(s=a)}if(await t.runCallbacks("handlerDidComplete",{event:i,request:r,response:o,error:s}),t.destroy(),s)throw s}}class br extends D1{constructor(e={}){e.cacheName=ba.getPrecacheName(e.cacheName),super(e),this._fallbackToNetwork=e.fallbackToNetwork!==!1,this.plugins.push(br.copyRedirectedCacheableResponsesPlugin)}async _handle(e,t){const r=await t.cacheMatch(e);return r||(t.event&&t.event.type==="install"?await this._handleInstall(e,t):await this._handleFetch(e,t))}async _handleFetch(e,t){let r;const i=t.params||{};if(this._fallbackToNetwork){const o=i.integrity,s=e.integrity,a=!s||s===o;r=await t.fetch(new Request(e,{integrity:e.mode!=="no-cors"?s||o:void 0})),o&&a&&e.mode!=="no-cors"&&(this._useDefaultCacheabilityPluginIfNeeded(),await t.cachePut(e,r.clone()))}else throw new It("missing-precache-entry",{cacheName:this.cacheName,url:e.url});return r}async _handleInstall(e,t){this._useDefaultCacheabilityPluginIfNeeded();const r=await t.fetch(e);if(!await t.cachePut(e,r.clone()))throw new It("bad-precaching-response",{url:e.url,status:r.status});return r}_useDefaultCacheabilityPluginIfNeeded(){let e=null,t=0;for(const[r,i]of this.plugins.entries())i!==br.copyRedirectedCacheableResponsesPlugin&&(i===br.defaultPrecacheCacheabilityPlugin&&(e=r),i.cacheWillUpdate&&t++);t===0?this.plugins.push(br.defaultPrecacheCacheabilityPlugin):t>1&&e!==null&&this.plugins.splice(e,1)}}br.defaultPrecacheCacheabilityPlugin={async cacheWillUpdate({response:n}){return!n||n.status>=400?null:n}};br.copyRedirectedCacheableResponsesPlugin={async cacheWillUpdate({response:n}){return n.redirected?await O1(n):n}};class P1{constructor({cacheName:e,plugins:t=[],fallbackToNetwork:r=!0}={}){this._urlsToCacheKeys=new Map,this._urlsToCacheModes=new Map,this._cacheKeysToIntegrities=new Map,this._strategy=new br({cacheName:ba.getPrecacheName(e),plugins:[...t,new I1({precacheController:this})],fallbackToNetwork:r}),this.install=this.install.bind(this),this.activate=this.activate.bind(this)}get strategy(){return this._strategy}precache(e){this.addToCacheList(e),this._installAndActiveListenersAdded||(self.addEventListener("install",this.install),self.addEventListener("activate",this.activate),this._installAndActiveListenersAdded=!0)}addToCacheList(e){const t=[];for(const r of e){typeof r=="string"?t.push(r):r&&r.revision===void 0&&t.push(r.url);const{cacheKey:i,url:o}=A1(r),s=typeof r!="string"&&r.revision?"reload":"default";if(this._urlsToCacheKeys.has(o)&&this._urlsToCacheKeys.get(o)!==i)throw new It("add-to-cache-list-conflicting-entries",{firstEntry:this._urlsToCacheKeys.get(o),secondEntry:i});if(typeof r!="string"&&r.integrity){if(this._cacheKeysToIntegrities.has(i)&&this._cacheKeysToIntegrities.get(i)!==r.integrity)throw new It("add-to-cache-list-conflicting-integrities",{url:o});this._cacheKeysToIntegrities.set(i,r.integrity)}if(this._urlsToCacheKeys.set(o,i),this._urlsToCacheModes.set(o,s),t.length>0){const a=`Workbox is precaching URLs without revision info: ${t.join(", ")}
This is generally NOT safe. Learn more at https://bit.ly/wb-precache`;console.warn(a)}}}install(e){return zd(e,async()=>{const t=new T1;this.strategy.plugins.push(t);for(const[o,s]of this._urlsToCacheKeys){const a=this._cacheKeysToIntegrities.get(s),l=this._urlsToCacheModes.get(o),u=new Request(o,{integrity:a,cache:l,credentials:"same-origin"});await Promise.all(this.strategy.handleAll({params:{cacheKey:s},request:u,event:e}))}const{updatedURLs:r,notUpdatedURLs:i}=t;return{updatedURLs:r,notUpdatedURLs:i}})}activate(e){return zd(e,async()=>{const t=await self.caches.open(this.strategy.cacheName),r=await t.keys(),i=new Set(this._urlsToCacheKeys.values()),o=[];for(const s of r)i.has(s.url)||(await t.delete(s),o.push(s.url));return{deletedURLs:o}})}getURLsToCacheKeys(){return this._urlsToCacheKeys}getCachedURLs(){return[...this._urlsToCacheKeys.keys()]}getCacheKeyForURL(e){const t=new URL(e,location.href);return this._urlsToCacheKeys.get(t.href)}getIntegrityForCacheKey(e){return this._cacheKeysToIntegrities.get(e)}async matchPrecache(e){const t=e instanceof Request?e.url:e,r=this.getCacheKeyForURL(t);if(r)return(await self.caches.open(this.strategy.cacheName)).match(r)}createHandlerBoundToURL(e){const t=this.getCacheKeyForURL(e);if(!t)throw new It("non-precached-url",{url:e});return r=>(r.request=new Request(e),r.params=Object.assign({cacheKey:t},r.params),this.strategy.handle(r))}}let yc;const Dl=()=>(yc||(yc=new P1),yc);try{self["workbox:routing:7.0.0"]&&_()}catch{}const my="GET",Gs=n=>n&&typeof n=="object"?n:{handle:n};class Ui{constructor(e,t,r=my){this.handler=Gs(t),this.match=e,this.method=r}setCatchHandler(e){this.catchHandler=Gs(e)}}class M1 extends Ui{constructor(e,t,r){const i=({url:o})=>{const s=e.exec(o.href);if(s&&!(o.origin!==location.origin&&s.index!==0))return s.slice(1)};super(i,t,r)}}class K1{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",e=>{const{request:t}=e,r=this.handleRequest({request:t,event:e});r&&e.respondWith(r)})}addCacheListener(){self.addEventListener("message",e=>{if(e.data&&e.data.type==="CACHE_URLS"){const{payload:t}=e.data,r=Promise.all(t.urlsToCache.map(i=>{typeof i=="string"&&(i=[i]);const o=new Request(...i);return this.handleRequest({request:o,event:e})}));e.waitUntil(r),e.ports&&e.ports[0]&&r.then(()=>e.ports[0].postMessage(!0))}})}handleRequest({request:e,event:t}){const r=new URL(e.url,location.href);if(!r.protocol.startsWith("http"))return;const i=r.origin===location.origin,{params:o,route:s}=this.findMatchingRoute({event:t,request:e,sameOrigin:i,url:r});let a=s&&s.handler;const l=e.method;if(!a&&this._defaultHandlerMap.has(l)&&(a=this._defaultHandlerMap.get(l)),!a)return;let u;try{u=a.handle({url:r,request:e,event:t,params:o})}catch(h){u=Promise.reject(h)}const c=s&&s.catchHandler;return u instanceof Promise&&(this._catchHandler||c)&&(u=u.catch(async h=>{if(c)try{return await c.handle({url:r,request:e,event:t,params:o})}catch(p){p instanceof Error&&(h=p)}if(this._catchHandler)return this._catchHandler.handle({url:r,request:e,event:t});throw h})),u}findMatchingRoute({url:e,sameOrigin:t,request:r,event:i}){const o=this._routes.get(r.method)||[];for(const s of o){let a;const l=s.match({url:e,sameOrigin:t,request:r,event:i});if(l)return a=l,(Array.isArray(a)&&a.length===0||l.constructor===Object&&Object.keys(l).length===0||typeof l=="boolean")&&(a=void 0),{route:s,params:a}}return{}}setDefaultHandler(e,t=my){this._defaultHandlerMap.set(t,Gs(e))}setCatchHandler(e){this._catchHandler=Gs(e)}registerRoute(e){this._routes.has(e.method)||this._routes.set(e.method,[]),this._routes.get(e.method).push(e)}unregisterRoute(e){if(!this._routes.has(e.method))throw new It("unregister-route-but-not-found-with-method",{method:e.method});const t=this._routes.get(e.method).indexOf(e);if(t>-1)this._routes.get(e.method).splice(t,1);else throw new It("unregister-route-route-not-registered")}}let po;const F1=()=>(po||(po=new K1,po.addFetchListener(),po.addCacheListener()),po);function vy(n,e,t){let r;if(typeof n=="string"){const o=new URL(n,location.href),s=({url:a})=>a.href===o.href;r=new Ui(s,e,t)}else if(n instanceof RegExp)r=new M1(n,e,t);else if(typeof n=="function")r=new Ui(n,e,t);else if(n instanceof Ui)r=n;else throw new It("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});return F1().registerRoute(r),r}function j1(n,e=[]){for(const t of[...n.searchParams.keys()])e.some(r=>r.test(t))&&n.searchParams.delete(t);return n}function*H1(n,{ignoreURLParametersMatching:e=[/^utm_/,/^fbclid$/],directoryIndex:t="index.html",cleanURLs:r=!0,urlManipulation:i}={}){const o=new URL(n,location.href);o.hash="",yield o.href;const s=j1(o,e);if(yield s.href,t&&s.pathname.endsWith("/")){const a=new URL(s.href);a.pathname+=t,yield a.href}if(r){const a=new URL(s.href);a.pathname+=".html",yield a.href}if(i){const a=i({url:o});for(const l of a)yield l.href}}class V1 extends Ui{constructor(e,t){const r=({request:i})=>{const o=e.getURLsToCacheKeys();for(const s of H1(i.url,t)){const a=o.get(s);if(a){const l=e.getIntegrityForCacheKey(a);return{cacheKey:a,integrity:l}}}};super(r,e.strategy)}}function W1(n){const e=Dl(),t=new V1(e,n);vy(t)}const q1="-precache-",z1=async(n,e=q1)=>{const r=(await self.caches.keys()).filter(i=>i.includes(e)&&i.includes(self.registration.scope)&&i!==n);return await Promise.all(r.map(i=>self.caches.delete(i))),r};function G1(){self.addEventListener("activate",n=>{const e=ba.getPrecacheName();n.waitUntil(z1(e).then(t=>{}))})}function Y1(n){return Dl().createHandlerBoundToURL(n)}function J1(n){Dl().precache(n)}function X1(n,e){J1(n),W1(e)}class Z1 extends Ui{constructor(e,{allowlist:t=[/./],denylist:r=[]}={}){super(i=>this._match(i),e),this._allowlist=t,this._denylist=r}_match({url:e,request:t}){if(t&&t.mode!=="navigate")return!1;const r=e.pathname+e.search;for(const i of this._denylist)if(i.test(r))return!1;return!!this._allowlist.some(i=>i.test(r))}}self.addEventListener("message",n=>{n.data&&n.data.type==="SKIP_WAITING"&&self.skipWaiting()});X1([{"revision":"10b5f88323fdad31bf50c90668d3e84a","url":"apple-touch-icon-180x180.png"},{"revision":null,"url":"assets/index-BYaKcX38.css"},{"revision":null,"url":"assets/index-DhOKs0kW.js"},{"revision":null,"url":"assets/workbox-window.prod.es5-D5gOYdM7.js"},{"revision":null,"url":"assets/workplace-Dn_WYwng.svg"},{"revision":"89099cfae0775e3e086613bca3190493","url":"favicon.ico"},{"revision":"71dcfd191507c31dc79efe3341dfa3b9","url":"favicon.svg"},{"revision":"7b2f7dbbe1ed959810fb83a5bc87ace0","url":"index.html"},{"revision":"126c55dc030a58db716758479c41c570","url":"maskable-icon-512x512.png"},{"revision":"14a23cc23a2f5a3157ac52e78135346c","url":"pwa-192x192.png"},{"revision":"5a051418936d2f633fc164f78b1662e1","url":"pwa-512x512.png"},{"revision":"3cce535eec4a1c5ce2a2c060fc6323ab","url":"pwa-64x64.png"},{"revision":"31bdce8846499efe4b2755347317f026","url":"manifest.webmanifest"}]);G1();let Q1;vy(new Z1(Y1("index.html"),{allowlist:Q1}));v1({onCacheCheck(){return{ttl:3e4}}});
